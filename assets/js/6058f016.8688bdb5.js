"use strict";(self.webpackChunkwebsite=self.webpackChunkwebsite||[]).push([[9152],{3905:function(e,n,r){r.d(n,{Zo:function(){return p},kt:function(){return s}});var t=r(7294);function a(e,n,r){return n in e?Object.defineProperty(e,n,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[n]=r,e}function f(e,n){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(e);n&&(t=t.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),r.push.apply(r,t)}return r}function i(e){for(var n=1;n<arguments.length;n++){var r=null!=arguments[n]?arguments[n]:{};n%2?f(Object(r),!0).forEach((function(n){a(e,n,r[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):f(Object(r)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))}))}return e}function o(e,n){if(null==e)return{};var r,t,a=function(e,n){if(null==e)return{};var r,t,a={},f=Object.keys(e);for(t=0;t<f.length;t++)r=f[t],n.indexOf(r)>=0||(a[r]=e[r]);return a}(e,n);if(Object.getOwnPropertySymbols){var f=Object.getOwnPropertySymbols(e);for(t=0;t<f.length;t++)r=f[t],n.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}var l=t.createContext({}),u=function(e){var n=t.useContext(l),r=n;return e&&(r="function"==typeof e?e(n):i(i({},n),e)),r},p=function(e){var n=u(e.components);return t.createElement(l.Provider,{value:n},e.children)},d={inlineCode:"code",wrapper:function(e){var n=e.children;return t.createElement(t.Fragment,{},n)}},c=t.forwardRef((function(e,n){var r=e.components,a=e.mdxType,f=e.originalType,l=e.parentName,p=o(e,["components","mdxType","originalType","parentName"]),c=u(r),s=a,m=c["".concat(l,".").concat(s)]||c[s]||d[s]||f;return r?t.createElement(m,i(i({ref:n},p),{},{components:r})):t.createElement(m,i({ref:n},p))}));function s(e,n){var r=arguments,a=n&&n.mdxType;if("string"==typeof e||a){var f=r.length,i=new Array(f);i[0]=c;var o={};for(var l in n)hasOwnProperty.call(n,l)&&(o[l]=n[l]);o.originalType=e,o.mdxType="string"==typeof e?e:a,i[1]=o;for(var u=2;u<f;u++)i[u]=r[u];return t.createElement.apply(null,i)}return t.createElement.apply(null,r)}c.displayName="MDXCreateElement"},7699:function(e,n,r){r.r(n),r.d(n,{frontMatter:function(){return o},contentTitle:function(){return l},metadata:function(){return u},toc:function(){return p},default:function(){return c}});var t=r(7462),a=r(3366),f=(r(7294),r(3905)),i=["components"],o={title:"[Node] Buffer",sidebar_position:1},l="nodejs\u6838\u5fc3api",u={unversionedId:"Node.js/buffer",id:"Node.js/buffer",title:"[Node] Buffer",description:"Buffer",source:"@site/docs/Node.js/buffer.md",sourceDirName:"Node.js",slug:"/Node.js/buffer",permalink:"/docs/Node.js/buffer",editUrl:"https://github.com/aokikoko/aokikoko.github.io/blob/main/website/docs/Node.js/buffer.md",tags:[],version:"current",sidebarPosition:1,frontMatter:{title:"[Node] Buffer",sidebar_position:1},sidebar:"tutorialSidebar",previous:{title:"[Http] Options\u8bf7\u6c42\u7684\u89e3\u91ca",permalink:"/docs/Http/OptionsRequest"},next:{title:"[Node] dgram",permalink:"/docs/Node.js/dgram"}},p=[{value:"Buffer",id:"buffer",children:[{value:"utf-8",id:"utf-8",children:[],level:4},{value:"TypedArray",id:"typedarray",children:[],level:4},{value:"buffer \u4e0e typedArray",id:"buffer-\u4e0e-typedarray",children:[],level:4}],level:2},{value:"\u53c2\u8003",id:"\u53c2\u8003",children:[{value:"\u4ec0\u4e48\u662f buffer\uff1f",id:"\u4ec0\u4e48\u662f-buffer",children:[],level:3},{value:"\u4e3a\u4ec0\u4e48\u9700\u8981 buffer\uff1f",id:"\u4e3a\u4ec0\u4e48\u9700\u8981-buffer",children:[],level:3},{value:"\u5982\u4f55\u521b\u5efa buffer",id:"\u5982\u4f55\u521b\u5efa-buffer",children:[],level:3},{value:"\u4f7f\u7528 buffer",id:"\u4f7f\u7528-buffer",children:[],level:3}],level:2}],d={toc:p};function c(e){var n=e.components,r=(0,a.Z)(e,i);return(0,f.kt)("wrapper",(0,t.Z)({},d,r,{components:n,mdxType:"MDXLayout"}),(0,f.kt)("h1",{id:"nodejs\u6838\u5fc3api"},"nodejs\u6838\u5fc3api"),(0,f.kt)("h2",{id:"buffer"},"Buffer"),(0,f.kt)("p",null,"\u5728\u5f15\u5165 ",(0,f.kt)("inlineCode",{parentName:"p"},"TypedArray")," \u4e4b\u524d\uff0cJavaScript \u8bed\u8a00\u6ca1\u6709\u7528\u4e8e\u8bfb\u53d6\u6216\u64cd\u4f5c\u4e8c\u8fdb\u5236\u6570\u636e\u6d41\u7684\u673a\u5236\u3002 ",(0,f.kt)("inlineCode",{parentName:"p"},"Buffer")," \u7c7b\u662f\u4f5c\u4e3a Node.js API \u7684\u4e00\u90e8\u5206\u5f15\u5165\u7684\uff0c\u7528\u4e8e\u5728 TCP \u6d41\u3001\u6587\u4ef6\u7cfb\u7edf\u64cd\u4f5c\u3001\u4ee5\u53ca\u5176\u4ed6\u4e0a\u4e0b\u6587\u4e2d\u4e0e\u516b\u4f4d\u5b57\u8282\u6d41\u8fdb\u884c\u4ea4\u4e92\u3002"),(0,f.kt)("p",null,"\u73b0\u5728\u53ef\u4ee5\u4f7f\u7528 ",(0,f.kt)("inlineCode",{parentName:"p"},"TypedArray"),"\uff0c ",(0,f.kt)("inlineCode",{parentName:"p"},"Buffer")," \u7c7b\u4ee5\u66f4\u4f18\u5316\u548c\u66f4\u9002\u5408 Node.js \u7684\u65b9\u5f0f\u5b9e\u73b0\u4e86 ",(0,f.kt)("inlineCode",{parentName:"p"},"Uint8Array")," API\u3002"),(0,f.kt)("p",null,(0,f.kt)("inlineCode",{parentName:"p"},"Buffer")," \u7c7b\u7684\u5b9e\u4f8b\u7c7b\u4f3c\u4e8e\u4ece ",(0,f.kt)("inlineCode",{parentName:"p"},"0")," \u5230 ",(0,f.kt)("inlineCode",{parentName:"p"},"255")," \u4e4b\u95f4\u7684\u6574\u6570\u6570\u7ec4\uff08\u5176\u4ed6\u6574\u6570\u4f1a\u901a\u8fc7 ",(0,f.kt)("inlineCode",{parentName:"p"},"\uff06 255")," \u64cd\u4f5c\u5f3a\u5236\u8f6c\u6362\u5230\u6b64\u8303\u56f4\uff09\uff0c\u4f46\u5bf9\u5e94\u4e8e V8 \u5806\u5916\u90e8\u7684\u56fa\u5b9a\u5927\u5c0f\u7684\u539f\u59cb\u5185\u5b58\u5206\u914d\u3002 ",(0,f.kt)("inlineCode",{parentName:"p"},"Buffer")," \u7684\u5927\u5c0f\u5728\u521b\u5efa\u65f6\u786e\u5b9a\uff0c\u4e14\u65e0\u6cd5\u66f4\u6539(\u8054\u60f3JS\u7684\u6570\u7ec4, \u53ef\u4ee5\u66f4\u6539)\u3002"),(0,f.kt)("p",null,(0,f.kt)("inlineCode",{parentName:"p"},"Buffer")," \u7c7b\u5728\u5168\u5c40\u4f5c\u7528\u57df\u4e2d\uff0c\u56e0\u6b64\u65e0\u9700\u4f7f\u7528 ",(0,f.kt)("inlineCode",{parentName:"p"},"require('buffer').Buffer")," (\u5728global\u4e2d)\u3002"),(0,f.kt)("pre",null,(0,f.kt)("code",{parentName:"pre",className:"language-js"},"// \u521b\u5efa\u4e00\u4e2a\u957f\u5ea6\u4e3a 10\u3001\u4e14\u7528\u96f6\u586b\u5145\u7684 Buffer\u3002\nconst buf1 = Buffer.alloc(10);\n\n// \u521b\u5efa\u4e00\u4e2a\u957f\u5ea6\u4e3a 10\u3001\u4e14\u7528 0x1 \u586b\u5145\u7684 Buffer\u3002 \nconst buf2 = Buffer.alloc(10, 1);\n\n// \u521b\u5efa\u4e00\u4e2a\u957f\u5ea6\u4e3a 10\u3001\u4e14\u672a\u521d\u59cb\u5316\u7684 Buffer\u3002\n// \u8fd9\u4e2a\u65b9\u6cd5\u6bd4\u8c03\u7528 Buffer.alloc() \u66f4\u5feb\uff0c\n// \u4f46\u8fd4\u56de\u7684 Buffer \u5b9e\u4f8b\u53ef\u80fd\u5305\u542b\u65e7\u6570\u636e\uff0c\n// \u56e0\u6b64\u9700\u8981\u4f7f\u7528 fill() \u6216 write() \u91cd\u5199\u3002\nconst buf3 = Buffer.allocUnsafe(10);\n\n// \u521b\u5efa\u4e00\u4e2a\u5305\u542b [0x1, 0x2, 0x3] \u7684 Buffer\u3002\nconst buf4 = Buffer.from([1, 2, 3]);\n\n// \u521b\u5efa\u4e00\u4e2a\u5305\u542b UTF-8 \u5b57\u8282 [0x74, 0xc3, 0xa9, 0x73, 0x74] \u7684 Buffer\u3002\nconst buf5 = Buffer.from('t\xe9st');\n\n// \u521b\u5efa\u4e00\u4e2a\u5305\u542b Latin-1 \u5b57\u8282 [0x74, 0xe9, 0x73, 0x74] \u7684 Buffer\u3002\nconst buf6 = Buffer.from('t\xe9st', 'latin1');\n\n")),(0,f.kt)("h4",{id:"utf-8"},"utf-8"),(0,f.kt)("p",null,"UTF-8 \u7684\u7f16\u7801\u89c4\u5219\u5f88\u7b80\u5355\uff1a\u5982\u679c\u53ea\u6709\u4e00\u4e2a\u5b57\u8282\uff0c\u90a3\u4e48\u6700\u9ad8\u7684\u6bd4\u7279\u4f4d\u4e3a 0\uff1b\u5982\u679c\u6709\u591a\u4e2a\u5b57\u8282\uff0c\u90a3\u4e48\u7b2c\u4e00\u4e2a\u5b57\u8282\u4ece\u6700\u9ad8\u4f4d\u5f00\u59cb\uff0c\u8fde\u7eed\u6709\u51e0\u4e2a\u6bd4\u7279\u4f4d\u7684\u503c\u4e3a 1\uff0c\u5c31\u4f7f\u7528\u51e0\u4e2a\u5b57\u8282\u7f16\u7801\uff0c\u5269\u4e0b\u7684\u5b57\u8282\u5747\u4ee5 10 \u5f00\u5934\u3002"),(0,f.kt)("p",null,"\u5177\u4f53\u7684\u8868\u73b0\u5f62\u5f0f\u4e3a\uff1a"),(0,f.kt)("p",null,"0xxxxxxx\uff1a\u5355\u5b57\u8282\u7f16\u7801\u5f62\u5f0f\uff0c\u8fd9\u548c ASCII \u7f16\u7801\u5b8c\u5168\u4e00\u6837\uff0c\u56e0\u6b64 UTF-8 \u662f\u517c\u5bb9 ASCII \u7684\uff1b\n110xxxxx 10xxxxxx\uff1a\u53cc\u5b57\u8282\u7f16\u7801\u5f62\u5f0f\uff1b\n1110xxxx 10xxxxxx 10xxxxxx\uff1a\u4e09\u5b57\u8282\u7f16\u7801\u5f62\u5f0f\uff1b\n11110xxx 10xxxxxx 10xxxxxx 10xxxxxx\uff1a\u56db\u5b57\u8282\u7f16\u7801\u5f62\u5f0f\u3002"),(0,f.kt)("p",null,"xxx \u5c31\u7528\u6765\u5b58\u50a8 Unicode \u4e2d\u7684\u5b57\u7b26\u7f16\u53f7\u3002"),(0,f.kt)("p",null,"\u4e0b\u9762\u662f\u4e00\u4e9b\u5b57\u7b26\u7684\u7f16\u7801\u5b9e\u4f8b\uff08\u7eff\u8272\u90e8\u5206\u8868\u793a\u672c\u6765\u7684 Unicode \u7f16\u53f7\uff09\uff1a"),(0,f.kt)("h4",{id:"typedarray"},"TypedArray"),(0,f.kt)("pre",null,(0,f.kt)("code",{parentName:"pre"},"new TypedArray(); // ES2017\u4e2d\u65b0\u589e\nnew TypedArray(length); \nnew TypedArray(typedArray); \nnew TypedArray(object); \nnew TypedArray(buffer [, byteOffset [, length]]); \n\nTypedArray()\u6307\u7684\u662f\u4ee5\u4e0b\u7684\u5176\u4e2d\u4e4b\u4e00\uff1a \n\nInt8Array(); \nUint8Array(); \nUint8ClampedArray();\nInt16Array(); \nUint16Array();\nInt32Array(); \nUint32Array(); \nFloat32Array(); \nFloat64Array();\n")),(0,f.kt)("p",null,"ArrayBuffer\u5bf9\u8c61\uff1a\u4ee3\u8868\u539f\u59cb\u7684\u4e8c\u8fdb\u5236\u6570\u636e\u3002"),(0,f.kt)("p",null,"TypedArray\u89c6\u56fe\uff1a\u7528\u6765\u8bfb\u5199\u7b80\u5355\u7c7b\u578b\u7684\u4e8c\u8fdb\u5236\u6570\u636e\u3002"),(0,f.kt)("p",null,"DataView\u89c6\u56fe\uff1a\u7528\u6765\u8bfb\u5199\u590d\u6742\u7c7b\u578b\u7684\u4e8c\u8fdb\u5236\u6570\u636e\u3002"),(0,f.kt)("pre",null,(0,f.kt)("code",{parentName:"pre",className:"language-js"},"function str2ab(str) {\n  var buf = new ArrayBuffer(str.length * 2); // \u6bcf\u4e2a\u5b57\u7b26\u5360\u75282\u4e2a\u5b57\u8282\n  var bufView = new Uint8Array(buf);\n  for (var i = 0, strLen = str.length; i < strLen; i++) {\n    bufView[i] = str.charCodeAt(i);\n  }\n  return buf;\n}\n")),(0,f.kt)("p",null,"\u4e0a\u9762\u65b9\u6cd5\u4e3a\u4ec0\u4e48\u4e0d\u76f4\u63a5\u5faa\u73afbuf\uff0c\u800c\u662f\u53c8\u521b\u5efa\u4e86\u4e00\u4e2a\u5bf9\u8c61Uint8Array?\n\u56e0\u4e3aArrayBufffer\u4e0d\u80fd\u76f4\u63a5\u8bfb\u5199\u3002\u4f46\u662f\u53ef\u4ee5\u901a\u8fc7Uint8Array\uff0cUint16Array.\u3002\u3002\u7b49\u7b49\u5bf9\u8c61\u8bfb\u5199\u3002\n\u5f53\u7136\uff0c\u4e0a\u9762\u5199\u53ef\u4ee5\u76f4\u63a5\u521b\u5efaUint8Array(str.length * 2);\u4e00\u4e2a\u6548\u679c"),(0,f.kt)("h4",{id:"buffer-\u4e0e-typedarray"},"buffer \u4e0e typedArray"),(0,f.kt)("p",null,(0,f.kt)("inlineCode",{parentName:"p"},"Buffer")," \u5b9e\u4f8b\u4e5f\u662f ",(0,f.kt)("a",{parentName:"p",href:"http://nodejs.cn/s/ZbDkpm"},(0,f.kt)("inlineCode",{parentName:"a"},"Uint8Array"))," \u5b9e\u4f8b\uff0c\u4f46\u662f\u4e0e ",(0,f.kt)("a",{parentName:"p",href:"http://nodejs.cn/s/oh3CkV"},(0,f.kt)("inlineCode",{parentName:"a"},"TypedArray"))," \u6709\u5fae\u5c0f\u7684\u4e0d\u540c\u3002 \u4f8b\u5982\uff0c",(0,f.kt)("a",{parentName:"p",href:"http://nodejs.cn/s/Ue6KZm"},(0,f.kt)("inlineCode",{parentName:"a"},"ArrayBuffer#slice()"))," \u4f1a\u521b\u5efa\u5207\u7247\u7684\u62f7\u8d1d\uff0c\u800c ",(0,f.kt)("a",{parentName:"p",href:"http://nodejs.cn/s/uQPgxt"},(0,f.kt)("inlineCode",{parentName:"a"},"Buffer#slice()"))," \u662f\u5728\u73b0\u6709\u7684 ",(0,f.kt)("inlineCode",{parentName:"p"},"Buffer")," \u4e0a\u521b\u5efa\u800c\u4e0d\u62f7\u8d1d\uff0c\u8fd9\u4f7f\u5f97 ",(0,f.kt)("a",{parentName:"p",href:"http://nodejs.cn/s/uQPgxt"},(0,f.kt)("inlineCode",{parentName:"a"},"Buffer#slice()"))," \u6548\u7387\u66f4\u9ad8\u3002"),(0,f.kt)("p",null,"\u4e5f\u53ef\u4ee5\u4ece\u4e00\u4e2a ",(0,f.kt)("inlineCode",{parentName:"p"},"Buffer")," \u521b\u5efa\u65b0\u7684 ",(0,f.kt)("a",{parentName:"p",href:"http://nodejs.cn/s/oh3CkV"},(0,f.kt)("inlineCode",{parentName:"a"},"TypedArray"))," \u5b9e\u4f8b\uff0c\u4f46\u9700\u8981\u6ce8\u610f\u4ee5\u4e0b\u4e8b\u9879\uff1a"),(0,f.kt)("ol",null,(0,f.kt)("li",{parentName:"ol"},(0,f.kt)("inlineCode",{parentName:"li"},"Buffer")," \u5bf9\u8c61\u7684\u5185\u5b58\u662f\u88ab\u62f7\u8d1d\u5230 ",(0,f.kt)("a",{parentName:"li",href:"http://nodejs.cn/s/oh3CkV"},(0,f.kt)("inlineCode",{parentName:"a"},"TypedArray")),"\uff0c\u800c\u4e0d\u662f\u5171\u4eab\u3002"),(0,f.kt)("li",{parentName:"ol"},(0,f.kt)("inlineCode",{parentName:"li"},"Buffer")," \u5bf9\u8c61\u7684\u5185\u5b58\u662f\u88ab\u89e3\u91ca\u4e3a\u4e0d\u540c\u5143\u7d20\u7684\u6570\u7ec4\uff0c\u800c\u4e0d\u662f\u76ee\u6807\u7c7b\u578b\u7684\u5b57\u8282\u6570\u7ec4\u3002 \u4e5f\u5c31\u662f\u8bf4\uff0c ",(0,f.kt)("inlineCode",{parentName:"li"},"new Uint32Array(Buffer.from([1, 2, 3, 4]))")," \u4f1a\u521b\u5efa\u4e00\u4e2a\u5e26\u6709 4 \u4e2a\u5143\u7d20 ",(0,f.kt)("inlineCode",{parentName:"li"},"[1, 2, 3, 4]")," \u7684 ",(0,f.kt)("a",{parentName:"li",href:"http://nodejs.cn/s/xF6oKR"},(0,f.kt)("inlineCode",{parentName:"a"},"Uint32Array")),"\uff0c\u800c\u4e0d\u662f\u5e26\u6709\u5355\u4e2a\u5143\u7d20 ",(0,f.kt)("inlineCode",{parentName:"li"},"[0x1020304]")," \u6216 ",(0,f.kt)("inlineCode",{parentName:"li"},"[0x4030201]")," \u7684 ",(0,f.kt)("a",{parentName:"li",href:"http://nodejs.cn/s/xF6oKR"},(0,f.kt)("inlineCode",{parentName:"a"},"Uint32Array")),"\u3002")),(0,f.kt)("p",null,"\u901a\u8fc7\u4f7f\u7528 ",(0,f.kt)("inlineCode",{parentName:"p"},"TypedArray")," \u5bf9\u8c61\u7684 ",(0,f.kt)("inlineCode",{parentName:"p"},".buffer")," \u5c5e\u6027\uff0c\u53ef\u4ee5\u521b\u5efa\u4e00\u4e2a\u4e0e ",(0,f.kt)("a",{parentName:"p",href:"http://nodejs.cn/s/oh3CkV"},(0,f.kt)("inlineCode",{parentName:"a"},"TypedArray"))," \u5b9e\u4f8b\u5171\u4eab\u76f8\u540c\u5185\u5b58\u7684\u65b0 ",(0,f.kt)("inlineCode",{parentName:"p"},"Buffer"),"\u3002"),(0,f.kt)("pre",null,(0,f.kt)("code",{parentName:"pre",className:"language-js"},"const arr = new Uint16Array(2);\n\narr[0] = 5000;\narr[1] = 4000;\n\n// \u62f7\u8d1d `arr` \u7684\u5185\u5bb9\u3002\nconst buf1 = Buffer.from(arr);\n// \u4e0e `arr` \u5171\u4eab\u5185\u5b58\u3002\nconst buf2 = Buffer.from(arr.buffer);\n\nconsole.log(buf1);\n// \u6253\u5370: <Buffer 88 a0>\nconsole.log(buf2);\n// \u6253\u5370: <Buffer 88 13 a0 0f>\n\narr[1] = 6000;\n\nconsole.log(buf1);\n// \u6253\u5370: <Buffer 88 a0>\nconsole.log(buf2);\n// \u6253\u5370: <Buffer 88 13 70 17>\n")),(0,f.kt)("h2",{id:"\u53c2\u8003"},"\u53c2\u8003"),(0,f.kt)("h3",{id:"\u4ec0\u4e48\u662f-buffer"},(0,f.kt)("a",{parentName:"h3",href:"http://nodejs.cn/learn/nodejs-buffers/#%E4%BB%80%E4%B9%88%E6%98%AF-buffer"},"\u4ec0\u4e48\u662f buffer\uff1f")),(0,f.kt)("h3",{id:"\u4e3a\u4ec0\u4e48\u9700\u8981-buffer"},(0,f.kt)("a",{parentName:"h3",href:"http://nodejs.cn/learn/nodejs-buffers/#%E4%B8%BA%E4%BB%80%E4%B9%88%E9%9C%80%E8%A6%81-buffer"},"\u4e3a\u4ec0\u4e48\u9700\u8981 buffer\uff1f")),(0,f.kt)("h3",{id:"\u5982\u4f55\u521b\u5efa-buffer"},(0,f.kt)("a",{parentName:"h3",href:"http://nodejs.cn/learn/nodejs-buffers/#%E5%A6%82%E4%BD%95%E5%88%9B%E5%BB%BA-buffer"},"\u5982\u4f55\u521b\u5efa buffer")),(0,f.kt)("h3",{id:"\u4f7f\u7528-buffer"},(0,f.kt)("a",{parentName:"h3",href:"http://nodejs.cn/learn/nodejs-buffers/#%E4%BD%BF%E7%94%A8-buffer"},"\u4f7f\u7528 buffer")))}c.isMDXComponent=!0}}]);