"use strict";(self.webpackChunkwebsite=self.webpackChunkwebsite||[]).push([[5747],{3905:function(e,t,n){n.d(t,{Zo:function(){return i},kt:function(){return m}});var a=n(7294);function l(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function r(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function s(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?r(Object(n),!0).forEach((function(t){l(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):r(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function p(e,t){if(null==e)return{};var n,a,l=function(e,t){if(null==e)return{};var n,a,l={},r=Object.keys(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||(l[n]=e[n]);return l}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(l[n]=e[n])}return l}var o=a.createContext({}),u=function(e){var t=a.useContext(o),n=t;return e&&(n="function"==typeof e?e(t):s(s({},t),e)),n},i=function(e){var t=u(e.components);return a.createElement(o.Provider,{value:t},e.children)},c={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},d=a.forwardRef((function(e,t){var n=e.components,l=e.mdxType,r=e.originalType,o=e.parentName,i=p(e,["components","mdxType","originalType","parentName"]),d=u(n),m=l,k=d["".concat(o,".").concat(m)]||d[m]||c[m]||r;return n?a.createElement(k,s(s({ref:t},i),{},{components:n})):a.createElement(k,s({ref:t},i))}));function m(e,t){var n=arguments,l=t&&t.mdxType;if("string"==typeof e||l){var r=n.length,s=new Array(r);s[0]=d;var p={};for(var o in t)hasOwnProperty.call(t,o)&&(p[o]=t[o]);p.originalType=e,p.mdxType="string"==typeof e?e:l,s[1]=p;for(var u=2;u<r;u++)s[u]=n[u];return a.createElement.apply(null,s)}return a.createElement.apply(null,n)}d.displayName="MDXCreateElement"},8067:function(e,t,n){n.r(t),n.d(t,{contentTitle:function(){return o},default:function(){return d},frontMatter:function(){return p},metadata:function(){return u},toc:function(){return i}});var a=n(7462),l=n(3366),r=(n(7294),n(3905)),s=["components"],p={title:"[JS] \u7f51\u7edc\u8bf7\u6c42\u4e0e\u8fdc\u7a0b\u8d44\u6e90",sidebar_position:28},o=void 0,u={unversionedId:"javascript/XHR",id:"javascript/XHR",title:"[JS] \u7f51\u7edc\u8bf7\u6c42\u4e0e\u8fdc\u7a0b\u8d44\u6e90",description:"\u6458\u8bb0 -- \u9a6c\u7279 2020\u7248 \u7b2c\u4e8c\u5341\u56db\u7ae0",source:"@site/docs/javascript/XHR.md",sourceDirName:"javascript",slug:"/javascript/XHR",permalink:"/docs/javascript/XHR",editUrl:"https://github.com/aokikoko/aokikoko.github.io/blob/main/website/docs/javascript/XHR.md",tags:[],version:"current",sidebarPosition:28,frontMatter:{title:"[JS] \u7f51\u7edc\u8bf7\u6c42\u4e0e\u8fdc\u7a0b\u8d44\u6e90",sidebar_position:28},sidebar:"tutorialSidebar",previous:{title:"[JS] JSON",permalink:"/docs/javascript/json"},next:{title:"[JS] \u6700\u4f73\u5b9e\u8df5\u4e4b\u53ef\u7ef4\u62a4\u6027",permalink:"/docs/javascript/bestparctice"}},i=[{value:"XMLHttpRequest \u5bf9\u8c61",id:"xmlhttprequest-\u5bf9\u8c61",children:[{value:"\u4f7f\u7528 XHR",id:"\u4f7f\u7528-xhr",children:[],level:3},{value:"HTTP \u5934\u90e8",id:"http-\u5934\u90e8",children:[],level:3},{value:"GET \u8bf7\u6c42",id:"get-\u8bf7\u6c42",children:[],level:3},{value:"POST \u8bf7\u6c42",id:"post-\u8bf7\u6c42",children:[],level:3},{value:"XMLHttpRequest Level 2",id:"xmlhttprequest-level-2",children:[],level:3}],level:2},{value:"\u8fdb\u5ea6\u4e8b\u4ef6",id:"\u8fdb\u5ea6\u4e8b\u4ef6",children:[{value:"load \u4e8b\u4ef6",id:"load-\u4e8b\u4ef6",children:[],level:3},{value:"progress \u4e8b\u4ef6",id:"progress-\u4e8b\u4ef6",children:[],level:3}],level:2},{value:"\u8de8\u6e90\u8d44\u6e90\u5171\u4eab",id:"\u8de8\u6e90\u8d44\u6e90\u5171\u4eab",children:[{value:"\u9884\u68c0\u8bf7\u6c42",id:"\u9884\u68c0\u8bf7\u6c42",children:[],level:3},{value:"\u51ed\u636e\u8bf7\u6c42",id:"\u51ed\u636e\u8bf7\u6c42",children:[],level:3}],level:2},{value:"\u66ff\u4ee3\u6027\u8de8\u6e90\u6280\u672f",id:"\u66ff\u4ee3\u6027\u8de8\u6e90\u6280\u672f",children:[{value:"\u56fe\u7247\u63a2\u6d4b",id:"\u56fe\u7247\u63a2\u6d4b",children:[],level:3},{value:"JSONP",id:"jsonp",children:[],level:3}],level:2},{value:"Fetch API",id:"fetch-api",children:[{value:"\u57fa\u672c\u7528\u6cd5",id:"\u57fa\u672c\u7528\u6cd5",children:[],level:3}],level:2}],c={toc:i};function d(e){var t=e.components,n=(0,l.Z)(e,s);return(0,r.kt)("wrapper",(0,a.Z)({},c,n,{components:t,mdxType:"MDXLayout"}),(0,r.kt)("p",null,(0,r.kt)("inlineCode",{parentName:"p"},"\u6458\u8bb0<Javascript\u9ad8\u7ea7\u7a0b\u5e8f\u8bbe\u8ba1> -- \u9a6c\u7279 2020\u7248 \u7b2c\u4e8c\u5341\u56db\u7ae0")),(0,r.kt)("h1",{id:"\u7f51\u7edc\u8bf7\u6c42\u4e0e\u8fdc\u7a0b\u8d44\u6e90"},"\u7f51\u7edc\u8bf7\u6c42\u4e0e\u8fdc\u7a0b\u8d44\u6e90"),(0,r.kt)("p",null,"2005 \u5e74\uff0cJesse James Garrett \u64b0\u5199\u4e86\u4e00\u7bc7\u6587\u7ae0\uff0c\u201cAjax\u2014A New Approach to Web Applications\u201d\u3002\u8fd9\u7bc7\u6587\u7ae0\u4e2d\u63cf\u7ed8\u4e86\u4e00\u4e2a\u88ab\u4ed6\u79f0\u4f5c Ajax\uff08Asynchronous JavaScript+XML\uff0c\u5373\u5f02\u6b65 JavaScript \u52a0 XML\uff09\u7684\u6280\u672f\u3002\u8fd9\u4e2a\u6280\u672f\u6d89\u53ca\u53d1\u9001\u670d\u52a1\u5668\u8bf7\u6c42\u989d\u5916\u6570\u636e\u800c\u4e0d\u5237\u65b0\u9875\u9762\uff0c\u4ece\u800c\u5b9e\u73b0\u66f4\u597d\u7684\u7528\u6237\u4f53\u9a8c\u3002"),(0,r.kt)("p",null,"\u628a Ajax \u63a8\u5230\u5386\u53f2\u821e\u53f0\u4e0a\u7684\u5173\u952e\u6280\u672f\u662f XMLHttpRequest\uff08XHR\uff09\u5bf9\u8c61\u3002 XHR \u51fa\u73b0\u4e4b\u524d\uff0cAjax \u98ce\u683c\u7684\u901a\u4fe1\u5fc5\u987b\u901a\u8fc7\u4e00\u4e9b\u9ed1\u79d1\u6280\u5b9e\u73b0\uff0c\u4e3b\u8981\u662f\u4f7f\u7528\u9690\u85cf\u7684\u7a97\u683c\u6216\u5185\u5d4c\u7a97\u683c\u3002XHR \u4e3a\u53d1\u9001\u670d\u52a1\u5668\u8bf7\u6c42\u548c\u83b7\u53d6\u54cd\u5e94\u63d0\u4f9b\u4e86\u5408\u7406\u7684\u63a5\u53e3\u3002\u8fd9\u4e2a\u63a5\u53e3\u53ef\u4ee5\u5b9e\u73b0\u5f02\u6b65\u4ece\u670d\u52a1\u5668\u83b7\u53d6\u989d\u5916\u6570\u636e\uff0c\u610f\u5473\u7740\u7528\u6237\u70b9\u51fb\u4e0d\u7528\u9875\u9762\u5237\u65b0\u4e5f\u53ef\u4ee5\u83b7\u53d6\u6570\u636e\u3002\u901a\u8fc7 XHR \u5bf9\u8c61\u83b7\u53d6\u6570\u636e\u540e\uff0c\u53ef\u4ee5\u4f7f\u7528 DOM \u65b9\u6cd5\u628a\u6570\u636e\u63d2\u5165\u7f51\u9875\u3002\u867d\u7136 Ajax \u8fd9\u4e2a\u540d\u79f0\u4e2d\u5305\u542b XML\uff0c\u4f46\u5b9e\u9645\u4e0a Ajax \u901a\u4fe1\u4e0e\u6570\u636e\u683c\u5f0f\u65e0\u5173\u3002\u8fd9\u4e2a\u6280\u672f\u4e3b\u8981\u662f\u53ef\u4ee5\u5b9e\u73b0\u5728\u4e0d\u5237\u65b0\u9875\u9762\u7684\u60c5\u51b5\u4e0b\u4ece\u670d\u52a1\u5668\u83b7\u53d6\u6570\u636e\uff0c\u683c\u5f0f\u5e76\u4e0d\u4e00\u5b9a\u662f XML\u3002"),(0,r.kt)("h2",{id:"xmlhttprequest-\u5bf9\u8c61"},"XMLHttpRequest \u5bf9\u8c61"),(0,r.kt)("p",null,"IE5 \u662f\u7b2c\u4e00\u4e2a\u5f15\u5165 XHR \u5bf9\u8c61\u7684\u6d4f\u89c8\u5668\u3002"),(0,r.kt)("p",null,"\u6240\u6709\u73b0\u4ee3\u6d4f\u89c8\u5668\u90fd\u901a\u8fc7 XMLHttpRequest \u6784\u9020\u51fd\u6570\u539f\u751f\u652f\u6301 XHR \u5bf9\u8c61\uff1a"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js"},"let xhr = new XMLHttpRequest();\n")),(0,r.kt)("h3",{id:"\u4f7f\u7528-xhr"},"\u4f7f\u7528 XHR"),(0,r.kt)("p",null,'\u4f7f\u7528 XHR \u5bf9\u8c61\u9996\u5148\u8981\u8c03\u7528 open()\u65b9\u6cd5\uff0c\u8fd9\u4e2a\u65b9\u6cd5\u63a5\u6536 3 \u4e2a\u53c2\u6570\uff1a\u8bf7\u6c42\u7c7b\u578b\uff08"get"\u3001"post"\u7b49\uff09\u3001\u8bf7\u6c42 URL\uff0c\u4ee5\u53ca\u8868\u793a\u8bf7\u6c42\u662f\u5426\u5f02\u6b65\u7684\u5e03\u5c14\u503c\u3002\u4e0b\u9762\u662f\u4e00\u4e2a\u4f8b\u5b50\uff1a'),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js"},'xhr.open("get", "example.php", false);\n')),(0,r.kt)("p",null,"\u8fd9\u884c\u4ee3\u7801\u5c31\u53ef\u4ee5\u5411 example.php \u53d1\u9001\u4e00\u4e2a\u540c\u6b65\u7684 GET \u8bf7\u6c42\u3002"),(0,r.kt)("p",null,"\u5173\u4e8e\u8fd9\u884c\u4ee3\u7801\u9700\u8981\u8bf4\u660e\u51e0\u70b9\u3002"),(0,r.kt)("p",null,"\u9996\u5148\uff0c\u8fd9\u91cc\u7684 URL \u662f\u76f8\u5bf9\u4e8e\u4ee3\u7801\u6240\u5728\u9875\u9762\u7684\uff0c\u5f53\u7136\u4e5f\u53ef\u4ee5\u4f7f\u7528\u7edd\u5bf9 URL\u3002"),(0,r.kt)("p",null,"\u5176\u6b21\uff0c\u8c03\u7528 open()\u4e0d\u4f1a\u5b9e\u9645\u53d1\u9001\u8bf7\u6c42\uff0c\u53ea\u662f\u4e3a\u53d1\u9001\u8bf7\u6c42\u505a\u597d\u51c6\u5907\u3002"),(0,r.kt)("div",{className:"admonition admonition-caution alert alert--warning"},(0,r.kt)("div",{parentName:"div",className:"admonition-heading"},(0,r.kt)("h5",{parentName:"div"},(0,r.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,r.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 16 16"},(0,r.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"}))),"\u6ce8\u610f")),(0,r.kt)("div",{parentName:"div",className:"admonition-content"},(0,r.kt)("p",{parentName:"div"},"\u53ea\u80fd\u8bbf\u95ee\u540c\u6e90 URL\uff0c\u4e5f\u5c31\u662f\u57df\u540d\u76f8\u540c\u3001\u7aef\u53e3\u76f8\u540c\u3001\u534f\u8bae\u76f8\u540c\u3002\u5982\u679c\u8bf7\u6c42\u7684 URL \u4e0e\n\u53d1\u9001\u8bf7\u6c42\u7684\u9875\u9762\u5728\u4efb\u4f55\u65b9\u9762\u6709\u6240\u4e0d\u540c\uff0c\u5219\u4f1a\u629b\u51fa\u5b89\u5168\u9519\u8bef\u3002"))),(0,r.kt)("p",null,"\u8981\u53d1\u9001\u5b9a\u4e49\u597d\u7684\u8bf7\u6c42\uff0c\u5fc5\u987b\u50cf\u4e0b\u9762\u8fd9\u6837\u8c03\u7528 send()\u65b9\u6cd5\uff1a"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js"},'xhr.open("get", "example.txt", false);\nxhr.send(null);\n')),(0,r.kt)("p",null,"send()\u65b9\u6cd5\u63a5\u6536\u4e00\u4e2a\u53c2\u6570\uff0c\u662f\u4f5c\u4e3a\u8bf7\u6c42\u4f53\u53d1\u9001\u7684\u6570\u636e\u3002\u5982\u679c\u4e0d\u9700\u8981\u53d1\u9001\u8bf7\u6c42\u4f53\uff0c\u5219\u5fc5\u987b\u4f20 null\uff0c\u56e0\u4e3a\u8fd9\u4e2a\u53c2\u6570\u5728\u67d0\u4e9b\u6d4f\u89c8\u5668\u4e2d\u662f\u5fc5\u9700\u7684\u3002\u8c03\u7528 send()\u4e4b\u540e\uff0c\u8bf7\u6c42\u5c31\u4f1a\u53d1\u9001\u5230\u670d\u52a1\u5668\u3002"),(0,r.kt)("p",null,"\u56e0\u4e3a\u8fd9\u4e2a\u8bf7\u6c42\u662f",(0,r.kt)("inlineCode",{parentName:"p"},"\u540c\u6b65"),"\u7684\uff0c\u6240\u4ee5 JavaScript \u4ee3\u7801\u4f1a\u7b49\u5f85\u670d\u52a1\u5668\u54cd\u5e94\u4e4b\u540e\u518d\u7ee7\u7eed\u6267\u884c\u3002\u6536\u5230\u54cd\u5e94\u540e\uff0cXHR\u5bf9\u8c61\u7684\u4ee5\u4e0b\u5c5e\u6027\u4f1a\u88ab\u586b\u5145\u4e0a\u6570\u636e\u3002"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"responseText\uff1a\u4f5c\u4e3a\u54cd\u5e94\u4f53\u8fd4\u56de\u7684\u6587\u672c\u3002"),(0,r.kt)("li",{parentName:"ul"},'responseXML\uff1a\u5982\u679c\u54cd\u5e94\u7684\u5185\u5bb9\u7c7b\u578b\u662f"text/xml"\u6216"application/xml"\uff0c\u90a3\u5c31\u662f\u5305\u542b\u54cd\u5e94\u6570\u636e\u7684 XML DOM \u6587\u6863\u3002'),(0,r.kt)("li",{parentName:"ul"},"status\uff1a\u54cd\u5e94\u7684 HTTP \u72b6\u6001\u3002"),(0,r.kt)("li",{parentName:"ul"},"statusText\uff1a\u54cd\u5e94\u7684 HTTP \u72b6\u6001\u63cf\u8ff0\u3002")),(0,r.kt)("p",null,"\u6536\u5230\u54cd\u5e94\u540e\uff0c\u7b2c\u4e00\u6b65\u8981\u68c0\u67e5 status \u5c5e\u6027\u4ee5\u786e\u4fdd\u54cd\u5e94\u6210\u529f\u8fd4\u56de\u3002\u4e00\u822c\u6765\u8bf4\uff0cHTTP \u72b6\u6001\u7801\u4e3a 2xx \u8868\u793a\u6210\u529f\u3002\u6b64\u65f6\uff0cresponseText \u6216 responseXML\uff08\u5982\u679c\u5185\u5bb9\u7c7b\u578b\u6b63\u786e\uff09\u5c5e\u6027\u4e2d\u4f1a\u6709\u5185\u5bb9\u3002\u5982\u679c HTTP\u72b6\u6001\u7801\u662f 304\uff0c\u5219\u8868\u793a\u8d44\u6e90\u672a\u4fee\u6539\u8fc7\uff0c\u662f\u4ece\u6d4f\u89c8\u5668\u7f13\u5b58\u4e2d\u76f4\u63a5\u62ff\u53d6\u7684\u3002\u5f53\u7136\u8fd9\u4e5f\u610f\u5473\u7740\u54cd\u5e94\u6709\u6548\u3002\u4e3a\u786e\u4fdd\u6536\u5230\u6b63\u786e\u7684\u54cd\u5e94\uff0c\u5e94\u8be5\u68c0\u67e5\u8fd9\u4e9b\u72b6\u6001\uff0c\u5982\u4e0b\u6240\u793a\uff1a"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js"},'xhr.open("get", "example.txt", false);\nxhr.send(null);\n\nif ((xhr.status >= 200 && xhr.status < 300) || xhr.status == 304) {\n alert(xhr.responseText);\n} else {\n alert("Request was unsuccessful: " + xhr.status);\n} \n')),(0,r.kt)("p",null,"\u4ee5\u4e0a\u4ee3\u7801\u53ef\u80fd\u663e\u793a\u670d\u52a1\u5668\u8fd4\u56de\u7684\u5185\u5bb9\uff0c\u4e5f\u53ef\u80fd\u663e\u793a\u9519\u8bef\u6d88\u606f\uff0c\u53d6\u51b3\u4e8e HTTP \u54cd\u5e94\u7684\u72b6\u6001\u7801\u3002\u4e3a\u786e\u5b9a\u4e0b\u4e00\u6b65\u8be5\u6267\u884c\u4ec0\u4e48\u64cd\u4f5c\uff0c\u6700\u597d\u68c0\u67e5 status \u800c\u4e0d\u662f statusText \u5c5e\u6027\uff0c\u56e0\u4e3a\u540e\u8005\u5df2\u7ecf\u88ab\u8bc1\u660e\u5728\u8de8\u6d4f\u89c8\u5668\u7684\u60c5\u51b5\u4e0b\u4e0d\u53ef\u9760\u3002\u65e0\u8bba\u662f\u4ec0\u4e48\u54cd\u5e94\u5185\u5bb9\u7c7b\u578b\uff0cresponseText \u5c5e\u6027\u59cb\u7ec8\u4f1a\u4fdd\u5b58\u54cd\u5e94\u4f53\uff0c\u800c responseXML\u5219\u5bf9\u4e8e\u975e XML \u6570\u636e\u662f null\u3002"),(0,r.kt)("p",null,"\u867d\u7136\u53ef\u4ee5\u50cf\u524d\u9762\u7684\u4f8b\u5b50\u4e00\u6837\u53d1\u9001\u540c\u6b65\u8bf7\u6c42\uff0c\u4f46\u591a\u6570\u60c5\u51b5\u4e0b\u6700\u597d\u4f7f\u7528\u5f02\u6b65\u8bf7\u6c42\uff0c\u8fd9\u6837\u53ef\u4ee5\u4e0d\u963b\u585eJavaScript \u4ee3\u7801\u7ee7\u7eed\u6267\u884c\u3002XHR \u5bf9\u8c61\u6709\u4e00\u4e2a readyState \u5c5e\u6027\uff0c\u8868\u793a\u5f53\u524d\u5904\u5728\u8bf7\u6c42/\u54cd\u5e94\u8fc7\u7a0b\u7684\u54ea\u4e2a\u9636\u6bb5\u3002\u8fd9\u4e2a\u5c5e\u6027\u6709\u5982\u4e0b\u53ef\u80fd\u7684\u503c\u3002"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"0\uff1a\u672a\u521d\u59cb\u5316\uff08Uninitialized\uff09\u3002\u5c1a\u672a\u8c03\u7528 open()\u65b9\u6cd5\u3002"),(0,r.kt)("li",{parentName:"ul"},"1\uff1a\u5df2\u6253\u5f00\uff08Open\uff09\u3002\u5df2\u8c03\u7528 open()\u65b9\u6cd5\uff0c\u5c1a\u672a\u8c03\u7528 send()\u65b9\u6cd5\u3002"),(0,r.kt)("li",{parentName:"ul"},"2\uff1a\u5df2\u53d1\u9001\uff08Sent\uff09\u3002\u5df2\u8c03\u7528 send()\u65b9\u6cd5\uff0c\u5c1a\u672a\u6536\u5230\u54cd\u5e94\u3002"),(0,r.kt)("li",{parentName:"ul"},"3\uff1a\u63a5\u6536\u4e2d\uff08Receiving\uff09\u3002\u5df2\u7ecf\u6536\u5230\u90e8\u5206\u54cd\u5e94\u3002"),(0,r.kt)("li",{parentName:"ul"},"4\uff1a\u5b8c\u6210\uff08Complete\uff09\u3002\u5df2\u7ecf\u6536\u5230\u6240\u6709\u54cd\u5e94\uff0c\u53ef\u4ee5\u4f7f\u7528\u4e86\u3002")),(0,r.kt)("p",null,"\u6bcf\u6b21 readyState \u4ece\u4e00\u4e2a\u503c\u53d8\u6210\u53e6\u4e00\u4e2a\u503c\uff0c\u90fd\u4f1a\u89e6\u53d1 readystatechange \u4e8b\u4ef6\u3002\u53ef\u4ee5\u501f\u6b64\u673a\u4f1a\u68c0\u67e5 readyState \u7684\u503c\u3002\u4e00\u822c\u6765\u8bf4\uff0c\u6211\u4eec\u552f\u4e00\u5173\u5fc3\u7684 readyState \u503c\u662f 4\uff0c\u8868\u793a\u6570\u636e\u5df2\u5c31\u7eea\u3002\u4e3a\u4fdd\u8bc1\u8de8\u6d4f\u89c8\u5668\u517c\u5bb9\uff0conreadystatechange \u4e8b\u4ef6\u5904\u7406\u7a0b\u5e8f\u5e94\u8be5\u5728\u8c03\u7528 open()\u4e4b\u524d\u8d4b\u503c\u3002\u6765\u770b\u4e0b\u9762\u7684\u4f8b\u5b50\uff1a"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js"},'let xhr = new XMLHttpRequest();\nxhr.onreadystatechange = function() {\n if (xhr.readyState == 4) {\n if ((xhr.status >= 200 && xhr.status < 300) || xhr.status == 304) {\n alert(xhr.responseText);\n } else {\n alert("Request was unsuccessful: " + xhr.status);\n }\n }\n};\nxhr.open("get", "example.txt", true);\nxhr.send(null); \n')),(0,r.kt)("p",null,"\u4ee5\u4e0a\u4ee3\u7801\u4f7f\u7528 DOM Level 0 \u98ce\u683c\u4e3a XHR \u5bf9\u8c61\u6dfb\u52a0\u4e86\u4e8b\u4ef6\u5904\u7406\u7a0b\u5e8f\uff0c\u56e0\u4e3a\u5e76\u4e0d\u662f\u6240\u6709\u6d4f\u89c8\u5668\u90fd\u652f\u6301DOM Level 2 \u98ce\u683c\u3002\u4e0e\u5176\u4ed6\u4e8b\u4ef6\u5904\u7406\u7a0b\u5e8f\u4e0d\u540c\uff0conreadystatechange \u4e8b\u4ef6\u5904\u7406\u7a0b\u5e8f\u4e0d\u4f1a\u6536\u5230 event\u5bf9\u8c61\u3002\u5728\u4e8b\u4ef6\u5904\u7406\u7a0b\u5e8f\u4e2d\uff0c\u5fc5\u987b\u4f7f\u7528 XHR \u5bf9\u8c61\u672c\u8eab\u6765\u786e\u5b9a\u63a5\u4e0b\u6765\u8be5\u505a\u4ec0\u4e48\u3002"),(0,r.kt)("div",{className:"admonition admonition-tip alert alert--success"},(0,r.kt)("div",{parentName:"div",className:"admonition-heading"},(0,r.kt)("h5",{parentName:"div"},(0,r.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,r.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"12",height:"16",viewBox:"0 0 12 16"},(0,r.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"}))),"tip")),(0,r.kt)("div",{parentName:"div",className:"admonition-content"},(0,r.kt)("p",{parentName:"div"},"\u7531\u4e8e onreadystatechange \u4e8b\u4ef6\u5904\u7406\u7a0b\u5e8f\u7684\u4f5c\u7528\u57df\u95ee\u9898\uff0c\u8fd9\u4e2a\u4f8b\u5b50\u5728 onreadystatechange \u4e8b\u4ef6\u5904\u7406\u7a0b\u5e8f\u4e2d\u4f7f\u7528\u4e86 xhr \u5bf9\u8c61\u800c\u4e0d\u662f this \u5bf9\u8c61\u3002\u4f7f\u7528 this \u53ef\u80fd\u5bfc\u81f4\n\u529f\u80fd\u5931\u8d25\u6216\u5bfc\u81f4\u9519\u8bef\uff0c\u53d6\u51b3\u4e8e\u7528\u6237\u4f7f\u7528\u7684\u662f\u4ec0\u4e48\u6d4f\u89c8\u5668\u3002\u56e0\u6b64\u8fd8\u662f\u4f7f\u7528\u4fdd\u5b58 XHR \u5bf9\u8c61\u7684\u53d8\u91cf\u66f4\u4fdd\u9669\u4e00\u4e9b\u3002"))),(0,r.kt)("p",null,"\u5728\u6536\u5230\u54cd\u5e94\u4e4b\u524d\u5982\u679c\u60f3\u53d6\u6d88\u5f02\u6b65\u8bf7\u6c42\uff0c\u53ef\u4ee5\u8c03\u7528 abort()\u65b9\u6cd5\uff1a"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js"},"xhr.abort();\n")),(0,r.kt)("p",null,"\u8c03\u7528\u8fd9\u4e2a\u65b9\u6cd5\u540e\uff0cXHR \u5bf9\u8c61\u4f1a\u505c\u6b62\u89e6\u53d1\u4e8b\u4ef6\uff0c\u5e76\u963b\u6b62\u8bbf\u95ee\u8fd9\u4e2a\u5bf9\u8c61\u4e0a\u4efb\u4f55\u4e0e\u54cd\u5e94\u76f8\u5173\u7684\u5c5e\u6027\u3002\u4e2d\u65ad\u8bf7\u6c42\u540e\uff0c\u5e94\u8be5\u53d6\u6d88\u5bf9 XHR \u5bf9\u8c61\u7684\u5f15\u7528\u3002\u7531\u4e8e\u5185\u5b58\u95ee\u9898\uff0c\u4e0d\u63a8\u8350\u91cd\u7528 XHR \u5bf9\u8c61\u3002"),(0,r.kt)("h3",{id:"http-\u5934\u90e8"},"HTTP \u5934\u90e8"),(0,r.kt)("p",null,"XHR \u5bf9\u8c61\u4f1a\u901a\u8fc7\u4e00\u4e9b\u65b9\u6cd5\u66b4\u9732\u4e0e\u8bf7\u6c42\u548c\u54cd\u5e94\u76f8\u5173\u7684\u5934\u90e8\u5b57\u6bb5\u3002\u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0cXHR \u8bf7\u6c42\u4f1a\u53d1\u9001\u4ee5\u4e0b\u5934\u90e8\u5b57\u6bb5\u3002"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"Accept\uff1a\u6d4f\u89c8\u5668\u53ef\u4ee5\u5904\u7406\u7684\u5185\u5bb9\u7c7b\u578b\u3002"),(0,r.kt)("li",{parentName:"ul"},"Accept-Charset\uff1a\u6d4f\u89c8\u5668\u53ef\u4ee5\u663e\u793a\u7684\u5b57\u7b26\u96c6\u3002"),(0,r.kt)("li",{parentName:"ul"},"Accept-Encoding\uff1a\u6d4f\u89c8\u5668\u53ef\u4ee5\u5904\u7406\u7684\u538b\u7f29\u7f16\u7801\u7c7b\u578b\u3002"),(0,r.kt)("li",{parentName:"ul"},"Accept-Language\uff1a\u6d4f\u89c8\u5668\u4f7f\u7528\u7684\u8bed\u8a00\u3002"),(0,r.kt)("li",{parentName:"ul"},"Connection\uff1a\u6d4f\u89c8\u5668\u4e0e\u670d\u52a1\u5668\u7684\u8fde\u63a5\u7c7b\u578b\u3002"),(0,r.kt)("li",{parentName:"ul"},"Cookie\uff1a\u9875\u9762\u4e2d\u8bbe\u7f6e\u7684 Cookie\u3002"),(0,r.kt)("li",{parentName:"ul"},"Host\uff1a\u53d1\u9001\u8bf7\u6c42\u7684\u9875\u9762\u6240\u5728\u7684\u57df\u3002"),(0,r.kt)("li",{parentName:"ul"},"Referer\uff1a\u53d1\u9001\u8bf7\u6c42\u7684\u9875\u9762\u7684 URI\u3002\u6ce8\u610f\uff0c\u8fd9\u4e2a\u5b57\u6bb5\u5728 HTTP \u89c4\u8303\u4e2d\u5c31\u62fc\u9519\u4e86\uff0c\u6240\u4ee5\u8003\u8651\u5230\u517c\u5bb9\u6027\u4e5f\u5fc5\u987b\u5c06\u9519\u5c31\u9519\u3002\uff08\u6b63\u786e\u7684\u62fc\u5199\u5e94\u8be5\u662f Referrer\u3002\uff09"),(0,r.kt)("li",{parentName:"ul"},"User-Agent\uff1a\u6d4f\u89c8\u5668\u7684\u7528\u6237\u4ee3\u7406\u5b57\u7b26\u4e32\u3002")),(0,r.kt)("p",null,"\u867d\u7136\u4e0d\u540c\u6d4f\u89c8\u5668\u53d1\u9001\u7684\u786e\u5207\u5934\u90e8\u5b57\u6bb5\u53ef\u80fd\u5404\u4e0d\u76f8\u540c\uff0c\u4f46\u8fd9\u4e9b\u901a\u5e38\u90fd\u662f\u4f1a\u53d1\u9001\u7684\u3002\u5982\u679c\u9700\u8981\u53d1\u9001\u989d\u5916\u7684\u8bf7\u6c42\u5934\u90e8\uff0c\u53ef\u4ee5\u4f7f\u7528 setRequestHeader()\u65b9\u6cd5\u3002\u8fd9\u4e2a\u65b9\u6cd5\u63a5\u6536\u4e24\u4e2a\u53c2\u6570\uff1a\u5934\u90e8\u5b57\u6bb5\u7684\u540d\u79f0\u548c\u503c\u3002\u4e3a\u4fdd\u8bc1\u8bf7\u6c42\u5934\u90e8\u88ab\u53d1\u9001\uff0c\u5fc5\u987b\u5728 open()\u4e4b\u540e\u3001send()\u4e4b\u524d\u8c03\u7528 setRequestHeader()\uff0c\u5982\u4e0b\u9762\u7684\u4f8b\u5b50\u6240\u793a\uff1a"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js"},'let xhr = new XMLHttpRequest();\nxhr.onreadystatechange = function() {\n if (xhr.readyState == 4) {\n if ((xhr.status >= 200 && xhr.status < 300) || xhr.status == 304) {\n  alert(xhr.responseText);\n } else {\n  alert("Request was unsuccessful: " + xhr.status);\n }\n }\n};\nxhr.open("get", "example.php", true);\nxhr.setRequestHeader("MyHeader", "MyValue");\nxhr.send(null); \n')),(0,r.kt)("p",null,"\u670d\u52a1\u5668\u901a\u8fc7\u8bfb\u53d6\u81ea\u5b9a\u4e49\u5934\u90e8\u53ef\u4ee5\u786e\u5b9a\u9002\u5f53\u7684\u64cd\u4f5c\u3002\u81ea\u5b9a\u4e49\u5934\u90e8\u4e00\u5b9a\u8981\u533a\u522b\u4e8e\u6d4f\u89c8\u5668\u6b63\u5e38\u53d1\u9001\u7684\u5934\u90e8\uff0c\u5426\u5219\u53ef\u80fd\u5f71\u54cd\u670d\u52a1\u5668\u6b63\u5e38\u54cd\u5e94\u3002\u6709\u4e9b\u6d4f\u89c8\u5668\u5141\u8bb8\u91cd\u5199\u9ed8\u8ba4\u5934\u90e8\uff0c\u6709\u4e9b\u6d4f\u89c8\u5668\u5219\u4e0d\u5141\u8bb8\u3002"),(0,r.kt)("p",null,"\u53ef\u4ee5\u4f7f\u7528 getResponseHeader()\u65b9\u6cd5\u4ece XHR \u5bf9\u8c61\u83b7\u53d6\u54cd\u5e94\u5934\u90e8\uff0c\u53ea\u8981\u4f20\u5165\u8981\u83b7\u53d6\u5934\u90e8\u7684\u540d\u79f0\u5373\u53ef\u3002\u5982\u679c\u60f3\u53d6\u5f97\u6240\u6709\u54cd\u5e94\u5934\u90e8\uff0c\u53ef\u4ee5\u4f7f\u7528 getAllResponseHeaders()\u65b9\u6cd5\uff0c\u8fd9\u4e2a\u65b9\u6cd5\u4f1a\u8fd4\u56de\u5305\u542b\u6240\u6709\u54cd\u5e94\u5934\u90e8\u7684\u5b57\u7b26\u4e32\u3002\u4e0b\u9762\u662f\u8c03\u7528\u8fd9\u4e24\u4e2a\u65b9\u6cd5\u7684\u4f8b\u5b50\uff1a"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js"},'let myHeader = xhr.getResponseHeader("MyHeader");\nlet allHeaders xhr.getAllResponseHeaders();\n')),(0,r.kt)("p",null,"\u670d\u52a1\u5668\u53ef\u4ee5\u4f7f\u7528\u5934\u90e8\u5411\u6d4f\u89c8\u5668\u4f20\u9012\u989d\u5916\u7684\u7ed3\u6784\u5316\u6570\u636e\u3002getAllResponseHeaders()\u65b9\u6cd5\u901a\u5e38\u8fd4\u56de\u7c7b\u4f3c\u5982\u4e0b\u7684\u5b57\u7b26\u4e32\uff1a"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-json"},"Date: Sun, 14 Nov 2004 18:04:03 GMT\nServer: Apache/1.3.29 (Unix)\nVary: Accept\nX-Powered-By: PHP/4.3.8\nConnection: close\nContent-Type: text/html; charset=iso-8859-1\n")),(0,r.kt)("p",null,"\u901a\u8fc7\u89e3\u6790\u4ee5\u4e0a\u5934\u90e8\u5b57\u6bb5\u7684\u8f93\u51fa\uff0c\u5c31\u53ef\u4ee5\u77e5\u9053\u670d\u52a1\u5668\u53d1\u9001\u7684\u6240\u6709\u5934\u90e8\uff0c\u800c\u4e0d\u9700\u8981\u5355\u72ec\u53bb\u68c0\u67e5\u4e86\u3002"),(0,r.kt)("h3",{id:"get-\u8bf7\u6c42"},"GET \u8bf7\u6c42"),(0,r.kt)("p",null,"\u6700\u5e38\u7528\u7684\u8bf7\u6c42\u65b9\u6cd5\u662f GET \u8bf7\u6c42\uff0c\u7528\u4e8e\u5411\u670d\u52a1\u5668\u67e5\u8be2\u67d0\u4e9b\u4fe1\u606f\u3002\u5fc5\u8981\u65f6\uff0c\u9700\u8981\u5728 GET \u8bf7\u6c42\u7684 URL\u540e\u9762\u6dfb\u52a0\u67e5\u8be2\u5b57\u7b26\u4e32\u53c2\u6570\u3002\u5bf9 XHR \u800c\u8a00\uff0c\u67e5\u8be2\u5b57\u7b26\u4e32\u5fc5\u987b\u6b63\u786e\u7f16\u7801\u540e\u6dfb\u52a0\u5230 URL \u540e\u9762\uff0c\u7136\u540e\u518d\u4f20\u7ed9open()\u65b9\u6cd5\u3002"),(0,r.kt)("p",null,"\u53d1\u9001 GET \u8bf7\u6c42\u6700\u5e38\u89c1\u7684\u4e00\u4e2a\u9519\u8bef\u662f\u67e5\u8be2\u5b57\u7b26\u4e32\u683c\u5f0f\u4e0d\u5bf9\u3002\u67e5\u8be2\u5b57\u7b26\u4e32\u4e2d\u7684\u6bcf\u4e2a\u540d\u548c\u503c\u90fd\u5fc5\u987b\u4f7f\u7528encodeURIComponent()\u7f16\u7801\uff0c\u6240\u6709\u540d/\u503c\u5bf9\u5fc5\u987b\u4ee5\u548c\u53f7\uff08&\uff09\u5206\u9694\uff0c\u5982\u4e0b\u9762\u7684\u4f8b\u5b50\u6240\u793a\uff1a"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js"},'xhr.open("get", "example.php?name1=value1&name2=value2", true);\n')),(0,r.kt)("p",null,"\u53ef\u4ee5\u4f7f\u7528\u4ee5\u4e0b\u51fd\u6570\u5c06\u67e5\u8be2\u5b57\u7b26\u4e32\u53c2\u6570\u6dfb\u52a0\u5230\u73b0\u6709\u7684 URL \u672b\u5c3e\uff1a"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js"},'function addURLParam(url, name, value) {\n url += (url.indexOf("?") == -1 ? "?" : "&");\n url += encodeURIComponent(name) + "=" + encodeURIComponent(value);\n return url;\n}\n')),(0,r.kt)("p",null,"\u8fd9\u91cc\u5b9a\u4e49\u4e86\u4e00\u4e2a addURLParam()\u51fd\u6570\uff0c\u5b83\u63a5\u6536 3 \u4e2a\u53c2\u6570\uff1a"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"\u8981\u6dfb\u52a0\u67e5\u8be2\u5b57\u7b26\u4e32\u7684 URL\u3001"),(0,r.kt)("li",{parentName:"ul"},"\u67e5\u8be2\u53c2\u6570"),(0,r.kt)("li",{parentName:"ul"},"\u53c2\u6570\u503c")),(0,r.kt)("p",null,"\u9996\u5148\uff0c\u8fd9\u4e2a\u51fd\u6570\u4f1a\u68c0\u67e5 URL \u4e2d\u662f\u5426\u5df2\u7ecf\u5305\u542b\u95ee\u53f7\uff08\u4ee5\u786e\u5b9a\u662f\u5426\u5df2\u7ecf\u5b58\u5728\u5176\u4ed6\u53c2\u6570\uff09\u3002\u5982\u679c\u6ca1\u6709\uff0c\u5219\u52a0\u4e0a\u4e00\u4e2a\u95ee\u53f7\uff1b\u5426\u5219\u5c31\u52a0\u4e0a\u4e00\u4e2a\u548c\u53f7\u3002\u7136\u540e\uff0c\u5206\u522b\u5bf9\u53c2\u6570\u540d\u548c\u53c2\u6570\u503c\u8fdb\u884c\u7f16\u7801\uff0c\u5e76\u6dfb\u52a0\u5230 URL \u672b\u5c3e\u3002\u6700\u540e\u4e00\u6b65\u662f\u8fd4\u56de\u66f4\u65b0\u540e\u7684 URL\u3002"),(0,r.kt)("p",null,"\u53ef\u4ee5\u4f7f\u7528\u8fd9\u4e2a\u51fd\u6570\u6784\u5efa\u8bf7\u6c42 URL\uff0c\u5982\u4e0b\u9762\u7684\u4f8b\u5b50\u6240\u793a\uff1a"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js"},'let url = "example.php";\n// \u6dfb\u52a0\u53c2\u6570\nurl = addURLParam(url, "name", "Nicholas");\nurl = addURLParam(url, "book", "Professional JavaScript");\n// \u521d\u59cb\u5316\u8bf7\u6c42\nxhr.open("get", url, false);\n')),(0,r.kt)("p",null,"\u8fd9\u91cc\u4f7f\u7528 addURLParam()\u51fd\u6570\u53ef\u4ee5\u4fdd\u8bc1\u901a\u8fc7 XHR \u53d1\u9001\u8bf7\u6c42\u7684 URL \u683c\u5f0f\u6b63\u786e\u3002"),(0,r.kt)("hr",null),(0,r.kt)("h3",{id:"post-\u8bf7\u6c42"},"POST \u8bf7\u6c42"),(0,r.kt)("p",null,'\u7b2c\u4e8c\u4e2a\u6700\u5e38\u7528\u7684\u8bf7\u6c42\u662f POST \u8bf7\u6c42\uff0c\u7528\u4e8e\u5411\u670d\u52a1\u5668\u53d1\u9001\u5e94\u8be5\u4fdd\u5b58\u7684\u6570\u636e\u3002\u6bcf\u4e2a POST \u8bf7\u6c42\u90fd\u5e94\u8be5\u5728\u8bf7\u6c42\u4f53\u4e2d\u643a\u5e26\u63d0\u4ea4\u7684\u6570\u636e\uff0c\u800c GET \u8bf7\u6c42\u5219\u4e0d\u7136\u3002POST \u8bf7\u6c42\u7684\u8bf7\u6c42\u4f53\u53ef\u4ee5\u5305\u542b\u975e\u5e38\u591a\u7684\u6570\u636e\uff0c\u800c\u4e14\u6570\u636e\u53ef\u4ee5\u662f\u4efb\u610f\u683c\u5f0f\u3002\u8981\u521d\u59cb\u5316 POST \u8bf7\u6c42\uff0copen()\u65b9\u6cd5\u7684\u7b2c\u4e00\u4e2a\u53c2\u6570\u8981\u4f20"post"\uff0c\u6bd4\u5982\uff1a'),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js"},'xhr.open("post", "example.php", true); \n')),(0,r.kt)("p",null,"\u53d1\u9001\u7684\u6570\u636e\u53ef\u4ee5\u4f20\u5165\u4efb\u610f\u5b57\u7b26\u4e32\u6216XML"),(0,r.kt)("p",null,'\u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0c\u5bf9\u670d\u52a1\u5668\u800c\u8a00\uff0cPOST \u8bf7\u6c42\u4e0e\u63d0\u4ea4\u8868\u5355\u662f\u4e0d\u4e00\u6837\u7684\u3002\u670d\u52a1\u5668\u903b\u8f91\u9700\u8981\u8bfb\u53d6\u539f\u59cb POST\u6570\u636e\u624d\u80fd\u53d6\u5f97\u6d4f\u89c8\u5668\u53d1\u9001\u7684\u6570\u636e\u3002\u4e0d\u8fc7\uff0c\u53ef\u4ee5\u4f7f\u7528 XHR \u6a21\u62df\u8868\u5355\u63d0\u4ea4\u3002\u4e3a\u6b64\uff0c\u7b2c\u4e00\u6b65\u9700\u8981\u628a ContentType \u5934\u90e8\u8bbe\u7f6e\u4e3a"application/x-www-formurlencoded"\uff0c\u8fd9\u662f\u63d0\u4ea4\u8868\u5355\u65f6\u4f7f\u7528\u7684\u5185\u5bb9\u7c7b\u578b\u3002'),(0,r.kt)("p",null,"\u7b2c\u4e8c\u6b65\u662f\u521b\u5efa\u5bf9\u5e94\u683c\u5f0f\u7684\u5b57\u7b26\u4e32\u3002POST \u6570\u636e\u6b64\u65f6\u4f7f\u7528\u4e0e\u67e5\u8be2\u5b57\u7b26\u4e32\u76f8\u540c\u7684\u683c\u5f0f\u3002\u5982\u679c\u7f51\u9875\u4e2d\u786e\u5b9e\u6709\u4e00\u4e2a\u8868\u5355\u9700\u8981\u5e8f\u5217\u5316\u5e76\u901a\u8fc7 XHR \u53d1\u9001\u5230\u670d\u52a1\u5668\uff0c\u5219\u53ef\u4ee5\u4f7f\u7528serialize()\u51fd\u6570\u6765\u521b\u5efa\u76f8\u5e94\u7684\u5b57\u7b26\u4e32\uff0c\u5982\u4e0b\u6240\u793a\uff1a"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js"},'function submitData() {\n let xhr = new XMLHttpRequest();\n xhr.onreadystatechange = function() {\n if (xhr.readyState == 4) {\n if ((xhr.status >= 200 && xhr.status < 300) || xhr.status == 304) {\n alert(xhr.responseText);\n } else {\n alert("Request was unsuccessful: " + xhr.status);\n }\n }\n };\n xhr.open("post", "postexample.php", true);\n xhr.setRequestHeader("Content-Type", "application/x-www-form-urlencoded");\n let form = document.getElementById("user-info");\n xhr.send(serialize(form));\n} \n')),(0,r.kt)("p",null,'\u5728\u8fd9\u4e2a\u51fd\u6570\u4e2d\uff0c\u6765\u81ea ID \u4e3a"user-info"\u7684\u8868\u5355\u4e2d\u7684\u6570\u636e\u88ab\u5e8f\u5217\u5316\u4e4b\u540e\u53d1\u9001\u7ed9\u4e86\u670d\u52a1\u5668\u3002PHP \u6587\u4ef6postexample.php \u968f\u540e\u53ef\u4ee5\u901a\u8fc7$_POST \u53d6\u5f97 POST \u7684\u6570\u636e\u3002\u6bd4\u5982:'),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-php"},"<?php\n header(\"Content-Type: text/plain\");\n echo <<<EOF\nName: {$_POST['user-name']}\nEmail: {$_POST['user-email']}\nEOF;\n?> \n")),(0,r.kt)("p",null,"\u5047\u5982\u6ca1\u6709\u53d1\u9001 Content-Type \u5934\u90e8\uff0cPHP \u7684\u5168\u5c40$_POST \u53d8\u91cf\u4e2d\u5c31\u4e0d\u4f1a\u5305\u542b\u6570\u636e\uff0c\u800c\u9700\u8981\u901a\u8fc7$HTTP_RAW_POST_DATA \u6765\u83b7\u53d6\u3002"),(0,r.kt)("div",{className:"admonition admonition-caution alert alert--warning"},(0,r.kt)("div",{parentName:"div",className:"admonition-heading"},(0,r.kt)("h5",{parentName:"div"},(0,r.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,r.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 16 16"},(0,r.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"}))),"\u6ce8\u610f")),(0,r.kt)("div",{parentName:"div",className:"admonition-content"},(0,r.kt)("p",{parentName:"div"},"POST \u8bf7\u6c42\u76f8\u6bd4 GET \u8bf7\u6c42\u8981\u5360\u7528\u66f4\u591a\u8d44\u6e90\u3002\u4ece\u6027\u80fd\u65b9\u9762\u8bf4\uff0c\u53d1\u9001\u76f8\u540c\u6570\u91cf\u7684\u6570\u636e\uff0c\nGET \u8bf7\u6c42\u6bd4 POST \u8bf7\u6c42\u8981\u5feb\u4e24\u500d\u3002"))),(0,r.kt)("h3",{id:"xmlhttprequest-level-2"},"XMLHttpRequest Level 2"),(0,r.kt)("p",null,"XHR \u5bf9\u8c61\u4f5c\u4e3a\u4e8b\u5b9e\u6807\u51c6\u7684\u8fc5\u901f\u6d41\u884c\uff0c\u4e5f\u4fc3\u4f7f W3C \u4e3a\u89c4\u8303\u8fd9\u4e00\u884c\u4e3a\u800c\u5236\u5b9a\u4e86\u6b63\u5f0f\u6807\u51c6\u3002XMLHttpRequest Level 1 \u53ea\u662f\u628a\u5df2\u7ecf\u5b58\u5728\u7684 XHR \u5bf9\u8c61\u7684\u5b9e\u73b0\u7ec6\u8282\u660e\u786e\u4e86\u4e00\u4e0b\u3002XMLHttpRequest Level 2\u53c8\u8fdb\u4e00\u6b65\u53d1\u5c55\u4e86 XHR \u5bf9\u8c61\u3002"),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"1. FormData \u7c7b\u578b")),(0,r.kt)("p",null,"\u73b0\u4ee3 Web \u5e94\u7528\u7a0b\u5e8f\u4e2d\u7ecf\u5e38\u9700\u8981\u5bf9\u8868\u5355\u6570\u636e\u8fdb\u884c\u5e8f\u5217\u5316\uff0c\u56e0\u6b64 XMLHttpRequest Level 2 \u65b0\u589e\u4e86FormData \u7c7b\u578b\u3002FormData \u7c7b\u578b\u4fbf\u4e8e\u8868\u5355\u5e8f\u5217\u5316\uff0c\u4e5f\u4fbf\u4e8e\u521b\u5efa\u4e0e\u8868\u5355\u7c7b\u4f3c\u683c\u5f0f\u7684\u6570\u636e\u7136\u540e\u901a\u8fc7 XHR\u53d1\u9001\u3002\u4e0b\u9762\u7684\u4ee3\u7801\u521b\u5efa\u4e86\u4e00\u4e2a FormData \u5bf9\u8c61\uff0c\u5e76\u586b\u5145\u4e86\u4e00\u4e9b\u6570\u636e\uff1a"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js"},'let data = new FormData();\ndata.append("name", "Nicholas"); \n')),(0,r.kt)("p",null,"append()\u65b9\u6cd5\u63a5\u6536\u4e24\u4e2a\u53c2\u6570\uff1a\u952e\u548c\u503c\uff0c\u76f8\u5f53\u4e8e\u8868\u5355\u5b57\u6bb5\u540d\u79f0\u548c\u8be5\u5b57\u6bb5\u7684\u503c\u3002\u53ef\u4ee5\u50cf\u8fd9\u6837\u6dfb\u52a0\u4efb\u610f\u591a\u4e2a\u952e/\u503c\u5bf9\u6570\u636e\u3002\u6b64\u5916\uff0c\u901a\u8fc7\u76f4\u63a5\u7ed9 FormData \u6784\u9020\u51fd\u6570\u4f20\u5165\u4e00\u4e2a\u8868\u5355\u5143\u7d20\uff0c\u4e5f\u53ef\u4ee5\u5c06\u8868\u5355\u4e2d\u7684\u6570\u636e\u4f5c\u4e3a\u952e/\u503c\u5bf9\u586b\u5145\u8fdb\u53bb\uff1a"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js"},"let data = new FormData(document.forms[0]);\n")),(0,r.kt)("p",null,"\u6709\u4e86 FormData \u5b9e\u4f8b\uff0c\u53ef\u4ee5\u50cf\u4e0b\u9762\u8fd9\u6837\u76f4\u63a5\u4f20\u7ed9 XHR \u5bf9\u8c61\u7684 send()\u65b9\u6cd5\uff1a"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js"},'let xhr = new XMLHttpRequest();\nxhr.onreadystatechange = function() {\n if (xhr.readyState == 4) {\n if ((xhr.status >= 200 && xhr.status < 300) || xhr.status == 304) {\n alert(xhr.responseText);\n } else {\n alert("Request was unsuccessful: " + xhr.status);\n }\n }\n};\nxhr.open("post", "postexample.php", true);\nlet form = document.getElementById("user-info");\nxhr.send(new FormData(form)); \n')),(0,r.kt)("p",null,"\u4f7f\u7528 FormData \u7684\u53e6\u4e00\u4e2a\u65b9\u4fbf\u4e4b\u5904\u662f\u4e0d\u518d\u9700\u8981\u7ed9 XHR \u5bf9\u8c61\u663e\u5f0f\u8bbe\u7f6e\u4efb\u4f55\u8bf7\u6c42\u5934\u90e8\u4e86\u3002XHR \u5bf9\u8c61\u80fd\u591f\u8bc6\u522b\u4f5c\u4e3a FormData \u5b9e\u4f8b\u4f20\u5165\u7684\u6570\u636e\u7c7b\u578b\u5e76\u81ea\u52a8\u914d\u7f6e\u76f8\u5e94\u7684\u5934\u90e8\u3002"),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"2. \u8d85\u65f6")),(0,r.kt)("p",null,"IE8 \u7ed9 XHR \u5bf9\u8c61\u589e\u52a0\u4e86\u4e00\u4e2a timeout \u5c5e\u6027\uff0c\u7528\u4e8e\u8868\u793a\u53d1\u9001\u8bf7\u6c42\u540e\u7b49\u5f85\u591a\u5c11\u6beb\u79d2\uff0c\u5982\u679c\u54cd\u5e94\u4e0d\u6210\u529f\u5c31\u4e2d\u65ad\u8bf7\u6c42\u3002\u4e4b\u540e\u6240\u6709\u6d4f\u89c8\u5668\u90fd\u5728\u81ea\u5df1\u7684 XHR \u5b9e\u73b0\u4e2d\u589e\u52a0\u4e86\u8fd9\u4e2a\u5c5e\u6027\u3002\u5728\u7ed9 timeout \u5c5e\u6027\u8bbe\u7f6e\u4e86\u4e00\u4e2a\u65f6\u95f4\u4e14\u5728\u8be5\u65f6\u95f4\u8fc7\u540e\u6ca1\u6709\u6536\u5230\u54cd\u5e94\u65f6\uff0cXHR \u5bf9\u8c61\u5c31\u4f1a\u89e6\u53d1 timeout \u4e8b\u4ef6\uff0c\u8c03\u7528 ontimeout \u4e8b\u4ef6\u5904\u7406\u7a0b\u5e8f\u3002\u8fd9\u4e2a\u7279\u6027\u540e\u6765\u4e5f\u88ab\u6dfb\u52a0\u5230\u4e86 XMLHttpRequest Level 2 \u89c4\u8303\u3002\u4e0b\u9762\u770b\u4e00\u4e2a\u4f8b\u5b50\uff1a"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js"},'let xhr = new XMLHttpRequest();\nxhr.onreadystatechange = function() {\n if (xhr.readyState == 4) {\n try {\n if ((xhr.status >= 200 && xhr.status < 300) || xhr.status == 304) {\n alert(xhr.responseText);\n } else {\n alert("Request was unsuccessful: " + xhr.status);\n }\n } catch (ex) {\n // \u5047\u8bbe\u7531 ontimeout \u5904\u7406\n }\n }\n};\nxhr.open("get", "timeout.php", true);\nxhr.timeout = 1000; // \u8bbe\u7f6e 1 \u79d2\u8d85\u65f6\nxhr.ontimeout = function() {\n alert("Request did not return in a second.");\n};\nxhr.send(null);\n')),(0,r.kt)("p",null,"\u8fd9\u4e2a\u4f8b\u5b50\u6f14\u793a\u4e86\u4f7f\u7528 timeout \u8bbe\u7f6e\u8d85\u65f6\u3002\u7ed9 timeout \u8bbe\u7f6e 1000 \u6beb\u79d2\u610f\u5473\u7740\uff0c\u5982\u679c\u8bf7\u6c42\u6ca1\u6709\u5728 1\u79d2\u949f\u5185\u8fd4\u56de\u5219\u4f1a\u4e2d\u65ad\u3002\u6b64\u65f6\u5219\u4f1a\u89e6\u53d1 ontimeout \u4e8b\u4ef6\u5904\u7406\u7a0b\u5e8f\uff0creadyState \u4ecd\u7136\u4f1a\u53d8\u6210 4\uff0c\u56e0\u6b64\u4e5f\u4f1a\u8c03\u7528 onreadystatechange \u4e8b\u4ef6\u5904\u7406\u7a0b\u5e8f\u3002\u4e0d\u8fc7\uff0c\u5982\u679c\u5728\u8d85\u65f6\u4e4b\u540e\u8bbf\u95ee status \u5c5e\u6027\u5219\u4f1a\u53d1\u751f\u9519\u8bef\u3002\u4e3a\u505a\u597d\u9632\u62a4\uff0c\u53ef\u4ee5\u628a\u68c0\u67e5 status \u5c5e\u6027\u7684\u4ee3\u7801\u5c01\u88c5\u5728 try/catch \u8bed\u53e5\u4e2d\u3002"),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"3. overrideMimeType()\u65b9\u6cd5")),(0,r.kt)("p",null,"\u7565"),(0,r.kt)("hr",null),(0,r.kt)("h2",{id:"\u8fdb\u5ea6\u4e8b\u4ef6"},"\u8fdb\u5ea6\u4e8b\u4ef6"),(0,r.kt)("p",null,"Progress Events \u662f W3C \u7684\u5de5\u4f5c\u8349\u6848\uff0c\u5b9a\u4e49\u4e86\u5ba2\u6237\u7aef\uf02d\u670d\u52a1\u5668\u7aef\u901a\u4fe1\u3002\u8fd9\u4e9b\u4e8b\u4ef6\u6700\u521d\u53ea\u9488\u5bf9 XHR\uff0c\u73b0\u5728\u4e5f\u63a8\u5e7f\u5230\u4e86\u5176\u4ed6\u7c7b\u4f3c\u7684 API\u3002\u6709\u4ee5\u4e0b 6 \u4e2a\u8fdb\u5ea6\u76f8\u5173\u7684\u4e8b\u4ef6\u3002"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"loadstart\uff1a\u5728\u63a5\u6536\u5230\u54cd\u5e94\u7684\u7b2c\u4e00\u4e2a\u5b57\u8282\u65f6\u89e6\u53d1\u3002"),(0,r.kt)("li",{parentName:"ul"},"progress\uff1a\u5728\u63a5\u6536\u54cd\u5e94\u671f\u95f4\u53cd\u590d\u89e6\u53d1\u3002"),(0,r.kt)("li",{parentName:"ul"},"error\uff1a\u5728\u8bf7\u6c42\u51fa\u9519\u65f6\u89e6\u53d1\u3002"),(0,r.kt)("li",{parentName:"ul"},"abort\uff1a\u5728\u8c03\u7528 abort()\u7ec8\u6b62\u8fde\u63a5\u65f6\u89e6\u53d1\u3002"),(0,r.kt)("li",{parentName:"ul"},"load\uff1a\u5728\u6210\u529f\u63a5\u6536\u5b8c\u54cd\u5e94\u65f6\u89e6\u53d1\u3002"),(0,r.kt)("li",{parentName:"ul"},"loadend\uff1a\u5728\u901a\u4fe1\u5b8c\u6210\u65f6\uff0c\u4e14\u5728 error\u3001abort \u6216 load \u4e4b\u540e\u89e6\u53d1\u3002")),(0,r.kt)("p",null,"\u6bcf\u6b21\u8bf7\u6c42\u90fd\u4f1a\u9996\u5148\u89e6\u53d1 loadstart \u4e8b\u4ef6\uff0c\u4e4b\u540e\u662f\u4e00\u4e2a\u6216\u591a\u4e2a progress \u4e8b\u4ef6\uff0c\u63a5\u7740\u662f error\u3001abort\u6216 load \u4e2d\u7684\u4e00\u4e2a\uff0c\u6700\u540e\u4ee5 loadend \u4e8b\u4ef6\u7ed3\u675f\u3002\u8fd9\u4e9b\u4e8b\u4ef6\u5927\u90e8\u5206\u90fd\u5f88\u597d\u7406\u89e3\uff0c\u4f46\u5176\u4e2d\u6709\u4e24\u4e2a\u9700\u8981\u8bf4\u660e\u4e00\u4e0b\u3002"),(0,r.kt)("h3",{id:"load-\u4e8b\u4ef6"},"load \u4e8b\u4ef6"),(0,r.kt)("p",null,"Firefox \u6700\u521d\u5728\u5b9e\u73b0 XHR \u7684\u65f6\u5019\uff0c\u66fe\u81f4\u529b\u4e8e\u7b80\u5316\u4ea4\u4e92\u6a21\u5f0f\u3002\u6700\u7ec8\uff0c\u589e\u52a0\u4e86\u4e00\u4e2a load \u4e8b\u4ef6\u7528\u4e8e\u66ff\u4ee3readystatechange \u4e8b\u4ef6\u3002load \u4e8b\u4ef6\u5728\u54cd\u5e94\u63a5\u6536\u5b8c\u6210\u540e\u7acb\u5373\u89e6\u53d1\uff0c\u8fd9\u6837\u5c31\u4e0d\u7528\u68c0\u67e5 readyState \u5c5e\u6027\u4e86\u3002onload \u4e8b\u4ef6\u5904\u7406\u7a0b\u5e8f\u4f1a\u6536\u5230\u4e00\u4e2a event \u5bf9\u8c61\uff0c\u5176 target \u5c5e\u6027\u8bbe\u7f6e\u4e3a XHR \u5b9e\u4f8b\uff0c\u5728\u8fd9\u4e2a\u5b9e\u4f8b\u4e0a\u53ef\u4ee5\u8bbf\u95ee\u6240\u6709 XHR \u5bf9\u8c61\u5c5e\u6027\u548c\u65b9\u6cd5\u3002\u4e0d\u8fc7\uff0c\u5e76\u4e0d\u662f\u6240\u6709\u6d4f\u89c8\u5668\u90fd\u5b9e\u73b0\u4e86\u8fd9\u4e2a\u4e8b\u4ef6\u7684 event \u5bf9\u8c61\u3002\u8003\u8651\u5230\u8de8\u6d4f\u89c8\u5668\u517c\u5bb9\uff0c\u8fd8\u662f\u9700\u8981\u50cf\u4e0b\u9762\u8fd9\u6837\u4f7f\u7528 XHR \u5bf9\u8c61\u53d8\u91cf\uff1a"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js"},'let xhr = new XMLHttpRequest();\nxhr.onload = function() {\n if ((xhr.status >= 200 && xhr.status < 300) || xhr.status == 304) {\n alert(xhr.responseText);\n } else {\n alert("Request was unsuccessful: " + xhr.status);\n }\n};\nxhr.open("get", "altevents.php", true);\nxhr.send(null);\n')),(0,r.kt)("p",null,"\u53ea\u8981\u662f\u4ece\u670d\u52a1\u5668\u6536\u5230\u54cd\u5e94\uff0c\u65e0\u8bba\u72b6\u6001\u7801\u662f\u4ec0\u4e48\uff0c\u90fd\u4f1a\u89e6\u53d1 load \u4e8b\u4ef6\u3002\u8fd9\u610f\u5473\u7740\u8fd8\u9700\u8981\u68c0\u67e5 status\u5c5e\u6027\u624d\u80fd\u786e\u5b9a\u6570\u636e\u662f\u5426\u6709\u6548\u3002Firefox\u3001Opera\u3001Chrome \u548c Safari \u90fd\u652f\u6301 load \u4e8b\u4ef6\u3002"),(0,r.kt)("h3",{id:"progress-\u4e8b\u4ef6"},"progress \u4e8b\u4ef6"),(0,r.kt)("p",null,"Mozilla \u5728 XHR \u5bf9\u8c61\u4e0a\u53e6\u4e00\u4e2a\u521b\u65b0\u662f progress \u4e8b\u4ef6\uff0c\u5728\u6d4f\u89c8\u5668\u63a5\u6536\u6570\u636e\u671f\u95f4\uff0c\u8fd9\u4e2a\u4e8b\u4ef6\u4f1a\u53cd\u590d\u89e6\u53d1\u3002\u6bcf\u6b21\u89e6\u53d1\u65f6\uff0conprogress \u4e8b\u4ef6\u5904\u7406\u7a0b\u5e8f\u90fd\u4f1a\u6536\u5230 event \u5bf9\u8c61\uff0c\u5176 target \u5c5e\u6027\u662f XHR \u5bf9\u8c61\uff0c\u4e14\u5305\u542b 3 \u4e2a\u989d\u5916\u5c5e\u6027\uff1alengthComputable\u3001position \u548c totalSize\u3002\u5176\u4e2d\uff0clengthComputable \u662f\u4e00\u4e2a\u5e03\u5c14\u503c\uff0c\u8868\u793a\u8fdb\u5ea6\u4fe1\u606f\u662f\u5426\u53ef\u7528\uff1bposition \u662f\u63a5\u6536\u5230\u7684\u5b57\u8282\u6570\uff1btotalSize \u662f\u54cd\u5e94\u7684 ContentLength \u5934\u90e8\u5b9a\u4e49\u7684\u603b\u5b57\u8282\u6570\u3002\u6709\u4e86\u8fd9\u4e9b\u4fe1\u606f\uff0c\u5c31\u53ef\u4ee5\u7ed9\u7528\u6237\u63d0\u4f9b\u8fdb\u5ea6\u6761\u4e86\u3002\u4ee5\u4e0b\u4ee3\u7801\u6f14\u793a\u4e86\u5982\u4f55\u5411\u7528\u6237\u5c55\u793a\u8fdb\u5ea6\uff1a"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js"},'let xhr = new XMLHttpRequest();\nxhr.onload = function(event) {\n if ((xhr.status >= 200 && xhr.status < 300) ||\n xhr.status == 304) {\n alert(xhr.responseText);\n } else {\n alert("Request was unsuccessful: " + xhr.status);\n }\n};\nxhr.onprogress = function(event) {\n let divStatus = document.getElementById("status");\n if (event.lengthComputable) {\n divStatus.innerHTML = "Received " + event.position + " of " +\n event.totalSize +\n" bytes";\n }\n};\nxhr.open("get", "altevents.php", true);\nxhr.send(null);\n')),(0,r.kt)("p",null,"\u4e3a\u4e86\u4fdd\u8bc1\u6b63\u786e\u6267\u884c\uff0c\u5fc5\u987b\u5728\u8c03\u7528 open()\u4e4b\u524d\u6dfb\u52a0 onprogress \u4e8b\u4ef6\u5904\u7406\u7a0b\u5e8f\u3002\u5728\u524d\u9762\u7684\u4f8b\u5b50\u4e2d\uff0c\u6bcf\u6b21\u89e6\u53d1 progress \u4e8b\u4ef6\u90fd\u4f1a\u66f4\u65b0 HTML \u5143\u7d20\u4e2d\u7684\u4fe1\u606f\u3002\u5047\u8bbe\u54cd\u5e94\u6709 Content-Length \u5934\u90e8\uff0c\u5c31\u53ef\u4ee5\u5229\u7528\u8fd9\u4e9b\u4fe1\u606f\u8ba1\u7b97\u51fa\u5df2\u7ecf\u6536\u5230\u54cd\u5e94\u7684\u767e\u5206\u6bd4\u3002"),(0,r.kt)("hr",null),(0,r.kt)("h2",{id:"\u8de8\u6e90\u8d44\u6e90\u5171\u4eab"},"\u8de8\u6e90\u8d44\u6e90\u5171\u4eab"),(0,r.kt)("p",null,"\u901a\u8fc7 XHR \u8fdb\u884c Ajax \u901a\u4fe1\u7684\u4e00\u4e2a\u4e3b\u8981\u9650\u5236\u662f\u8de8\u6e90\u5b89\u5168\u7b56\u7565\u3002\u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0cXHR \u53ea\u80fd\u8bbf\u95ee\u4e0e\u53d1\u8d77\u8bf7\u6c42\u7684\u9875\u9762\u5728\u540c\u4e00\u4e2a\u57df\u5185\u7684\u8d44\u6e90\u3002\u8fd9\u4e2a\u5b89\u5168\u9650\u5236\u53ef\u4ee5\u9632\u6b62\u67d0\u4e9b\u6076\u610f\u884c\u4e3a\u3002\u4e0d\u8fc7\uff0c\u6d4f\u89c8\u5668\u4e5f\u9700\u8981\u652f\u6301\u5408\u6cd5\u8de8\u6e90\u8bbf\u95ee\u7684\u80fd\u529b\u3002"),(0,r.kt)("p",null,"\u8de8\u6e90\u8d44\u6e90\u5171\u4eab\uff08CORS\uff0cCross-Origin Resource Sharing\uff09\u5b9a\u4e49\u4e86\u6d4f\u89c8\u5668\u4e0e\u670d\u52a1\u5668\u5982\u4f55\u5b9e\u73b0\u8de8\u6e90\u901a\u4fe1\u3002CORS \u80cc\u540e\u7684\u57fa\u672c\u601d\u8def\u5c31\u662f\u4f7f\u7528\u81ea\u5b9a\u4e49\u7684 HTTP \u5934\u90e8\u5141\u8bb8\u6d4f\u89c8\u5668\u548c\u670d\u52a1\u5668\u76f8\u4e92\u4e86\u89e3\uff0c\u4ee5\u786e\u5b9e\u8bf7\u6c42\u6216\u54cd\u5e94\u5e94\u8be5\u6210\u529f\u8fd8\u662f\u5931\u8d25\u3002"),(0,r.kt)("p",null,"\u5bf9\u4e8e\u7b80\u5355\u7684\u8bf7\u6c42\uff0c\u6bd4\u5982 GET \u6216 POST \u8bf7\u6c42\uff0c\u6ca1\u6709\u81ea\u5b9a\u4e49\u5934\u90e8\uff0c\u800c\u4e14\u8bf7\u6c42\u4f53\u662f text/plain \u7c7b\u578b\uff0c\u8fd9\u6837\u7684\u8bf7\u6c42\u5728\u53d1\u9001\u65f6\u4f1a\u6709\u4e00\u4e2a\u989d\u5916\u7684\u5934\u90e8\u53eb Origin\u3002Origin \u5934\u90e8\u5305\u542b\u53d1\u9001\u8bf7\u6c42\u7684\u9875\u9762\u7684\u6e90\uff08\u534f\u8bae\u3001\u57df\u540d\u548c\u7aef\u53e3\uff09\uff0c\u4ee5\u4fbf\u670d\u52a1\u5668\u786e\u5b9a\u662f\u5426\u4e3a\u5176\u63d0\u4f9b\u54cd\u5e94\u3002\u4e0b\u9762\u662f Origin \u5934\u90e8\u7684\u4e00\u4e2a\u793a\u4f8b\uff1a"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"Origin: http://www.nczonline.net\n")),(0,r.kt)("p",null,'\u5982\u679c\u670d\u52a1\u5668\u51b3\u5b9a\u54cd\u5e94\u8bf7\u6c42\uff0c\u90a3\u4e48\u5e94\u8be5\u53d1\u9001 Access-Control-Allow-Origin \u5934\u90e8\uff0c\u5305\u542b\u76f8\u540c\u7684\u6e90\uff1b\u6216\u8005\u5982\u679c\u8d44\u6e90\u662f\u516c\u5f00\u7684\uff0c\u90a3\u4e48\u5c31\u5305\u542b"*"\u3002\u6bd4\u5982\uff1a'),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"Access-Control-Allow-Origin: http://www.nczonline.net\n")),(0,r.kt)("p",null,"\u5982\u679c\u6ca1\u6709\u8fd9\u4e2a\u5934\u90e8\uff0c\u6216\u8005\u6709\u4f46\u6e90\u4e0d\u5339\u914d\uff0c\u5219\u8868\u660e\u4e0d\u4f1a\u54cd\u5e94\u6d4f\u89c8\u5668\u8bf7\u6c42\u3002\u5426\u5219\uff0c\u670d\u52a1\u5668\u5c31\u4f1a\u5904\u7406\u8fd9\u4e2a\u8bf7\u6c42\u3002\u6ce8\u610f\uff0c\u65e0\u8bba\u8bf7\u6c42\u8fd8\u662f\u54cd\u5e94\u90fd\u4e0d\u4f1a\u5305\u542b cookie \u4fe1\u606f\u3002"),(0,r.kt)("p",null,"\u73b0\u4ee3\u6d4f\u89c8\u5668\u901a\u8fc7 XMLHttpRequest \u5bf9\u8c61\u539f\u751f\u652f\u6301 CORS\u3002\u5728\u5c1d\u8bd5\u8bbf\u95ee\u4e0d\u540c\u6e90\u7684\u8d44\u6e90\u65f6\uff0c\u8fd9\u4e2a\u884c\u4e3a\u4f1a\u88ab\u81ea\u52a8\u89e6\u53d1\u3002\u8981\u5411\u4e0d\u540c\u57df\u7684\u6e90\u53d1\u9001\u8bf7\u6c42\uff0c\u53ef\u4ee5\u4f7f\u7528\u6807\u51c6 XHR\u5bf9\u8c61\u5e76\u7ed9 open()\u65b9\u6cd5\u4f20\u5165\u4e00\u4e2a\u7edd\u5bf9 URL\uff0c\u6bd4\u5982\uff1a"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js"},'let xhr = new XMLHttpRequest();\nxhr.onreadystatechange = function() {\n if (xhr.readyState == 4) {\n if ((xhr.status >= 200 && xhr.status < 300) || xhr.status == 304) {\n alert(xhr.responseText);\n } else {\n alert("Request was unsuccessful: " + xhr.status);\n }\n }\n};\nxhr.open("get", "http://www.somewhere-else.com/page/", true);\nxhr.send(null);\n')),(0,r.kt)("p",null,"\u8de8\u57df XHR \u5bf9\u8c61\u5141\u8bb8\u8bbf\u95ee status \u548c statusText \u5c5e\u6027\uff0c\u4e5f\u5141\u8bb8\u540c\u6b65\u8bf7\u6c42\u3002\u51fa\u4e8e\u5b89\u5168\u8003\u8651\uff0c\u8de8\u57df XHR\u5bf9\u8c61\u4e5f\u65bd\u52a0\u4e86\u4e00\u4e9b\u989d\u5916\u9650\u5236\u3002"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"\u4e0d\u80fd\u4f7f\u7528 setRequestHeader()\u8bbe\u7f6e\u81ea\u5b9a\u4e49\u5934\u90e8\u3002"),(0,r.kt)("li",{parentName:"ul"},"\u4e0d\u80fd\u53d1\u9001\u548c\u63a5\u6536 cookie\u3002"),(0,r.kt)("li",{parentName:"ul"},"getAllResponseHeaders()\u65b9\u6cd5\u59cb\u7ec8\u8fd4\u56de\u7a7a\u5b57\u7b26\u4e32\u3002")),(0,r.kt)("p",null,"\u56e0\u4e3a\u65e0\u8bba\u540c\u57df\u8fd8\u662f\u8de8\u57df\u8bf7\u6c42\u90fd\u4f7f\u7528\u540c\u4e00\u4e2a\u63a5\u53e3\uff0c\u6240\u4ee5\u6700\u597d\u5728\u8bbf\u95ee\u672c\u5730\u8d44\u6e90\u65f6\u4f7f\u7528\u76f8\u5bf9 URL\uff0c\u5728\u8bbf\u95ee\u8fdc\u7a0b\u8d44\u6e90\u65f6\u4f7f\u7528\u7edd\u5bf9 URL\u3002\u8fd9\u6837\u53ef\u4ee5\u66f4\u660e\u786e\u5730\u533a\u5206\u4f7f\u7528\u573a\u666f\uff0c\u540c\u65f6\u907f\u514d\u51fa\u73b0\u8bbf\u95ee\u672c\u5730\u8d44\u6e90\u65f6\u51fa\u73b0\u5934\u90e8\u6216cookie \u4fe1\u606f\u8bbf\u95ee\u53d7\u9650\u7684\u95ee\u9898\u3002"),(0,r.kt)("h3",{id:"\u9884\u68c0\u8bf7\u6c42"},"\u9884\u68c0\u8bf7\u6c42"),(0,r.kt)("p",null,"CORS \u901a\u8fc7\u4e00\u79cd\u53eb\u9884\u68c0\u8bf7\u6c42\uff08preflighted request\uff09\u7684\u670d\u52a1\u5668\u9a8c\u8bc1\u673a\u5236\uff0c\u5141\u8bb8\u4f7f\u7528\u81ea\u5b9a\u4e49\u5934\u90e8\u3001\u9664 GET\u548c POST \u4e4b\u5916\u7684\u65b9\u6cd5\uff0c\u4ee5\u53ca\u4e0d\u540c\u8bf7\u6c42\u4f53\u5185\u5bb9\u7c7b\u578b\u3002\u5728\u8981\u53d1\u9001\u6d89\u53ca\u4e0a\u8ff0\u67d0\u79cd\u9ad8\u7ea7\u9009\u9879\u7684\u8bf7\u6c42\u65f6\uff0c\u4f1a\u5148\u5411\u670d\u52a1\u5668\u53d1\u9001\u4e00\u4e2a\u201c\u9884\u68c0\u201d\u8bf7\u6c42\u3002\u8fd9\u4e2a\u8bf7\u6c42\u4f7f\u7528 OPTIONS \u65b9\u6cd5\u53d1\u9001\u5e76\u5305\u542b\u4ee5\u4e0b\u5934\u90e8\u3002"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"Origin\uff1a\u4e0e\u7b80\u5355\u8bf7\u6c42\u76f8\u540c\u3002"),(0,r.kt)("li",{parentName:"ul"},"Access-Control-Request-Method\uff1a\u8bf7\u6c42\u5e0c\u671b\u4f7f\u7528\u7684\u65b9\u6cd5\u3002"),(0,r.kt)("li",{parentName:"ul"},"Access-Control-Request-Headers\uff1a\uff08\u53ef\u9009\uff09\u8981\u4f7f\u7528\u7684\u9017\u53f7\u5206\u9694\u7684\u81ea\u5b9a\u4e49\u5934\u90e8\u5217\u8868\u3002")),(0,r.kt)("p",null,"\u4e0b\u9762\u662f\u4e00\u4e2a\u5047\u8bbe\u7684 POST \u8bf7\u6c42\uff0c\u5305\u542b\u81ea\u5b9a\u4e49\u7684 NCZ \u5934\u90e8\uff1a"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"Origin: http://www.nczonline.net\nAccess-Control-Request-Method: POST\nAccess-Control-Request-Headers: NCZ\n")),(0,r.kt)("p",null,"\u5728\u8fd9\u4e2a\u8bf7\u6c42\u53d1\u9001\u540e\uff0c\u670d\u52a1\u5668\u53ef\u4ee5\u786e\u5b9a\u662f\u5426\u5141\u8bb8\u8fd9\u79cd\u7c7b\u578b\u7684\u8bf7\u6c42\u3002\u670d\u52a1\u5668\u4f1a\u901a\u8fc7\u5728\u54cd\u5e94\u4e2d\u53d1\u9001\u5982\u4e0b\u5934\u90e8\u4e0e\u6d4f\u89c8\u5668\u6c9f\u901a\u8fd9\u4e9b\u4fe1\u606f\u3002"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"Access-Control-Allow-Origin\uff1a\u4e0e\u7b80\u5355\u8bf7\u6c42\u76f8\u540c\u3002"),(0,r.kt)("li",{parentName:"ul"},"Access-Control-Allow-Methods\uff1a\u5141\u8bb8\u7684\u65b9\u6cd5\uff08\u9017\u53f7\u5206\u9694\u7684\u5217\u8868\uff09\u3002"),(0,r.kt)("li",{parentName:"ul"},"Access-Control-Allow-Headers\uff1a\u670d\u52a1\u5668\u5141\u8bb8\u7684\u5934\u90e8\uff08\u9017\u53f7\u5206\u9694\u7684\u5217\u8868\uff09\u3002"),(0,r.kt)("li",{parentName:"ul"},"Access-Control-Max-Age\uff1a\u7f13\u5b58\u9884\u68c0\u8bf7\u6c42\u7684\u79d2\u6570\u3002")),(0,r.kt)("p",null,"\u4f8b\u5982\uff1a"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"Access-Control-Allow-Origin: http://www.nczonline.net\nAccess-Control-Allow-Methods: POST, GET\nAccess-Control-Allow-Headers: NCZ\nAccess-Control-Max-Age: 1728000\n")),(0,r.kt)("p",null,"\u9884\u68c0\u8bf7\u6c42\u8fd4\u56de\u540e\uff0c\u7ed3\u679c\u4f1a\u6309\u54cd\u5e94\u6307\u5b9a\u7684\u65f6\u95f4\u7f13\u5b58\u4e00\u6bb5\u65f6\u95f4\u3002\u6362\u53e5\u8bdd\u8bf4\uff0c\u53ea\u6709\u7b2c\u4e00\u6b21\u53d1\u9001\u8fd9\u79cd\u7c7b\u578b\u7684\u8bf7\u6c42\u65f6\u624d\u4f1a\u591a\u53d1\u9001\u4e00\u6b21\u989d\u5916\u7684 HTTP \u8bf7\u6c42\u3002"),(0,r.kt)("h3",{id:"\u51ed\u636e\u8bf7\u6c42"},"\u51ed\u636e\u8bf7\u6c42"),(0,r.kt)("p",null,"\u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0c\u8de8\u6e90\u8bf7\u6c42\u4e0d\u63d0\u4f9b\u51ed\u636e\uff08cookie\u3001HTTP \u8ba4\u8bc1\u548c\u5ba2\u6237\u7aef SSL \u8bc1\u4e66\uff09\u3002\u53ef\u4ee5\u901a\u8fc7\u5c06withCredentials \u5c5e\u6027\u8bbe\u7f6e\u4e3a true \u6765\u8868\u660e\u8bf7\u6c42\u4f1a\u53d1\u9001\u51ed\u636e\u3002\u5982\u679c\u670d\u52a1\u5668\u5141\u8bb8\u5e26\u51ed\u636e\u7684\u8bf7\u6c42\uff0c\u90a3\u4e48\u53ef\u4ee5\u5728\u54cd\u5e94\u4e2d\u5305\u542b\u5982\u4e0b HTTP \u5934\u90e8\uff1a"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"Access-Control-Allow-Credentials: true\n")),(0,r.kt)("p",null,"\u5982\u679c\u53d1\u9001\u4e86\u51ed\u636e\u8bf7\u6c42\u800c\u670d\u52a1\u5668\u8fd4\u56de\u7684\u54cd\u5e94\u4e2d\u6ca1\u6709\u8fd9\u4e2a\u5934\u90e8\uff0c\u5219\u6d4f\u89c8\u5668\u4e0d\u4f1a\u628a\u54cd\u5e94\u4ea4\u7ed9 JavaScript\uff08responseText \u662f\u7a7a\u5b57\u7b26\u4e32\uff0cstatus \u662f 0\uff0conerror()\u88ab\u8c03\u7528\uff09\u3002\u6ce8\u610f\uff0c\u670d\u52a1\u5668\u4e5f\u53ef\u4ee5\u5728\u9884\u68c0\u8bf7\u6c42\u7684\u54cd\u5e94\u4e2d\u53d1\u9001\u8fd9\u4e2a HTTP \u5934\u90e8\uff0c\u4ee5\u8868\u660e\u8fd9\u4e2a\u6e90\u5141\u8bb8\u53d1\u9001\u51ed\u636e\u8bf7\u6c42\u3002"),(0,r.kt)("hr",null),(0,r.kt)("h2",{id:"\u66ff\u4ee3\u6027\u8de8\u6e90\u6280\u672f"},"\u66ff\u4ee3\u6027\u8de8\u6e90\u6280\u672f"),(0,r.kt)("p",null,"CORS \u51fa\u73b0\u4e4b\u524d\uff0c\u5b9e\u73b0\u8de8\u6e90 Ajax \u901a\u4fe1\u662f\u6709\u70b9\u9ebb\u70e6\u7684\u3002\u5f00\u53d1\u8005\u9700\u8981\u4f9d\u8d56\u80fd\u591f\u6267\u884c\u8de8\u6e90\u8bf7\u6c42\u7684 DOM \u7279\u6027\uff0c\u5728\u4e0d\u4f7f\u7528 XHR \u5bf9\u8c61\u60c5\u51b5\u4e0b\u53d1\u9001\u67d0\u79cd\u7c7b\u578b\u7684\u8bf7\u6c42\u3002\u867d\u7136 CORS \u76ee\u524d\u5df2\u7ecf\u5f97\u5230\u5e7f\u6cdb\u652f\u6301\uff0c\u4f46\u8fd9\u4e9b\u6280\u672f\u4ecd\u7136\u6ca1\u6709\u8fc7\u65f6\uff0c\u56e0\u4e3a\u5b83\u4eec\u4e0d\u9700\u8981\u4fee\u6539\u670d\u52a1\u5668\u3002"),(0,r.kt)("h3",{id:"\u56fe\u7247\u63a2\u6d4b"},"\u56fe\u7247\u63a2\u6d4b"),(0,r.kt)("p",null,"\u56fe\u7247\u63a2\u6d4b\u662f\u5229\u7528",(0,r.kt)("inlineCode",{parentName:"p"},"<img>"),"\u6807\u7b7e\u5b9e\u73b0\u8de8\u57df\u901a\u4fe1\u7684\u6700\u65e9\u7684\u4e00\u79cd\u6280\u672f\u3002\u4efb\u4f55\u9875\u9762\u90fd\u53ef\u4ee5\u8de8\u57df\u52a0\u8f7d\u56fe\u7247\u800c\u4e0d\u5fc5\u62c5\u5fc3\u9650\u5236\uff0c\u56e0\u6b64\u8fd9\u4e5f\u662f\u5728\u7ebf\u5e7f\u544a\u8ddf\u8e2a\u7684\u4e3b\u8981\u65b9\u5f0f\u3002\u53ef\u4ee5\u52a8\u6001\u521b\u5efa\u56fe\u7247\uff0c\u7136\u540e\u901a\u8fc7\u5b83\u4eec\u7684 onload \u548conerror \u4e8b\u4ef6\u5904\u7406\u7a0b\u5e8f\u5f97\u77e5\u4f55\u65f6\u6536\u5230\u54cd\u5e94\u3002"),(0,r.kt)("p",null,"\u8fd9\u79cd\u52a8\u6001\u521b\u5efa\u56fe\u7247\u7684\u6280\u672f\u7ecf\u5e38\u7528\u4e8e\u56fe\u7247\u63a2\u6d4b\uff08image pings\uff09\u3002\u56fe\u7247\u63a2\u6d4b\u662f\u4e0e\u670d\u52a1\u5668\u4e4b\u95f4\u7b80\u5355\u3001\u8de8\u57df\u3001\u5355\u5411\u7684\u901a\u4fe1\u3002\u6570\u636e\u901a\u8fc7\u67e5\u8be2\u5b57\u7b26\u4e32\u53d1\u9001\uff0c\u54cd\u5e94\u53ef\u4ee5\u968f\u610f\u8bbe\u7f6e\uff0c\u4e0d\u8fc7\u4e00\u822c\u662f\u4f4d\u56fe\u56fe\u7247\u6216\u503c\u4e3a 204 \u7684\u72b6\u6001\u7801\u3002\u6d4f\u89c8\u5668\u901a\u8fc7\u56fe\u7247\u63a2\u6d4b\u62ff\u4e0d\u5230\u4efb\u4f55\u6570\u636e\uff0c\u4f46\u53ef\u4ee5\u901a\u8fc7\u76d1\u542c onload \u548c onerror \u4e8b\u4ef6\u77e5\u9053\u4ec0\u4e48\u65f6\u5019\u80fd\u63a5\u6536\u5230\u54cd\u5e94\u3002\u4e0b\u9762\u770b\u4e00\u4e2a\u4f8b\u5b50\uff1a"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js"},'let img = new Image();\nimg.onload = img.onerror = function() {\n alert("Done!");\n};\nimg.src = "http://www.example.com/test?name=Nicholas";\n')),(0,r.kt)("p",null,"\u8fd9\u4e2a\u4f8b\u5b50\u521b\u5efa\u4e86\u4e00\u4e2a\u65b0\u7684 Image \u5b9e\u4f8b\uff0c\u7136\u540e\u4e3a\u5b83\u7684 onload \u548c onerror \u4e8b\u4ef6\u5904\u7406\u7a0b\u5e8f\u6dfb\u52a0\u4e86\u540c\u4e00\u4e2a\u51fd\u6570\u3002\u8fd9\u6837\u53ef\u4ee5\u786e\u4fdd\u8bf7\u6c42\u5b8c\u6210\u65f6\u65e0\u8bba\u4ec0\u4e48\u54cd\u5e94\u90fd\u4f1a\u6536\u5230\u901a\u77e5\u3002\u8bbe\u7f6e\u5b8c src \u5c5e\u6027\u4e4b\u540e\u8bf7\u6c42\u5c31\u5f00\u59cb\u4e86\uff0c\u8fd9\u4e2a\u4f8b\u5b50\u5411\u670d\u52a1\u5668\u53d1\u9001\u4e86\u4e00\u4e2a name \u503c\u3002"),(0,r.kt)("p",null,"\u56fe\u7247\u63a2\u6d4b\u9891\u7e41\u7528\u4e8e\u8ddf\u8e2a\u7528\u6237\u5728\u9875\u9762\u4e0a\u7684\u70b9\u51fb\u64cd\u4f5c\u6216\u52a8\u6001\u663e\u793a\u5e7f\u544a\u3002\u5f53\u7136\uff0c\u56fe\u7247\u63a2\u6d4b\u7684\u7f3a\u70b9\u662f\u53ea\u80fd\u53d1\u9001 GET \u8bf7\u6c42\u548c\u65e0\u6cd5\u83b7\u53d6\u670d\u52a1\u5668\u54cd\u5e94\u7684\u5185\u5bb9\u3002\u8fd9\u4e5f\u662f\u53ea\u80fd\u5229\u7528\u56fe\u7247\u63a2\u6d4b\u5b9e\u73b0\u6d4f\u89c8\u5668\u4e0e\u670d\u52a1\u5668\u5355\u5411\u901a\u4fe1\u7684\u539f\u56e0\u3002"),(0,r.kt)("h3",{id:"jsonp"},"JSONP"),(0,r.kt)("p",null,"JSONP \u662f\u201cJSON with padding\u201d\u7684\u7b80\u5199\uff0c\u662f\u5728 Web \u670d\u52a1\u4e0a\u6d41\u884c\u7684\u4e00\u79cd JSON \u53d8\u4f53\u3002JSONP \u770b\u8d77\u6765\u8ddf JSON \u4e00\u6837\uff0c\u53ea\u662f\u4f1a\u88ab\u5305\u5728\u4e00\u4e2a\u51fd\u6570\u8c03\u7528\u91cc\uff0c\u6bd4\u5982\uff1a"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js"},'callback({ "name": "Nicholas" }); \n')),(0,r.kt)("p",null,"JSONP \u683c\u5f0f\u5305\u542b\u4e24\u4e2a\u90e8\u5206\uff1a\u56de\u8c03\u548c\u6570\u636e\u3002\u56de\u8c03\u662f\u5728\u9875\u9762\u63a5\u6536\u5230\u54cd\u5e94\u4e4b\u540e\u5e94\u8be5\u8c03\u7528\u7684\u51fd\u6570\uff0c\u901a\u5e38\u56de\u8c03\u51fd\u6570\u7684\u540d\u79f0\u662f\u901a\u8fc7\u8bf7\u6c42\u6765\u52a8\u6001\u6307\u5b9a\u7684\u3002\u800c\u6570\u636e\u5c31\u662f\u4f5c\u4e3a\u53c2\u6570\u4f20\u7ed9\u56de\u8c03\u51fd\u6570\u7684 JSON \u6570\u636e\u3002\u4e0b\u9762\u662f\u4e00\u4e2a\u5178\u578b\u7684 JSONP \u8bf7\u6c42\uff1a"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js"},"http://freegeoip.net/json/?callback=handleResponse\n")),(0,r.kt)("p",null,"\u8fd9\u4e2a JSONP \u8bf7\u6c42\u7684 URL \u662f\u4e00\u4e2a\u5730\u7406\u4f4d\u7f6e\u670d\u52a1\u3002JSONP \u670d\u52a1\u901a\u5e38\u652f\u6301\u4ee5\u67e5\u8be2\u5b57\u7b26\u4e32\u5f62\u5f0f\u6307\u5b9a\u56de\u8c03\u51fd\u6570\u7684\u540d\u79f0\u3002\u6bd4\u5982\u8fd9\u4e2a\u4f8b\u5b50\u5c31\u628a\u56de\u8c03\u51fd\u6570\u7684\u540d\u5b57\u6307\u5b9a\u4e3a handleResponse()\u3002"),(0,r.kt)("p",null,"JSONP \u8c03\u7528\u662f\u901a\u8fc7\u52a8\u6001\u521b\u5efa",(0,r.kt)("inlineCode",{parentName:"p"},"<script>"),"\u5143\u7d20\u5e76\u4e3a src \u5c5e\u6027\u6307\u5b9a\u8de8\u57df URL \u5b9e\u73b0\u7684\u3002\u6b64\u65f6\u7684",(0,r.kt)("inlineCode",{parentName:"p"},"<script>"),"\u4e0e",(0,r.kt)("inlineCode",{parentName:"p"},"<img>"),"\u5143\u7d20\u7c7b\u4f3c\uff0c\u80fd\u591f\u4e0d\u53d7\u9650\u5236\u5730\u4ece\u5176\u4ed6\u57df\u52a0\u8f7d\u8d44\u6e90\u3002\u56e0\u4e3a JSONP \u662f\u6709\u6548\u7684 JavaScript\uff0c\u6240\u4ee5 JSONP\u54cd\u5e94\u5728\u88ab\u52a0\u8f7d\u5b8c\u6210\u4e4b\u540e\u4f1a\u7acb\u5373\u6267\u884c\u3002\u6bd4\u5982\u4e0b\u9762\u8fd9\u4e2a\u4f8b\u5b50\uff1a"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js"},'function handleResponse(response) {\n console.log(`\n You\'re at IP address ${response.ip}, which is in\n ${response.city}, ${response.region_name}`);\n}\nlet script = document.createElement("script");\nscript.src = "http://freegeoip.net/json/?callback=handleResponse";\ndocument.body.insertBefore(script, document.body.firstChild);\n')),(0,r.kt)("p",null,"JSONP \u7531\u4e8e\u5176\u7b80\u5355\u6613\u7528\uff0c\u5728\u5f00\u53d1\u8005\u4e2d\u975e\u5e38\u6d41\u884c\u3002\u76f8\u6bd4\u4e8e\u56fe\u7247\u63a2\u6d4b\uff0c\u4f7f\u7528 JSONP \u53ef\u4ee5\u76f4\u63a5\u8bbf\u95ee\u54cd\u5e94\uff0c\u5b9e\u73b0\u6d4f\u89c8\u5668\u4e0e\u670d\u52a1\u5668\u7684\u53cc\u5411\u901a\u4fe1\u3002\u4e0d\u8fc7 JSONP \u4e5f\u6709\u4e00\u4e9b\u7f3a\u70b9\u3002"),(0,r.kt)("p",null,"\u9996\u5148\uff0cJSONP \u662f\u4ece\u4e0d\u540c\u7684\u57df\u62c9\u53d6\u53ef\u6267\u884c\u4ee3\u7801\u3002\u5982\u679c\u8fd9\u4e2a\u57df\u5e76\u4e0d\u53ef\u4fe1\uff0c\u5219\u53ef\u80fd\u5728\u54cd\u5e94\u4e2d\u52a0\u5165\u6076\u610f\u5185\u5bb9\u3002\u6b64\u65f6\u9664\u4e86\u5b8c\u5168\u5220\u9664 JSONP \u6ca1\u6709\u5176\u4ed6\u529e\u6cd5\u3002\u5728\u4f7f\u7528\u4e0d\u53d7\u63a7\u7684 Web \u670d\u52a1\u65f6\uff0c\u4e00\u5b9a\u8981\u4fdd\u8bc1\u662f\u53ef\u4ee5\u4fe1\u4efb\u7684\u3002"),(0,r.kt)("p",null,"\u7b2c\u4e8c\u4e2a\u7f3a\u70b9\u662f\u4e0d\u597d\u786e\u5b9a JSONP \u8bf7\u6c42\u662f\u5426\u5931\u8d25\u3002\u867d\u7136 HTML5 \u89c4\u5b9a\u4e86",(0,r.kt)("inlineCode",{parentName:"p"},"<script>"),"\u5143\u7d20\u7684 onerror \u4e8b\u4ef6\u5904\u7406\u7a0b\u5e8f\uff0c\u4f46\u8fd8\u6ca1\u6709\u88ab\u4efb\u4f55\u6d4f\u89c8\u5668\u5b9e\u73b0\u3002\u4e3a\u6b64\uff0c\u5f00\u53d1\u8005\u7ecf\u5e38\u4f7f\u7528\u8ba1\u65f6\u5668\u6765\u51b3\u5b9a\u662f\u5426\u653e\u5f03\u7b49\u5f85\u54cd\u5e94\u3002\u8fd9\u79cd\u65b9\u5f0f\u5e76\u4e0d\u51c6\u786e\uff0c\u6bd5\u7adf\u4e0d\u540c\u7528\u6237\u7684\u7f51\u7edc\u8fde\u63a5\u901f\u5ea6\u548c\u5e26\u5bbd\u662f\u4e0d\u4e00\u6837\u7684\u3002"),(0,r.kt)("hr",null),(0,r.kt)("h2",{id:"fetch-api"},"Fetch API"),(0,r.kt)("p",null,"Fetch API \u80fd\u591f\u6267\u884c XMLHttpRequest \u5bf9\u8c61\u7684\u6240\u6709\u4efb\u52a1\uff0c\u4f46\u66f4\u5bb9\u6613\u4f7f\u7528\uff0c\u63a5\u53e3\u4e5f\u66f4\u73b0\u4ee3\u5316\uff0c\u80fd\u591f\u5728Web \u5de5\u4f5c\u7ebf\u7a0b\u7b49\u73b0\u4ee3 Web \u5de5\u5177\u4e2d\u4f7f\u7528\u3002XMLHttpRequest \u53ef\u4ee5\u9009\u62e9\u5f02\u6b65\uff0c\u800c Fetch API \u5219\u5fc5\u987b\u662f\u5f02\u6b65\u3002"),(0,r.kt)("p",null,"Fetch API \u662f WHATWG \u7684\u4e00\u4e2a\u201c\u6d3b\u6807\u51c6\u201d\uff08living standard\uff09\uff0c\u7528\u89c4\u8303\u539f\u6587\u8bf4\uff0c\u5c31\u662f\u201cFetch \u6807\u51c6\u5b9a\u4e49\u8bf7\u6c42\u3001\u54cd\u5e94\uff0c\u4ee5\u53ca\u7ed1\u5b9a\u4e8c\u8005\u7684\u6d41\u7a0b\uff1a\u83b7\u53d6\uff08fetch\uff09\u201d\u3002"),(0,r.kt)("p",null,"Fetch API \u672c\u8eab\u662f\u4f7f\u7528 JavaScript \u8bf7\u6c42\u8d44\u6e90\u7684\u4f18\u79c0\u5de5\u5177\uff0c\u540c\u65f6\u8fd9\u4e2a API \u4e5f\u80fd\u591f\u5e94\u7528\u5728\u670d\u52a1\u7ebf\u7a0b\uff08service worker\uff09\u4e2d\uff0c\u63d0\u4f9b\u62e6\u622a\u3001\u91cd\u5b9a\u5411\u548c\u4fee\u6539\u901a\u8fc7 fetch()\u751f\u6210\u7684\u8bf7\u6c42\u63a5\u53e3\u3002"),(0,r.kt)("h3",{id:"\u57fa\u672c\u7528\u6cd5"},"\u57fa\u672c\u7528\u6cd5"),(0,r.kt)("p",null,"fetch()\u65b9\u6cd5\u662f\u66b4\u9732\u5728\u5168\u5c40\u4f5c\u7528\u57df\u4e2d\u7684\uff0c\u5305\u62ec\u4e3b\u9875\u9762\u6267\u884c\u7ebf\u7a0b\u3001\u6a21\u5757\u548c\u5de5\u4f5c\u7ebf\u7a0b\u3002\u8c03\u7528\u8fd9\u4e2a\u65b9\u6cd5\uff0c\u6d4f\u89c8\u5668\u5c31\u4f1a\u5411\u7ed9\u5b9a URL \u53d1\u9001\u8bf7\u6c42\u3002"),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"1. \u5206\u6d3e\u8bf7\u6c42")),(0,r.kt)("p",null,"fetch()\u53ea\u6709\u4e00\u4e2a\u5fc5\u9700\u7684\u53c2\u6570 input\u3002\u591a\u6570\u60c5\u51b5\u4e0b\uff0c\u8fd9\u4e2a\u53c2\u6570\u662f\u8981\u83b7\u53d6\u8d44\u6e90\u7684 URL\u3002\u8fd9\u4e2a\u65b9\u6cd5\u8fd4\u56de\u4e00\u4e2a\u671f\u7ea6\uff1a"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js"},"let r = fetch('/bar');\nconsole.log(r); // Promise <pending> \n")),(0,r.kt)("p",null,"URL \u7684\u683c\u5f0f\uff08\u76f8\u5bf9\u8def\u5f84\u3001\u7edd\u5bf9\u8def\u5f84\u7b49\uff09\u7684\u89e3\u91ca\u4e0e XHR \u5bf9\u8c61\u4e00\u6837"),(0,r.kt)("p",null,"\u8bf7\u6c42\u5b8c\u6210\u3001\u8d44\u6e90\u53ef\u7528\u65f6\uff0c\u671f\u7ea6\u4f1a\u89e3\u51b3\u4e3a\u4e00\u4e2a Response \u5bf9\u8c61\u3002\u8fd9\u4e2a\u5bf9\u8c61\u662f API \u7684\u5c01\u88c5\uff0c\u53ef\u4ee5\u901a\u8fc7\u5b83\u53d6\u5f97\u76f8\u5e94\u8d44\u6e90\u3002\u83b7\u53d6\u8d44\u6e90\u8981\u4f7f\u7528\u8fd9\u4e2a\u5bf9\u8c61\u7684\u5c5e\u6027\u548c\u65b9\u6cd5\uff0c\u638c\u63e1\u54cd\u5e94\u7684\u60c5\u51b5\u5e76\u5c06\u8d1f\u8f7d\u8f6c\u6362\u4e3a\u6709\u7528\u7684\u5f62\u5f0f\uff0c\u5982\u4e0b\u6240\u793a\uff1a"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js"},"fetch('bar.txt')\n .then((response) => {\n console.log(response);\n });\n// Response { type: \"basic\", url: ... }\n\n")),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"2. \u8bfb\u53d6\u54cd\u5e94")),(0,r.kt)("p",null,"\u8bfb\u53d6\u54cd\u5e94\u5185\u5bb9\u7684\u6700\u7b80\u5355\u65b9\u5f0f\u662f\u53d6\u5f97\u7eaf\u6587\u672c\u683c\u5f0f\u7684\u5185\u5bb9\uff0c\u8fd9\u8981\u7528\u5230 text()\u65b9\u6cd5\u3002\u8fd9\u4e2a\u65b9\u6cd5\u8fd4\u56de\u4e00\u4e2a\u671f\u7ea6\uff0c\u4f1a\u89e3\u51b3\u4e3a\u53d6\u5f97\u8d44\u6e90\u7684\u5b8c\u6574\u5185\u5bb9\uff1a"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js"},"fetch('bar.txt')\n .then((response) => {\n response.text().then((data) => {\n console.log(data);\n });\n });\n// bar.txt \u7684\u5185\u5bb9\n")),(0,r.kt)("p",null,"\u5185\u5bb9\u7684\u7ed3\u6784\u901a\u5e38\u662f\u6253\u5e73\u7684\uff1a"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js"},"fetch('bar.txt')\n .then((response) => response.text())\n .then((data) => console.log(data));\n// bar.txt \u7684\u5185\u5bb9\n")),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"3. \u5904\u7406\u72b6\u6001\u7801\u548c\u8bf7\u6c42\u5931\u8d25")),(0,r.kt)("p",null,"Fetch API \u652f\u6301\u901a\u8fc7 Response \u7684 status\uff08\u72b6\u6001\u7801\uff09\u548c statusText\uff08\u72b6\u6001\u6587\u672c\uff09\u5c5e\u6027\u68c0\u67e5\u54cd\u5e94\u72b6\u6001\u3002\u6210\u529f\u83b7\u53d6\u54cd\u5e94\u7684\u8bf7\u6c42\u901a\u5e38\u4f1a\u4ea7\u751f\u503c\u4e3a 200 \u7684\u72b6\u6001\u7801\uff0c\u5982\u4e0b\u6240\u793a\uff1a"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js"},"fetch('/bar')\n .then((response) => {\n console.log(response.status); // 200\n console.log(response.statusText); // OK\n });\n")))}d.isMDXComponent=!0}}]);