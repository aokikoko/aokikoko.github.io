"use strict";(self.webpackChunkwebsite=self.webpackChunkwebsite||[]).push([[381],{3905:function(t,e,n){n.d(e,{Zo:function(){return u},kt:function(){return m}});var l=n(67294);function r(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function a(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(t);e&&(l=l.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,l)}return n}function p(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?a(Object(n),!0).forEach((function(e){r(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):a(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function o(t,e){if(null==t)return{};var n,l,r=function(t,e){if(null==t)return{};var n,l,r={},a=Object.keys(t);for(l=0;l<a.length;l++)n=a[l],e.indexOf(n)>=0||(r[n]=t[n]);return r}(t,e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);for(l=0;l<a.length;l++)n=a[l],e.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(t,n)&&(r[n]=t[n])}return r}var i=l.createContext({}),s=function(t){var e=l.useContext(i),n=e;return t&&(n="function"==typeof t?t(e):p(p({},e),t)),n},u=function(t){var e=s(t.components);return l.createElement(i.Provider,{value:e},t.children)},g={inlineCode:"code",wrapper:function(t){var e=t.children;return l.createElement(l.Fragment,{},e)}},c=l.forwardRef((function(t,e){var n=t.components,r=t.mdxType,a=t.originalType,i=t.parentName,u=o(t,["components","mdxType","originalType","parentName"]),c=s(n),m=r,d=c["".concat(i,".").concat(m)]||c[m]||g[m]||a;return n?l.createElement(d,p(p({ref:e},u),{},{components:n})):l.createElement(d,p({ref:e},u))}));function m(t,e){var n=arguments,r=e&&e.mdxType;if("string"==typeof t||r){var a=n.length,p=new Array(a);p[0]=c;var o={};for(var i in e)hasOwnProperty.call(e,i)&&(o[i]=e[i]);o.originalType=t,o.mdxType="string"==typeof t?t:r,p[1]=o;for(var s=2;s<a;s++)p[s]=n[s];return l.createElement.apply(null,p)}return l.createElement.apply(null,n)}c.displayName="MDXCreateElement"},86725:function(t,e,n){n.r(e),n.d(e,{contentTitle:function(){return i},default:function(){return c},frontMatter:function(){return o},metadata:function(){return s},toc:function(){return u}});var l=n(87462),r=n(63366),a=(n(67294),n(3905)),p=["components"],o={title:"[Nginx] \u5b9e\u73b0gzip\u538b\u7f29\u4e0e\u65e5\u5fd7\u67e5\u770b",sidebar_position:6},i=void 0,s={unversionedId:"Nginx/gzip",id:"Nginx/gzip",title:"[Nginx] \u5b9e\u73b0gzip\u538b\u7f29\u4e0e\u65e5\u5fd7\u67e5\u770b",description:"\u9ed8\u8ba4\u5b98\u65b9\u6a21\u5757",source:"@site/docs/Nginx/gzip.md",sourceDirName:"Nginx",slug:"/Nginx/gzip",permalink:"/docs/Nginx/gzip",editUrl:"https://github.com/aokikoko/aokikoko.github.io/blob/main/website/docs/Nginx/gzip.md",tags:[],version:"current",sidebarPosition:6,frontMatter:{title:"[Nginx] \u5b9e\u73b0gzip\u538b\u7f29\u4e0e\u65e5\u5fd7\u67e5\u770b",sidebar_position:6},sidebar:"tutorialSidebar",previous:{title:"[Nginx] \u4f01\u4e1a\u7ea7\u5e38\u89c1\u914d\u7f6e",permalink:"/docs/Nginx/server"},next:{title:"[Nginx] URL\u5339\u914d\u4e4blocation",permalink:"/docs/Nginx/location"}},u=[{value:"\u9ed8\u8ba4\u5b98\u65b9\u6a21\u5757",id:"\u9ed8\u8ba4\u5b98\u65b9\u6a21\u5757",children:[{value:"1\u3001Gzip \u538b\u7f29",id:"1gzip-\u538b\u7f29",children:[],level:3},{value:"2\u3001\u5ba2\u6237\u7aef\u7f13\u5b58",id:"2\u5ba2\u6237\u7aef\u7f13\u5b58",children:[],level:3},{value:"3\u3001\u57fa\u4e8e IP \u7684\u8bbf\u95ee\u63a7\u5236",id:"3\u57fa\u4e8e-ip-\u7684\u8bbf\u95ee\u63a7\u5236",children:[],level:3},{value:"4\u3001\u57fa\u4e8e\u7528\u6237\u7684\u8bbf\u95ee\u63a7\u5236",id:"4\u57fa\u4e8e\u7528\u6237\u7684\u8bbf\u95ee\u63a7\u5236",children:[],level:3},{value:"5\u3001\u76ee\u5f55\u5217\u8868\u663e\u793a",id:"5\u76ee\u5f55\u5217\u8868\u663e\u793a",children:[],level:3},{value:"6\u3001\u53cd\u5411\u4ee3\u7406",id:"6\u53cd\u5411\u4ee3\u7406",children:[],level:3}],level:2},{value:"\u65e5\u5fd7\u7ba1\u7406",id:"\u65e5\u5fd7\u7ba1\u7406",children:[{value:"1\u3001\u8bbf\u95ee\u65e5\u5fd7",id:"1\u8bbf\u95ee\u65e5\u5fd7",children:[],level:3},{value:"2\u3001\u9519\u8bef\u65e5\u5fd7",id:"2\u9519\u8bef\u65e5\u5fd7",children:[],level:3},{value:"3\u3001\u57fa\u4e8e\u57df\u540d\u65e5\u5fd7\u5206\u5272",id:"3\u57fa\u4e8e\u57df\u540d\u65e5\u5fd7\u5206\u5272",children:[],level:3}],level:2}],g={toc:u};function c(t){var e=t.components,o=(0,r.Z)(t,p);return(0,a.kt)("wrapper",(0,l.Z)({},g,o,{components:e,mdxType:"MDXLayout"}),(0,a.kt)("h2",{id:"\u9ed8\u8ba4\u5b98\u65b9\u6a21\u5757"},"\u9ed8\u8ba4\u5b98\u65b9\u6a21\u5757"),(0,a.kt)("h3",{id:"1gzip-\u538b\u7f29"},"1\u3001Gzip \u538b\u7f29"),(0,a.kt)("p",null,"\u538b\u7f29\u6587\u4ef6\uff0c\u4f7f\u6587\u4ef6\u53d8\u5c0f\uff0c\u4f20\u8f93\u66f4\u5feb\u4e86\u3002\u76ee\u524d\u5e02\u573a\u4e0a\u5927\u90e8\u5206\u6d4f\u89c8\u5668\u662f\u652f\u6301 gizp \u7684\u3002IE6 \u4ee5\u4e0b\u652f\u6301\u4e0d\u597d\uff0c\u4f1a\u51fa\u73b0\u4e71\u7801\u60c5\u51b5\u3002"),(0,a.kt)("p",null,(0,a.kt)("strong",{parentName:"p"},"\u5b98\u65b9\u6587\u6863"),"\uff1a",(0,a.kt)("a",{parentName:"p",href:"http://nginx.org/en/docs/http/ngx_http_gzip_module.html"},"http://nginx.org/en/docs/http/ngx_http_gzip_module.html")),(0,a.kt)("p",null,(0,a.kt)("strong",{parentName:"p"},"\u793a\u4f8b\u8bed\u6cd5\uff1a")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-shell"},"#\u914d\u7f6e\u5230http\u6bb5\u91cc\uff0c\u4f7f\u6574\u4e2ahttp\u670d\u52a1\u90fd\u542f\u7528gzip\u538b\u7f29\n#\u5f00\u542fgzip\u538b\u7f29\ngzip on;\n#http\u534f\u8bae\u7248\u672c\ngzip_http_version 1.0;\n#IE\u6d4f\u89c8\u5668\u4e0d\u5f00\u542fgzip  IE6\u4ee5\u4e0b\u4f1a\u4e71\u7801\ngzip_disable 'MSIE [1-6].';\n#\u5f00\u542fgzip \u6587\u4ef6\u7684\u683c\u5f0f\ngzip_types image/jpeg image/jpg image/png text/plain text/css;\n")),(0,a.kt)("p",null,"\u9a8c\u8bc1\u6587\u4ef6\u662f\u5426\u5f00\u542f gzip"),(0,a.kt)("hr",null),(0,a.kt)("h3",{id:"2\u5ba2\u6237\u7aef\u7f13\u5b58"},"2\u3001\u5ba2\u6237\u7aef\u7f13\u5b58"),(0,a.kt)("p",null,"B/S \u67b6\u6784\u91cc browser \u6d4f\u89c8\u5668 \u5c31\u662f\u5ba2\u6237\u7aef"),(0,a.kt)("p",null,"\u544a\u77e5\u6d4f\u89c8\u5668\u83b7\u53d6\u7684\u4fe1\u606f\u662f\u5728\u67d0\u4e2a\u533a\u95f4\u65f6\u95f4\u6bb5\u662f\u6709\u6548\u7684\u3002"),(0,a.kt)("p",null,"\u5b98\u65b9\u6587\u6863\uff1a",(0,a.kt)("a",{parentName:"p",href:"http://nginx.org/en/docs/http/ngx_http_headers_module.html#expires"},"http://nginx.org/en/docs/http/ngx_http_headers_module.html#expires")),(0,a.kt)("p",null,(0,a.kt)("strong",{parentName:"p"},"\u793a\u4f8b\u8bed\u6cd5\uff1a")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-nginx"},"location ~ \\.(js|css)$ {\n    #\u5355\u4f4d\u53c2\u6570 d day \u5929|H hour \u5c0f\u65f6  M \u5206\n    expires 1h;\n}\n\n#\u5728\u6574\u4e2ahttp\u4e2d\u751f\u6548  \u914d\u7f6e\u5230http\u6bb5\u91cc\nexpires 1h\n")),(0,a.kt)("h3",{id:"3\u57fa\u4e8e-ip-\u7684\u8bbf\u95ee\u63a7\u5236"},"3\u3001\u57fa\u4e8e IP \u7684\u8bbf\u95ee\u63a7\u5236"),(0,a.kt)("p",null,"\u57fa\u4e8e ngx_http_access_module \u6a21\u5757\uff0c\u9ed8\u8ba4\u53ef\u4f7f\u7528"),(0,a.kt)("p",null,"\u5b98\u65b9\u6587\u6863\uff1a",(0,a.kt)("a",{parentName:"p",href:"http://nginx.org/en/docs/http/ngx_http_access_module.html"},"http://nginx.org/en/docs/http/ngx_http_access_module.html")),(0,a.kt)("blockquote",null,(0,a.kt)("p",{parentName:"blockquote"},"\u8bed\u6cd5\uff1a"),(0,a.kt)("p",{parentName:"blockquote"},"==deny ip== \u7981\u6b62 ip \u8bbf\u95ee"),(0,a.kt)("p",{parentName:"blockquote"},"allow ip \u5141\u8bb8\u8bbf\u95ee")),(0,a.kt)("h3",{id:"4\u57fa\u4e8e\u7528\u6237\u7684\u8bbf\u95ee\u63a7\u5236"},"4\u3001\u57fa\u4e8e\u7528\u6237\u7684\u8bbf\u95ee\u63a7\u5236"),(0,a.kt)("p",null,"\u57fa\u4e8e ngx_http_auth_basic_module \u6a21\u5757\uff0c\u9ed8\u8ba4\u53ef\u7528"),(0,a.kt)("p",null,"\u5b98\u65b9\u6587\u6863\uff1a",(0,a.kt)("a",{parentName:"p",href:"http://nginx.org/en/docs/http/ngx_http_auth_basic_module.html"},"http://nginx.org/en/docs/http/ngx_http_auth_basic_module.html")),(0,a.kt)("blockquote",null,(0,a.kt)("p",{parentName:"blockquote"},"\u8bed\u6cd5\uff1a"),(0,a.kt)("p",{parentName:"blockquote"},'auth_basic "\u63d0\u793a\u4fe1\u606f"'),(0,a.kt)("p",{parentName:"blockquote"},"auth_basic_user_file /etc/nginx/htpasswd;")),(0,a.kt)("p",null,(0,a.kt)("strong",{parentName:"p"},"\u914d\u7f6e\u5b9e\u73b0\uff1a"),"\n",(0,a.kt)("strong",{parentName:"p"},"\u2460 \u521b\u5efa\u7528\u6237\u540d\u548c\u5bc6\u7801\u5b58\u50a8\u6587\u4ef6")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-shell"},"shell > cd /usr/local/nginx/conf\n#htpasswd \u5982\u679c\u4e0d\u5b58\u5728\u5c31\u901a\u8fc7  yum -y install httpd-tools\u5b89\u88c5\n#\u751f\u6210\u7528\u6237\u540d\u79f0\u548c\u5bc6\u7801\nshell > htpasswd -c ./passwd.db lnmp\n#\u8f93\u5165\u5bc6\u7801\u5e76\u518d\u6b21\u786e\u8ba4\u5bc6\u7801\n#\u67e5\u770bpasswd.db\u6587\u4ef6\u662f\u5426\u521b\u5efa\u6210\u529f\n")),(0,a.kt)("p",null,(0,a.kt)("strong",{parentName:"p"},"\u2461 \u5728\u914d\u7f6e\u6587\u4ef6\u4e2d\u8fdb\u884c\u914d\u7f6e")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-shell"},"shell > vim /usr/local/nginx/conf/nginx.conf\n")),(0,a.kt)("p",null,"\u914d\u7f6e\u6587\u4ef6\u5185\u5bb9"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-nginx"},'#\u6839\u636e\u4e1a\u52a1\u9700\u6c42\uff0c\u914d\u7f6e\u5230server\u6bb5\u91cc\n#\u767b\u5f55\u6846\u663e\u793a\u7684\u6807\u9898\u63d0\u793a\nauth_basic "test login"\n#\u52a0\u8f7d\u7528\u6237\u540d\u79f0\u548c\u5bc6\u7801\u6821\u9a8c\u6587\u4ef6\nauth_basic_user_file  /usr/local/nginx/conf/passwd.db;\n')),(0,a.kt)("p",null,(0,a.kt)("strong",{parentName:"p"},"\u2462 \u6d4b\u8bd5\u67e5\u770b")),(0,a.kt)("h3",{id:"5\u76ee\u5f55\u5217\u8868\u663e\u793a"},"5\u3001\u76ee\u5f55\u5217\u8868\u663e\u793a"),(0,a.kt)("p",null,"\u663e\u793a\u6587\u4ef6\u5217\u8868\uff0c\u6216\u8005\u9700\u8981\u505a\u4e00\u4e2a\u4e0b\u8f7d\u5217\u8868"),(0,a.kt)("p",null,(0,a.kt)("img",{alt:"list",src:n(48223).Z})),(0,a.kt)("p",null,"\u5b98\u65b9\u6587\u6863\uff1a",(0,a.kt)("a",{parentName:"p",href:"http://nginx.org/en/docs/http/ngx_http_autoindex_module.html#autoindex"},"http://nginx.org/en/docs/http/ngx_http_autoindex_module.html#autoindex")),(0,a.kt)("p",null,(0,a.kt)("strong",{parentName:"p"},"\u793a\u4f8b\u8bed\u6cd5\uff1a")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-nginx"},"#\u5f00\u542f\u76ee\u5f55\u5217\u8868\u663e\u793a\nautoindex on;\n#index  \u5f53index\u9ed8\u8ba4\u627e\u4e0d\u5230\u65f6\uff0c\u624d\u4f1a\u4f7f\u7528\u76ee\u5f55\u5217\u8868\nindex index;\n")),(0,a.kt)("blockquote",null,(0,a.kt)("p",{parentName:"blockquote"},"\u6ce8\u610f\uff1a\u5982\u679c\u76ee\u5f55\u4e2d\u6ca1\u6709\u914d\u7f6e\u7684\u9ed8\u8ba4 index \u8bbf\u95ee\u9879\uff0c\u800c autoindex \u53c8\u6ca1\u6709\u5f00\u542f\uff0c\u4e0d\u80fd\u591f\u67e5\u770b\u8bbf\u95ee\u76ee\u5f55\u5217\u8868\uff0c\u5c31\u4f1a\u62a5\u51fa 403 \u9519\u8bef\u3002")),(0,a.kt)("h3",{id:"6\u53cd\u5411\u4ee3\u7406"},"6\u3001\u53cd\u5411\u4ee3\u7406"),(0,a.kt)("p",null,(0,a.kt)("strong",{parentName:"p"},"\u6b63\u5411\u4ee3\u7406")),(0,a.kt)("p",null,(0,a.kt)("img",{alt:"proxy",src:n(92738).Z})),(0,a.kt)("p",null,"\u7279\u70b9\uff1a\u77e5\u9053\u81ea\u5df1\u4f7f\u7528\u4e86\u4ee3\u7406\uff0c\u9700\u8981\u586b\u5199\u4ee3\u7406\u670d\u52a1\u5668\u7684 IP \u7b49\u76f8\u5173\u8fde\u63a5\u4fe1\u606f"),(0,a.kt)("p",null,"\u200b ",(0,a.kt)("strong",{parentName:"p"},"==\u5e38\u89c1\u4e8e\u4ee3\u7406\u5ba2\u6237\u7aef\u4e0a\u7f51\u7b49\u64cd\u4f5c\u3002==")),(0,a.kt)("p",null,(0,a.kt)("strong",{parentName:"p"},"\u53cd\u5411\u4ee3\u7406")),(0,a.kt)("p",null,(0,a.kt)("img",{alt:"proxyy",src:n(45166).Z})),(0,a.kt)("p",null,"\u7279\u70b9\uff1a\u7528\u6237\u662f\u65e0\u611f\u77e5\u7684\uff0c\u4e0d\u77e5\u9053\u4f7f\u7528\u4e86\u4ee3\u7406\u670d\u52a1\u5668\u3002\u53cd\u5411\u4ee3\u7406\u670d\u52a1\u5668\u662f\u548c\u771f\u5b9e\u8bbf\u95ee\u7684\u670d\u52a1\u5668\u662f\u5728\u4e00\u8d77\u7684\uff0c\u6709\u5173\u8054\u7684\u3002"),(0,a.kt)("p",null,"\u4f5c\u7528\uff1a\u53ef\u4ee5\u6839\u636e\u5b9e\u9645\u4e1a\u52a1\u9700\u6c42\uff0c\u5206\u53d1\u4ee3\u7406\u9875\u9762\u5230\u4e0d\u540c\u7684\u89e3\u91ca\u5668"),(0,a.kt)("p",null,"\u200b \u53ef\u4ee5\u9690\u85cf\u771f\u5b9e\u670d\u52a1\u5668\u7684\u8def\u5f84"),(0,a.kt)("p",null,(0,a.kt)("strong",{parentName:"p"},"==\u5e38\u89c1\u4e8e\u4ee3\u7406\u540e\u7aef\u670d\u52a1\u5668==")),(0,a.kt)("p",null,"\u5b98\u65b9\u6587\u6863\uff1a",(0,a.kt)("a",{parentName:"p",href:"http://nginx.org/en/docs/http/ngx_http_proxy_module.html"},"http://nginx.org/en/docs/http/ngx_http_proxy_module.html")),(0,a.kt)("p",null,(0,a.kt)("strong",{parentName:"p"},"\u2460 \u914d\u7f6e\u53cd\u5411\u4ee3\u7406")),(0,a.kt)("p",null,"==",(0,a.kt)("strong",{parentName:"p"},"\u9a8c\u8bc1\u4f8b\u5b50\uff1a"),"=="),(0,a.kt)("p",null,(0,a.kt)("strong",{parentName:"p"},"\u2460 \u5b89\u88c5 httpd \u9700\u6539\u7aef\u53e3 8080")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-shell"},"#\u5b89\u88c5apache\nshell > yum install -y httpd\n#\u914d\u7f6eapache\u7684\u914d\u7f6e\u6587\u4ef6\nshell > vim /etc/httpd/conf/httpd.conf\n")),(0,a.kt)("p",null,"\u4fee\u6539\u914d\u7f6e\u9879"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-apache"},"listen 8080\n")),(0,a.kt)("p",null,(0,a.kt)("strong",{parentName:"p"},"\u2461 \u914d\u7f6e nginx \u7684 server \u5e76\u8fdb\u884c\u8f6c\u53d1")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-nginx"},"location / {\n    proxy_pass http\uff1a//127.0.0.1:8080;\n}\n")),(0,a.kt)("hr",null),(0,a.kt)("h2",{id:"\u65e5\u5fd7\u7ba1\u7406"},"\u65e5\u5fd7\u7ba1\u7406"),(0,a.kt)("blockquote",null,(0,a.kt)("p",{parentName:"blockquote"},"\u65e5\u5fd7\u7c7b\u578b\uff1a"),(0,a.kt)("p",{parentName:"blockquote"},"\u2460access.log \u8bbf\u95ee\u65e5\u5fd7 \u67e5\u770b\u7edf\u8ba1\u7528\u6237\u7684\u8bbf\u95ee\u4fe1\u606f \u6d41\u91cf"),(0,a.kt)("p",{parentName:"blockquote"},"\u2461error.log \u9519\u8bef\u65e5\u5fd7 \u9519\u8bef\u4fe1\u606f \u91cd\u5199\u4fe1\u606f")),(0,a.kt)("h3",{id:"1\u8bbf\u95ee\u65e5\u5fd7"},"1\u3001\u8bbf\u95ee\u65e5\u5fd7"),(0,a.kt)("p",null,"\u5b98\u65b9\u6587\u6863\uff1a",(0,a.kt)("a",{parentName:"p",href:"http://nginx.org/en/docs/http/ngx_http_log_module.html"},"http://nginx.org/en/docs/http/ngx_http_log_module.html")),(0,a.kt)("p",null,(0,a.kt)("strong",{parentName:"p"},"\u2460 \u67e5\u770b access.log")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-shell"},"shell > cd /usr/local/nginx/logs\nshell > cat access.log\n")),(0,a.kt)("p",null,"access.log \u65e5\u5fd7\u6587\u4ef6\u5185\u5bb9\u793a\u4f8b"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-nginx"},'127.0.0.1 - - [06/Oct/2017:11:46:16 +0800] "GET /phpinfo.php HTTP/1.1" 200 25206 "-" "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/62.0.3202.9 Safari/537.36"\n')),(0,a.kt)("p",null,(0,a.kt)("strong",{parentName:"p"},"\u2461 \u67e5\u770b\u914d\u7f6e\u89e3\u6790\u53c2\u6570\u8bf4\u660e")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-shell"},"shell > vim nginx.conf\n")),(0,a.kt)("p",null,"\u67e5\u770b\u8bbf\u95ee\u65e5\u5fd7\u76f8\u5173\u53c2\u6570"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-nginx"},'#\u5b9a\u4e49\u65e5\u5fd7\u683c\u5f0f  \u683c\u5f0f\u547d\u540d    \u8be6\u7ec6\u683c\u5f0f\u53c2\u6570\n#log_format  main  \'$remote_addr - $remote_user [$time_local] "$request" \'\n    #                  \'$status $body_bytes_sent "$http_referer" \'\n    #                  \'"$http_user_agent" "$http_x_forwarded_for"\';\n#\u8bbf\u95ee\u65e5\u5fd7\u7684\u5b58\u50a8\u8def\u5f84\u914d\u7f6e               \u8c03\u7528\u7684\u65e5\u5fd7\u683c\u5f0f\n    #access_log  logs/access.log  main;\n')),(0,a.kt)("table",null,(0,a.kt)("thead",{parentName:"table"},(0,a.kt)("tr",{parentName:"thead"},(0,a.kt)("th",{parentName:"tr",align:null},"\u53c2\u6570"),(0,a.kt)("th",{parentName:"tr",align:null},"\u610f\u4e49"))),(0,a.kt)("tbody",{parentName:"table"},(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},(0,a.kt)("strong",{parentName:"td"},"$remote_addr")),(0,a.kt)("td",{parentName:"tr",align:null},"\u5ba2\u6237\u7aef\u7684 ip \u5730\u5740(\u4ee3\u7406\u670d\u52a1\u5668\uff0c\u663e\u793a\u4ee3\u7406\u670d\u52a1 ip)")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"$remote_user"),(0,a.kt)("td",{parentName:"tr",align:null},"\u7528\u4e8e\u8bb0\u5f55\u8fdc\u7a0b\u5ba2\u6237\u7aef\u7684\u7528\u6237\u540d\u79f0\uff08\u4e00\u822c\u4e3a\u201c-\u201d\uff09")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"$time_local"),(0,a.kt)("td",{parentName:"tr",align:null},"\u7528\u4e8e\u8bb0\u5f55\u8bbf\u95ee\u65f6\u95f4\u548c\u65f6\u533a")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},(0,a.kt)("strong",{parentName:"td"},"$request")),(0,a.kt)("td",{parentName:"tr",align:null},"\u7528\u4e8e\u8bb0\u5f55\u8bf7\u6c42\u7684 url \u4ee5\u53ca\u8bf7\u6c42\u65b9\u6cd5")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"$status"),(0,a.kt)("td",{parentName:"tr",align:null},"\u54cd\u5e94\u72b6\u6001\u7801\uff0c\u4f8b\u5982\uff1a200 \u6210\u529f\u3001404 \u9875\u9762\u627e\u4e0d\u5230\u7b49\u3002")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"$body_bytes_sent"),(0,a.kt)("td",{parentName:"tr",align:null},"\u7ed9\u5ba2\u6237\u7aef\u53d1\u9001\u7684\u6587\u4ef6\u4e3b\u4f53\u5185\u5bb9\u5b57\u8282\u6570")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},(0,a.kt)("strong",{parentName:"td"},"$http_user_agent")),(0,a.kt)("td",{parentName:"tr",align:null},"\u7528\u6237\u6240\u4f7f\u7528\u7684\u4ee3\u7406\uff08\u4e00\u822c\u4e3a\u6d4f\u89c8\u5668\uff09")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"$http_x_forwarded_for"),(0,a.kt)("td",{parentName:"tr",align:null},"\u53ef\u4ee5\u8bb0\u5f55\u5ba2\u6237\u7aef IP\uff0c\u901a\u8fc7\u4ee3\u7406\u670d\u52a1\u5668\u6765\u8bb0\u5f55\u5ba2\u6237\u7aef\u7684 ip \u5730\u5740")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"$http_referer"),(0,a.kt)("td",{parentName:"tr",align:null},"\u53ef\u4ee5\u8bb0\u5f55\u7528\u6237\u662f\u4ece\u54ea\u4e2a\u94fe\u63a5\u8bbf\u95ee\u8fc7\u6765\u7684")))),(0,a.kt)("p",null,"\u8bbf\u95ee\u65e5\u5fd7\uff0c\u53ef\u4ee5\u7edf\u8ba1\u5206\u6790\u7528\u6237\u7684\u6d41\u91cf\u7684\u76f8\u5173\u60c5\u51b5\u3002\u5ba2\u60c5\u5206\u6790"),(0,a.kt)("h3",{id:"2\u9519\u8bef\u65e5\u5fd7"},"2\u3001\u9519\u8bef\u65e5\u5fd7"),(0,a.kt)("p",null,"\u8bb0\u5f55\u4e00\u4e9b\u542f\u52a8\u548c\u8fd0\u884c\u8fc7\u7a0b\u4e2d\u7684\u9519\u8bef\u4fe1\u606f"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-nginx"},"# \u5b9a\u4e49\u5f00\u542f\u9519\u8bef\u65e5\u5fd7    \u65e5\u5fd7\u4f4d\u7f6e    \u65e5\u5fd7\u7ea7\u522b\n#error_log  logs/error.log;\n#error_log  logs/error.log  notice;\n#error_log  logs/error.log  info;\n")),(0,a.kt)("p",null,"\u5b98\u65b9\u6587\u6863\uff1a",(0,a.kt)("a",{parentName:"p",href:"http://nginx.org/en/docs/ngx_core_module.html#error_log"},"http://nginx.org/en/docs/ngx_core_module.html#error_log")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-shell"},"shell > cat /usr/local/nginx/logs/error.log\n")),(0,a.kt)("p",null,"\u683c\u5f0f\u793a\u4f8b\uff1a"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-nginx"},'2019/06/06 11:42:43 [error] 25356#0: *38 open() "/usr/local/nginx/html/favicon.ico" failed (2: No such file or directory), client: 192.168.17.1, server: localhost, request: "GET /favicon.ico HTTP/1.1", host: "192.168.17.220", referrer: "http://192.168.17.220/index.php"\n')),(0,a.kt)("h3",{id:"3\u57fa\u4e8e\u57df\u540d\u65e5\u5fd7\u5206\u5272"},"3\u3001\u57fa\u4e8e\u57df\u540d\u65e5\u5fd7\u5206\u5272"),(0,a.kt)("p",null,(0,a.kt)("strong",{parentName:"p"},"\u2460 \u5f00\u542f\u65e5\u5fd7\u7684\u5b9a\u4e49\u89c4\u5219")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-nginx"},'#\u5b9a\u4e49\u65e5\u5fd7\u683c\u5f0f  \u5b9a\u4e49http\u91cc\nlog_format  mylogs  \'$remote_addr - $remote_user [$time_local] "$request" \'\n                      \'$status $body_bytes_sent "$http_referer" \'\n                      \'"$http_user_agent" "$http_x_forwarded_for"\';\n')),(0,a.kt)("p",null,(0,a.kt)("strong",{parentName:"p"},"\u2461 \u91cd\u542f nginx \u6d4b\u8bd5\u67e5\u770b")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-nginx"},"#\u8bbf\u95ee\u65e5\u5fd7\u7684\u5b58\u50a8\u8def\u5f84\u914d\u7f6e        \u8c03\u7528\u7684\u65e5\u5fd7\u683c\u5f0f\n#\u5728server\u6bb5\u91cc\u9762\u914d\u7f6e  \u4e5f\u5c31\u662f\u5728\u5f53\u524dserver\u91cc\u7684\u8bbf\u95ee\u65e5\u5fd7\uff0c\u4f1a\u88ab\u5199\u5165\u5b9a\u4e49\u7684\u8fd9\u91cc\naccess_log  logs/shop.lnmp.com_access.log  mylogs;\n")),(0,a.kt)("p",null,"\u65e5\u5fd7\u5207\u5272\u7684\u65b9\u5f0f\u6709\u5f88\u591a\u79cd\uff1a"),(0,a.kt)("p",null,"\u2460 \u57fa\u4e8e\u57df\u540d\u5206\u5f00\u5b58\u50a8"),(0,a.kt)("p",null,"\u2461 \u65e5\u5fd7\u8f6e\u8f6c \u65f6\u95f4\u6bb5"),(0,a.kt)("p",null,"\u2462 \u81ea\u5b9a\u4e49\u811a\u672c \u5b9a\u65f6\u68c0\u6d4b\u5927\u5c0f \u6839\u636e\u6587\u4ef6\u5927\u5c0f\u8fdb\u884c\u5207\u5272"))}c.isMDXComponent=!0},48223:function(t,e,n){e.Z=n.p+"assets/images/1-7665d0674931c0514cb7bb0dfca5ea85.jpg"},92738:function(t,e,n){e.Z=n.p+"assets/images/3-8ada828a6ca84e24ed1b06f8aad7932c.jpg"},45166:function(t,e,n){e.Z=n.p+"assets/images/4-5eb6dfa14146786088772b2c6c028f96.jpg"}}]);