<!doctype html>
<html class="docs-version-current" lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.14">
<link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="Aoki 的自留地 RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="Aoki 的自留地 Atom Feed">
<link rel="search" type="application/opensearchdescription+xml" title="Aoki 的自留地" href="/opensearch.xml"><title data-react-helmet="true">[Http] 大话Http(中) | Aoki 的自留地</title><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" property="og:url" content="https://phero.live/docs/Http/tcpip2"><meta data-react-helmet="true" name="docsearch:language" content="en"><meta data-react-helmet="true" name="docsearch:version" content="current"><meta data-react-helmet="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-react-helmet="true" property="og:title" content="[Http] 大话Http(中) | Aoki 的自留地"><meta data-react-helmet="true" name="description" content="常见编码规范"><meta data-react-helmet="true" property="og:description" content="常见编码规范"><link data-react-helmet="true" rel="icon" href="/img/favicon.ico"><link data-react-helmet="true" rel="canonical" href="https://phero.live/docs/Http/tcpip2"><link data-react-helmet="true" rel="alternate" href="https://phero.live/docs/Http/tcpip2" hreflang="en"><link data-react-helmet="true" rel="alternate" href="https://phero.live/docs/Http/tcpip2" hreflang="x-default"><link data-react-helmet="true" rel="preconnect" href="https://BMRZNSN9O0-dsn.algolia.net" crossorigin="anonymous"><link rel="stylesheet" href="/assets/css/styles.88609adb.css">
<link rel="preload" href="/assets/js/runtime~main.f765f360.js" as="script">
<link rel="preload" href="/assets/js/main.f2870086.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div><a href="#" class="skipToContent_OuoZ">Skip to main content</a></div><nav class="navbar navbar--fixed-top navbar--dark"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/logo.svg" alt="My Site Logo" class="themedImage_TMUO themedImage--light_4Vu1"><img src="/img/logo.svg" alt="My Site Logo" class="themedImage_TMUO themedImage--dark_uzRr"></div><b class="navbar__title">Aoki</b></a><a class="navbar__item navbar__link navbar__link--active" href="/docs/intro">笔记</a><a class="navbar__item navbar__link" href="/blog">Blog</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/aokikoko" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link"><span>GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_wgqa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a><div class="toggle_iYfV toggle_2i4l toggleDisabled_xj38"><div class="toggleTrack_t-f2" role="button" tabindex="-1"><div class="toggleTrackCheck_mk7D"><span class="toggleIcon_pHJ9">🌜</span></div><div class="toggleTrackX_dm8H"><span class="toggleIcon_pHJ9">🌞</span></div><div class="toggleTrackThumb_W6To"></div></div><input type="checkbox" class="toggleScreenReader_h9qa" aria-label="Switch between dark and light mode"></div><div class="searchBox_Utm0"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper docs-wrapper docs-doc-page"><div class="docPage_lDyR"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_i9tI" type="button"></button><aside class="docSidebarContainer_0YBq"><div class="sidebar_a3j0"><nav class="menu thin-scrollbar menu_cyFh"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/intro">我的知识库 😀</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_TwRn" href="/docs/CSS/transition-animation-transform">CSS</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_TwRn" href="/docs/DocusaurusTips/code-theme">Docusaurus使用技巧</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_TwRn" href="/docs/TypeScript/basic-types">TypeScript</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_TwRn" href="/docs/Another/bigo">算法小题目</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_TwRn" href="/docs/architecture/history">架构</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_TwRn" href="/docs/Cli/ESLint">Cli</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_TwRn" href="/docs/DevOps/prometheus">DevOps</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active hasHref_TwRn" href="/docs/Http/OptionsRequest">Http</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/Http/OptionsRequest">[Http] Options请求的解释</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/Http/tcpip1">[Http] 大话Http(上)</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/docs/Http/tcpip2">[Http] 大话Http(中)</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/Http/tcpip3">[Http] 大话Http(下)</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_TwRn" href="/docs/Linux/basic">Linux</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_TwRn" href="/docs/Mysql/case">Mysql</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_TwRn" href="/docs/Nginx/sign">Nginx</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_TwRn" href="/docs/Node.js/buffer">Node.js</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_TwRn" href="/docs/React/jsx">React</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_TwRn" href="/docs/interview/http">interview</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_TwRn" href="/docs/javascript/ecma">javascript</a></div></li></ul></nav><button type="button" title="Collapse sidebar" aria-label="Collapse sidebar" class="button button--secondary button--outline collapseSidebarButton_eoK2"><svg width="20" height="20" aria-hidden="true" class="collapseSidebarButtonIcon_e+kA"><g fill="#7a7a7a"><path d="M9.992 10.023c0 .2-.062.399-.172.547l-4.996 7.492a.982.982 0 01-.828.454H1c-.55 0-1-.453-1-1 0-.2.059-.403.168-.551l4.629-6.942L.168 3.078A.939.939 0 010 2.528c0-.548.45-.997 1-.997h2.996c.352 0 .649.18.828.45L9.82 9.472c.11.148.172.347.172.55zm0 0"></path><path d="M19.98 10.023c0 .2-.058.399-.168.547l-4.996 7.492a.987.987 0 01-.828.454h-3c-.547 0-.996-.453-.996-1 0-.2.059-.403.168-.551l4.625-6.942-4.625-6.945a.939.939 0 01-.168-.55 1 1 0 01.996-.997h3c.348 0 .649.18.828.45l4.996 7.492c.11.148.168.347.168.55zm0 0"></path></g></svg></button></div></aside><main class="docMainContainer_r8cw"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_zHA2"><div class="docItemContainer_oiyr"><article><div class="tocCollapsible_aw-L theme-doc-toc-mobile tocMobile_Tx6Y"><button type="button" class="clean-btn tocCollapsibleButton_zr6a">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>[Http] 大话Http(中)</h1></header><h2 class="anchor anchorWithStickyNavbar_y2LR" id="常见编码规范">常见编码规范<a class="hash-link" href="#常见编码规范" title="Direct link to heading">​</a></h2><ul><li><p>ASCII</p><ul><li>可表示阿拉伯数字和英文字母及一些简单符号, 只需要 1 个字节存储, 使用地址对应的二进制数表示</li></ul></li><li><p>GBK</p><ul><li>汉字扩展规范, 支持全部中日韩汉字, GBK 字符集所有的字符都占 2 个字节, 无论中文还是英文都占两个字节, 没有特殊编码方式</li></ul></li><li><p>ISO-8859-1</p><ul><li>它收录的字符是除了 ASCII 码收录的字符外, 还包括西欧, 泰, 阿拉伯, 希伯来等等对应的文字符号, 因为这种编码范围使用了单字节内的所有空间, 所以在支持它的系统中传输和存储其他的任何编码的字节流都不被抛弃, 换言之把其他任何编码当做 ISO-8859-1 进行解码时都能解开, Mysql 数据库默认编码叫做 Lating1, 那个默认编码就是利用了 ISO-8859-1 的特性. 它只占 1 个字节. 但是该编码不支持中文. 有时屏幕上的乱码就是因为利用它来进行解码的</li></ul></li><li><p>Unicode</p><ul><li>由上面可见各编码不兼容, 所以国际标准化组织决定制定一套通用规范, 也就是 Unicode. 要区分每个字符, 每个字符都需要 4 个字节, 这是十分浪费存储空间的, 于是程序员设计出来几种编码方式, 比如 UTF-8 , UTF-16 , UTF-32 等. Utf-8 是一种变长字符编码, 注意 UTF-8 不是编码规范, 而是一种方式, UTF-8 的优势在于, 对于只需要 1 个字节的字符, utf-8 采用 ascii 编码方式, 最多可以用 4 个字节, 32 位二进制数字来表示, 通常用的英文都是 1 个字节, 而中文都是 3 个字节, 所以在中文 utf-8 没有 gbk 编码占的空间小, 但是它胜在面向全世界</li></ul></li></ul><h3 class="anchor anchorWithStickyNavbar_y2LR" id="乱码的由来">乱码的由来<a class="hash-link" href="#乱码的由来" title="Direct link to heading">​</a></h3><ul><li><p>解码过程:</p><ul><li>一串二进制数字, 使用一种编码方式转换成字符, 这个过程称之为解码. 程序员可以使用任意方式来解码, 但往往只有某种方式可以正确解码</li></ul></li><li><p>编码过程:</p><ul><li>解码的相反过程, 编码也可能产生乱码, 一串已经解码后的字符可以选择任意类型编码方式重新转换成一串二进制数, 也可以称之为加密过程. 无论哪一种方式都是产生计算机可识别的二进制数, 但是如果编码规范的字符表里不包含目标字符,就无法在字符集中找到对应的二进制数, 就导致乱码. 比如 ISO-8859-1 它的字符表里不包含中文, 所以哪怕使用 ISO-8859-1 将中文字符进行编码, 再使用 ISO-8859-1 进行解码, 也无法显示出正确字符</li></ul></li><li><p>所以乱码就是使用的编码和解码方式不一致, 或者编码的时候它的字符表里不包含相应字符导致的.</p></li></ul><h3 class="anchor anchorWithStickyNavbar_y2LR" id="url-的编码与解码">URL 的编码与解码<a class="hash-link" href="#url-的编码与解码" title="Direct link to heading">​</a></h3><ul><li><p>URL 是使用 ASCII 字符集进行编码的, 所以如果 URL 中含有非 ASCII 字符集中的字符, 要对它进行编码.</p></li><li><p>还有 URL 中好多字符是保留字, 如&quot;&amp;&quot;表示参数分隔符, 如果想要在 URL 中使用这些保留字, 那就需要编码.</p></li><li><p>对 URL 中属于 ASCII 字符集的非保留字不做编码; 对 URL 中的保留字需要取其 ASCII 内码, 然后加上&quot;%&quot; 前缀将该字符进行编码; 对于 URL 中的非 ASCII 字符需要取其 Unicode 内码, 然后加上&quot;%&quot;前缀将该字符进行编码.</p></li></ul><h2 class="anchor anchorWithStickyNavbar_y2LR" id="身份认证">身份认证<a class="hash-link" href="#身份认证" title="Direct link to heading">​</a></h2><h3 class="anchor anchorWithStickyNavbar_y2LR" id="身份认证信息">身份认证信息<a class="hash-link" href="#身份认证信息" title="Direct link to heading">​</a></h3><ul><li>密码</li><li>动态令牌</li><li>数字证书</li><li>生物认证</li><li>IC 卡等</li></ul><h3 class="anchor anchorWithStickyNavbar_y2LR" id="常见认证方式">常见认证方式<a class="hash-link" href="#常见认证方式" title="Direct link to heading">​</a></h3><ul><li>BASIC 认证(基本认证)</li><li>DIGEST(摘要认证)</li><li>SSL 客户端认证</li><li>FormBase 认证(基于表单认证)</li></ul><h3 class="anchor anchorWithStickyNavbar_y2LR" id="basic-认证基本认证">BASIC 认证(基本认证)<a class="hash-link" href="#basic-认证基本认证" title="Direct link to heading">​</a></h3><p><img alt="basic" src="/assets/images/basic-fba9f9371f3a087136ab1c4c3a366979.JPG"></p><h3 class="anchor anchorWithStickyNavbar_y2LR" id="digest摘要认证">DIGEST(摘要认证)<a class="hash-link" href="#digest摘要认证" title="Direct link to heading">​</a></h3><p>为弥补 BASIC 认证存在的弱点, 从 HTTP/1.1 起就有了 DIGEST 认证</p><p>DIGEST 认证同样使用质询/响应的方式, 但不会像 BASIC 认证那样直接发送明文密码</p><p><img alt="DIGEST" src="/assets/images/DIGEST-ebde8205daa17672337e10732069dbbe.JPG"></p><h3 class="anchor anchorWithStickyNavbar_y2LR" id="ssl-客户端认证">SSL 客户端认证<a class="hash-link" href="#ssl-客户端认证" title="Direct link to heading">​</a></h3><p>SSL 客户端认证是借由 HTTPS 的客户端证书完成认证的方式. 凭借客户端证书认证, 服务器可确认访问是否来自己登录的客户端.</p><h3 class="anchor anchorWithStickyNavbar_y2LR" id="formbase-认证基于表单认证">FormBase 认证(基于表单认证)<a class="hash-link" href="#formbase-认证基于表单认证" title="Direct link to heading">​</a></h3><p>基于表单的认证方法并不是在 HTTP 协议中定义的.</p><p>使用由 Web 应用程序各自实现基于表单的认证方式. 通过 cookie 和 session 的方式来保持用户的状态</p><h2 class="anchor anchorWithStickyNavbar_y2LR" id="http-的长链接与短连接">HTTP 的长链接与短连接<a class="hash-link" href="#http-的长链接与短连接" title="Direct link to heading">​</a></h2><p>HTTP 协议是基于请求/响应模式的, 因此只要服务端给了响应, 本次 HTTP 请求就结束了</p><p>HTTP 协议是属于应用层协议在传输层使用的是 TCP 协议, 在网络层使用的是 IP 协议. Ip 协议解决了路由和寻址, tcp 协议解决的是如何在 ip 层之上可靠的传递数据包. 使在网络另一端收到发出的包顺序一致, 之所以说 HTTPC 长链接和短连接本质上是 TCP 长连接和短连接</p><p>TCP 连接是一个双向通道, 可以保持一段时间不关闭. 因此 TCP 连接才有长链接和短连接这么一说, 形象的例子, http 协议指快递单, 填的单子像发了一个 http 请求, 货物运到地方, 快递员根据单子发给收货人, tcp 协议就是中间运货的大货车, 它是负责运输的, 公路相当于 tcp 连接, 一个双向的通道.</p><h3 class="anchor anchorWithStickyNavbar_y2LR" id="短连接">短连接<a class="hash-link" href="#短连接" title="Direct link to heading">​</a></h3><p>HTTP/1.0 中, 默认使用的是短连接, 也就是说, 浏览器和服务器每进行一次 HTTP 操作, 就建立一次连接, 结束就中断. 如果客户端浏览器访问某个 html 或其他类型 web 页, 包含有其他 web 资源, 比如有 js 文件, 图像, css, 浏览器每遇到一个资源, 就建立一个会话</p><p>HTTP/1.1 起, 默认使用长连接, 用以保持连接特性. 比如 F12 中 Response Headers 的 Connection: keep-alive. 需要客户端和服务端都支持</p><h2 class="anchor anchorWithStickyNavbar_y2LR" id="http-中介之代理">HTTP 中介之代理<a class="hash-link" href="#http-中介之代理" title="Direct link to heading">​</a></h2><p><img alt="proxy" src="/assets/images/proxy-56d7b891a5533d3a789bdb8076af61de.JPG"></p><h3 class="anchor anchorWithStickyNavbar_y2LR" id="典型的代理服务器">典型的代理服务器<a class="hash-link" href="#典型的代理服务器" title="Direct link to heading">​</a></h3><p><img alt="fiddler" src="/assets/images/fiddler-c83f486ccab8da23933bda17c036e2fd.JPG"></p><p>它使用代理地址比如 127.0.0.1:8888, 当 fiddler 退出的时候, 自动注销代理. 打开的时候自动启用代理, 不会影响别的程序.</p><h2 class="anchor anchorWithStickyNavbar_y2LR" id="http-中介之网关">HTTP 中介之网关<a class="hash-link" href="#http-中介之网关" title="Direct link to heading">​</a></h2><p>网关可以作为某种翻译器使用, 它抽象出了一种能够到达资源的方法. 网关是资源和应用程序之间的粘合剂.</p><p>网关扮演的是&quot;协议转换器&quot;的角色</p><p><img alt="wangguan" src="/assets/images/wangguan-6888b55dd2978f4dc47887717c51735c.JPG"></p><p>代理连接的是两个或多个使用相同协议的应用程序, 而网关连接的 是不同协议的端点, 所以网关扮演的是协议转换器的角色. 网关可以向数据库发送查询数据, 邮件, 或者生成动态内容, 比如像一个门, 进去一个请求, 出来一个响应.</p><h3 class="anchor anchorWithStickyNavbar_y2LR" id="网关的两种分类">网关的两种分类<a class="hash-link" href="#网关的两种分类" title="Direct link to heading">​</a></h3><p>Web 网关在一侧使用 HTTP 协议, 在另一侧使用另一种协议. <code>&lt;客户端协议&gt;/&lt;服务器端协议&gt;</code></p><ul><li><p>(HTTP/) 服务器端网关: 通过 HTTP 协议与 客户端对话, 通过其他协议与服务器通信.</p></li><li><p>(/HTTP) 客户端网关: 通过其他协议与客户端对话, 通过 HTTP 协议与服务器通信</p></li></ul><h2 class="anchor anchorWithStickyNavbar_y2LR" id="http-缓存">HTTP 缓存<a class="hash-link" href="#http-缓存" title="Direct link to heading">​</a></h2><h3 class="anchor anchorWithStickyNavbar_y2LR" id="缓存头部字段">缓存头部字段<a class="hash-link" href="#缓存头部字段" title="Direct link to heading">​</a></h3><h4 class="anchor anchorWithStickyNavbar_y2LR" id="cache-control">Cache-Control<a class="hash-link" href="#cache-control" title="Direct link to heading">​</a></h4><p>请求/响应头, 缓存控制字段</p><ul><li>no-store: 所有内容都不缓存</li><li>no-cache: 缓存, 但是浏览器使用缓存前, 都会请求服务器判断缓存资源是否是最新</li><li>max-age=x(单位秒): 请求缓存后的 X 秒不再发起请求</li><li>s-maxage=x(单位秒): 代理服务器请求源站缓存后的 X 秒不再发起请求, 只对 CDN 缓存有效</li><li>public 客户端和代理服务器 CDN 都可缓存</li><li>private 只有客户端可以缓存</li></ul><h4 class="anchor anchorWithStickyNavbar_y2LR" id="expires">Expires<a class="hash-link" href="#expires" title="Direct link to heading">​</a></h4><p>响应头, 代表资源过期时间, 由服务器返回提供, 是 http1.0 的属性, 在与 max-age 共存的情况下, 比 max-age 优先级要低.</p><h4 class="anchor anchorWithStickyNavbar_y2LR" id="last-modified">Last-Modified<a class="hash-link" href="#last-modified" title="Direct link to heading">​</a></h4><p>响应头, 刷新资源最新修改时间, 由服务器告诉浏览器</p><h4 class="anchor anchorWithStickyNavbar_y2LR" id="if-modified-since">if-Modified-Since<a class="hash-link" href="#if-modified-since" title="Direct link to heading">​</a></h4><p>请求头, 资源最新修改时间, 由浏览器告诉服务器, 和 Last-modified 是一对, 它俩进行对比</p><h4 class="anchor anchorWithStickyNavbar_y2LR" id="etag">Etag<a class="hash-link" href="#etag" title="Direct link to heading">​</a></h4><p>响应头, 资源标识, 由服务器告诉浏览器</p><h4 class="anchor anchorWithStickyNavbar_y2LR" id="if-none-match">if-None-Match<a class="hash-link" href="#if-none-match" title="Direct link to heading">​</a></h4><p>请求头, 缓存资源标识, 由浏览器告诉服务器(其实就是上次服务器给的 Etag), 和 Etag 是一对, 它俩进行对比</p><p>场景一:</p><p>让服务器与浏览器约定一个文件过期时间-Expires</p><p>场景二:</p><p>让服务器与浏览器在约定文件过期时间的基础上, 再加一个文件最新修改时间的对比 -- Last-Modified 与 if-Modified-Since</p><p><img alt="lastmodified" src="/assets/images/lastmodified-185ddd2ff180502bf44dd70668d84780.JPG"></p><p>场景三:</p><p>让服务器与浏览器在过期时间 Expires + Last-Modified 的基础上, 增加一个文件内容唯一对比标记 - Etag 与 If-None-Match. Expires 不稳定, 再加入一个 max-age 来代替</p><p><img alt="etag" src="/assets/images/etag-3512b0d6bede02569e6d59815dfef29e.JPG"></p><h3 class="anchor anchorWithStickyNavbar_y2LR" id="缓存改进方案">缓存改进方案<a class="hash-link" href="#缓存改进方案" title="Direct link to heading">​</a></h3><h4 class="anchor anchorWithStickyNavbar_y2LR" id="md5hash-缓存">md5/hash 缓存<a class="hash-link" href="#md5hash-缓存" title="Direct link to heading">​</a></h4><p>通过不缓存 html, 为静态文件添加 md5 或者 hash 标识, 解决浏览器无法跳过缓存过期时间主动感知文件变化的问题</p><h4 class="anchor anchorWithStickyNavbar_y2LR" id="cdn-缓存">cdn 缓存<a class="hash-link" href="#cdn-缓存" title="Direct link to heading">​</a></h4><h3 class="anchor anchorWithStickyNavbar_y2LR" id="浏览器操作对-http-缓存的影响">浏览器操作对 HTTP 缓存的影响<a class="hash-link" href="#浏览器操作对-http-缓存的影响" title="Direct link to heading">​</a></h3><p><img alt="yingxiang" src="/assets/images/yingxiang-d182e0e13ecca3f54cbc1098ab0215d3.JPG"></p><h2 class="anchor anchorWithStickyNavbar_y2LR" id="内容协商机制">内容协商机制<a class="hash-link" href="#内容协商机制" title="Direct link to heading">​</a></h2><p>指客户端和服务器端就响应的资源内容进行交涉, 然后提供给客户端最为合适的资源. 内容协商会以响应资源的语言, 字符集, 编码方式等作为判断的基准.</p><h3 class="anchor anchorWithStickyNavbar_y2LR" id="内容协商方式">内容协商方式<a class="hash-link" href="#内容协商方式" title="Direct link to heading">​</a></h3><ul><li><p>客户端驱动</p><ul><li>客户端发起请求, 服务器发送可选项列表, 客户端做出选择后再发送第二次请求</li></ul></li><li><p>服务端驱动</p><ul><li>服务器检查客户端的请求头部集并决定提供哪个版本的页面</li></ul></li><li><p>透明协商</p><ul><li>某个中间设备(通常是缓存代理)代表客户端进行协商</li></ul></li></ul><h3 class="anchor anchorWithStickyNavbar_y2LR" id="服务器驱动内容协商---请求首部集">服务器驱动内容协商 - 请求首部集<a class="hash-link" href="#服务器驱动内容协商---请求首部集" title="Direct link to heading">​</a></h3><h4 class="anchor anchorWithStickyNavbar_y2LR" id="accept">Accept<a class="hash-link" href="#accept" title="Direct link to heading">​</a></h4><p>告知服务器发送何种媒体类型</p><h4 class="anchor anchorWithStickyNavbar_y2LR" id="accept-language">Accept-Language<a class="hash-link" href="#accept-language" title="Direct link to heading">​</a></h4><p>告知服务器发送何种语言</p><p>例子:</p><p>Accept-Language: en; q=0.5, fr; q=0.0, nl:q=1.0, tr;q=0.0</p><h4 class="anchor anchorWithStickyNavbar_y2LR" id="accept-charset">Accept-Charset<a class="hash-link" href="#accept-charset" title="Direct link to heading">​</a></h4><p>告知服务器发送何种字符集</p><h4 class="anchor anchorWithStickyNavbar_y2LR" id="accept-encoding">Accept-Encoding<a class="hash-link" href="#accept-encoding" title="Direct link to heading">​</a></h4><p>告知服务器采用何种编码</p><h2 class="anchor anchorWithStickyNavbar_y2LR" id="断点续传和多线程下载">断点续传和多线程下载<a class="hash-link" href="#断点续传和多线程下载" title="Direct link to heading">​</a></h2><ul><li>断点续传? 多线程下载?</li></ul><p>HTTP 是通过在 Header 里两个参数实现的, 客户端发请求时对应的是 Range, 服务器端响应时对应的是 Content-Range.</p><h3 class="anchor anchorWithStickyNavbar_y2LR" id="range">Range<a class="hash-link" href="#range" title="Direct link to heading">​</a></h3><p>用于请求头中, 指定第一个字节的位置和最后一个字节的位置, 一般格式:</p><p>Range: (unit=first byte pos)-<!-- -->[last byte pos]</p><h3 class="anchor anchorWithStickyNavbar_y2LR" id="断点续传过程">断点续传过程<a class="hash-link" href="#断点续传过程" title="Direct link to heading">​</a></h3><ol><li><p>客户端下载一个 1024k 的文件, 已经下载了其中 512k</p></li><li><p>网络中断, 客户端请求续传, 因此需要在 HTTP 头中申明本次需要续传的片段: Range:bytes=512000-, 这个头通知服务端从文件的 512k 位置开始传输文件.</p></li><li><p>服务端收到断点续传请求, 从文件的 512k 位置开始传输, 并且在 http 头中增加: Content-Range: bytes 512000-/1024000, 并且此时服务端返回的 http 状态码应该是 206, 而不是 200.</p></li></ol><h2 class="anchor anchorWithStickyNavbar_y2LR" id="http-请求服务器的简单实现开发篇">http 请求服务器的简单实现(开发篇)<a class="hash-link" href="#http-请求服务器的简单实现开发篇" title="Direct link to heading">​</a></h2><ul><li>中间件:<ul><li>在操作系统, 网络和数据之上, 在应用软件下层</li><li>作用: 处于自己上层的应用软件提供运行和开发的环境, 帮助用户灵活开发复杂的应用软件. 或者说叫做独立的系统软件应用程序. 分布式中间件在不同的技术之间共享资源, 中间件位于客户机服务器的操作系统之上, 管理系统资源和网络通信.</li><li>常见中间件: Tomcat, apache, nginx, jetty 等等</li></ul></li></ul><p>TODO...</p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/aokikoko/aokikoko.github.io/blob/main/website/docs/Http/tcpip2.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_mS5F" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_mt2f"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/docs/Http/tcpip1"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">[Http] 大话Http(上)</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/docs/Http/tcpip3"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">[Http] 大话Http(下)</div></a></div></nav></div></div><div class="col col--3"><div class="tableOfContents_vrFS thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#常见编码规范" class="table-of-contents__link toc-highlight">常见编码规范</a><ul><li><a href="#乱码的由来" class="table-of-contents__link toc-highlight">乱码的由来</a></li><li><a href="#url-的编码与解码" class="table-of-contents__link toc-highlight">URL 的编码与解码</a></li></ul></li><li><a href="#身份认证" class="table-of-contents__link toc-highlight">身份认证</a><ul><li><a href="#身份认证信息" class="table-of-contents__link toc-highlight">身份认证信息</a></li><li><a href="#常见认证方式" class="table-of-contents__link toc-highlight">常见认证方式</a></li><li><a href="#basic-认证基本认证" class="table-of-contents__link toc-highlight">BASIC 认证(基本认证)</a></li><li><a href="#digest摘要认证" class="table-of-contents__link toc-highlight">DIGEST(摘要认证)</a></li><li><a href="#ssl-客户端认证" class="table-of-contents__link toc-highlight">SSL 客户端认证</a></li><li><a href="#formbase-认证基于表单认证" class="table-of-contents__link toc-highlight">FormBase 认证(基于表单认证)</a></li></ul></li><li><a href="#http-的长链接与短连接" class="table-of-contents__link toc-highlight">HTTP 的长链接与短连接</a><ul><li><a href="#短连接" class="table-of-contents__link toc-highlight">短连接</a></li></ul></li><li><a href="#http-中介之代理" class="table-of-contents__link toc-highlight">HTTP 中介之代理</a><ul><li><a href="#典型的代理服务器" class="table-of-contents__link toc-highlight">典型的代理服务器</a></li></ul></li><li><a href="#http-中介之网关" class="table-of-contents__link toc-highlight">HTTP 中介之网关</a><ul><li><a href="#网关的两种分类" class="table-of-contents__link toc-highlight">网关的两种分类</a></li></ul></li><li><a href="#http-缓存" class="table-of-contents__link toc-highlight">HTTP 缓存</a><ul><li><a href="#缓存头部字段" class="table-of-contents__link toc-highlight">缓存头部字段</a></li><li><a href="#缓存改进方案" class="table-of-contents__link toc-highlight">缓存改进方案</a></li><li><a href="#浏览器操作对-http-缓存的影响" class="table-of-contents__link toc-highlight">浏览器操作对 HTTP 缓存的影响</a></li></ul></li><li><a href="#内容协商机制" class="table-of-contents__link toc-highlight">内容协商机制</a><ul><li><a href="#内容协商方式" class="table-of-contents__link toc-highlight">内容协商方式</a></li><li><a href="#服务器驱动内容协商---请求首部集" class="table-of-contents__link toc-highlight">服务器驱动内容协商 - 请求首部集</a></li></ul></li><li><a href="#断点续传和多线程下载" class="table-of-contents__link toc-highlight">断点续传和多线程下载</a><ul><li><a href="#range" class="table-of-contents__link toc-highlight">Range</a></li><li><a href="#断点续传过程" class="table-of-contents__link toc-highlight">断点续传过程</a></li></ul></li><li><a href="#http-请求服务器的简单实现开发篇" class="table-of-contents__link toc-highlight">http 请求服务器的简单实现(开发篇)</a></li></ul></div></div></div></div></main></div></div></div>
<script src="/assets/js/runtime~main.f765f360.js"></script>
<script src="/assets/js/main.f2870086.js"></script>
</body>
</html>