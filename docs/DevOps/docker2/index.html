<!doctype html>
<html class="docs-version-current" lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.14">
<link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="Aoki çš„è‡ªç•™åœ° RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="Aoki çš„è‡ªç•™åœ° Atom Feed">
<link rel="search" type="application/opensearchdescription+xml" title="Aoki çš„è‡ªç•™åœ°" href="/opensearch.xml"><title data-react-helmet="true">[DevOps] å®¹å™¨æŠ€æœ¯ç®¡ç†å·¥å…·-Docker(ä¸­) | Aoki çš„è‡ªç•™åœ°</title><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" property="og:url" content="https://phero.live/docs/DevOps/docker2"><meta data-react-helmet="true" name="docsearch:language" content="en"><meta data-react-helmet="true" name="docsearch:version" content="current"><meta data-react-helmet="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-react-helmet="true" property="og:title" content="[DevOps] å®¹å™¨æŠ€æœ¯ç®¡ç†å·¥å…·-Docker(ä¸­) | Aoki çš„è‡ªç•™åœ°"><meta data-react-helmet="true" name="description" content="docker é•œåƒ"><meta data-react-helmet="true" property="og:description" content="docker é•œåƒ"><link data-react-helmet="true" rel="icon" href="/img/favicon.ico"><link data-react-helmet="true" rel="canonical" href="https://phero.live/docs/DevOps/docker2"><link data-react-helmet="true" rel="alternate" href="https://phero.live/docs/DevOps/docker2" hreflang="en"><link data-react-helmet="true" rel="alternate" href="https://phero.live/docs/DevOps/docker2" hreflang="x-default"><link data-react-helmet="true" rel="preconnect" href="https://BMRZNSN9O0-dsn.algolia.net" crossorigin="anonymous"><link rel="stylesheet" href="/assets/css/styles.b35462c9.css">
<link rel="preload" href="/assets/js/runtime~main.84ec8b59.js" as="script">
<link rel="preload" href="/assets/js/main.b4022aec.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div><a href="#" class="skipToContent_OuoZ">Skip to main content</a></div><nav class="navbar navbar--fixed-top navbar--dark"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/logo.svg" alt="My Site Logo" class="themedImage_TMUO themedImage--light_4Vu1"><img src="/img/logo.svg" alt="My Site Logo" class="themedImage_TMUO themedImage--dark_uzRr"></div><b class="navbar__title">Aoki</b></a><a class="navbar__item navbar__link navbar__link--active" href="/docs/intro">ç¬”è®°</a><a class="navbar__item navbar__link" href="/blog">Blog</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/aokikoko" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link"><span>GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_wgqa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a><div class="toggle_iYfV toggle_2i4l toggleDisabled_xj38"><div class="toggleTrack_t-f2" role="button" tabindex="-1"><div class="toggleTrackCheck_mk7D"><span class="toggleIcon_pHJ9">ğŸŒœ</span></div><div class="toggleTrackX_dm8H"><span class="toggleIcon_pHJ9">ğŸŒ</span></div><div class="toggleTrackThumb_W6To"></div></div><input type="checkbox" class="toggleScreenReader_h9qa" aria-label="Switch between dark and light mode"></div><div class="searchBox_Utm0"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper docs-wrapper docs-doc-page"><div class="docPage_lDyR"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_i9tI" type="button"></button><aside class="docSidebarContainer_0YBq"><div class="sidebar_a3j0"><nav class="menu thin-scrollbar menu_cyFh"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/intro">æˆ‘çš„çŸ¥è¯†åº“ ğŸ˜€</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_TwRn" href="/docs/CSS/transition-animation-transform">CSS</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_TwRn" href="/docs/DocusaurusTips/code-theme">Docusaurusä½¿ç”¨æŠ€å·§</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_TwRn" href="/docs/TypeScript/basic-types">TypeScript</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_TwRn" href="/docs/architecture/history">æ¶æ„</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_TwRn" href="/docs/Algorithm/algo">ç®—æ³•</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_TwRn" href="/docs/Another/bigo">interview2</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_TwRn" href="/docs/Cli/ESLint">Cli</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_TwRn" href="/docs/DataBase/case">DataBase</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active hasHref_TwRn" href="/docs/DevOps/prometheus">DevOps</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/DevOps/prometheus">[DevOps] æ™®ç½—ç±³ä¿®æ–¯</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/DevOps/daima">[DevOps] ä»£ç æ›´æ–°æ–¹æ³•</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/DevOps/jenkins">[DevOps] jenkins</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/DevOps/paas">[DevOps] å®¹å™¨-è™šæ‹ŸåŒ–</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/DevOps/docker1">[DevOps] å®¹å™¨æŠ€æœ¯ç®¡ç†å·¥å…·-Docker(ä¸Š)</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/docs/DevOps/docker2">[DevOps] å®¹å™¨æŠ€æœ¯ç®¡ç†å·¥å…·-Docker(ä¸­)</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/DevOps/docker3">[DevOps] å®¹å™¨æŠ€æœ¯ç®¡ç†å·¥å…·-Docker(ä¸‹)</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/DevOps/dockercompose">[DevOps] å®¹å™¨ç¼–æ’-docker compose</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/DevOps/autopublish">[DevOps] ä»£ç è‡ªåŠ¨å‘å¸ƒç³»ç»Ÿ</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/DevOps/18">[DevOps] Dockerä¸‰å‰‘å®¢</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/DevOps/kubernetes">[DevOps] kubernetes</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_TwRn" href="/docs/Http/OptionsRequest">Http</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_TwRn" href="/docs/Java/basic">Java</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_TwRn" href="/docs/Linux/basic">Linux</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_TwRn" href="/docs/Nginx/sign">Nginx</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_TwRn" href="/docs/Node.js/buffer">Node.js</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_TwRn" href="/docs/React/jsx">React</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_TwRn" href="/docs/interview/http">interview</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_TwRn" href="/docs/javascript/ecma">javascript</a></div></li></ul></nav><button type="button" title="Collapse sidebar" aria-label="Collapse sidebar" class="button button--secondary button--outline collapseSidebarButton_eoK2"><svg width="20" height="20" aria-hidden="true" class="collapseSidebarButtonIcon_e+kA"><g fill="#7a7a7a"><path d="M9.992 10.023c0 .2-.062.399-.172.547l-4.996 7.492a.982.982 0 01-.828.454H1c-.55 0-1-.453-1-1 0-.2.059-.403.168-.551l4.629-6.942L.168 3.078A.939.939 0 010 2.528c0-.548.45-.997 1-.997h2.996c.352 0 .649.18.828.45L9.82 9.472c.11.148.172.347.172.55zm0 0"></path><path d="M19.98 10.023c0 .2-.058.399-.168.547l-4.996 7.492a.987.987 0 01-.828.454h-3c-.547 0-.996-.453-.996-1 0-.2.059-.403.168-.551l4.625-6.942-4.625-6.945a.939.939 0 01-.168-.55 1 1 0 01.996-.997h3c.348 0 .649.18.828.45l4.996 7.492c.11.148.168.347.168.55zm0 0"></path></g></svg></button></div></aside><main class="docMainContainer_r8cw"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_zHA2"><div class="docItemContainer_oiyr"><article><div class="tocCollapsible_aw-L theme-doc-toc-mobile tocMobile_Tx6Y"><button type="button" class="clean-btn tocCollapsibleButton_zr6a">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>[DevOps] å®¹å™¨æŠ€æœ¯ç®¡ç†å·¥å…·-Docker(ä¸­)</h1></header><h2 class="anchor anchorWithStickyNavbar_y2LR" id="docker-é•œåƒ">docker é•œåƒ<a class="hash-link" href="#docker-é•œåƒ" title="Direct link to heading">â€‹</a></h2><h3 class="anchor anchorWithStickyNavbar_y2LR" id="å®¹å™¨ä¸é•œåƒä¹‹é—´çš„å…³ç³»">å®¹å™¨ä¸é•œåƒä¹‹é—´çš„å…³ç³»<a class="hash-link" href="#å®¹å™¨ä¸é•œåƒä¹‹é—´çš„å…³ç³»" title="Direct link to heading">â€‹</a></h3><ul><li>docker client å‘ docker daemon å‘èµ·åˆ›å»ºå®¹å™¨çš„è¯·æ±‚</li><li>docker daemon æŸ¥æ‰¾æœ‰æ— å®¢æˆ·ç«¯éœ€è¦çš„é•œåƒ</li><li>å¦‚æ— ï¼Œåˆ™åˆ°å®¹å™¨çš„é•œåƒä»“åº“ä¸­ä¸‹è½½éœ€è¦çš„é•œåƒ</li><li>æ‹¿åˆ°å®¹å™¨é•œåƒåï¼Œå¯åŠ¨å®¹å™¨</li></ul><h3 class="anchor anchorWithStickyNavbar_y2LR" id="å®¹å™¨é•œåƒä»‹ç»">å®¹å™¨é•œåƒä»‹ç»<a class="hash-link" href="#å®¹å™¨é•œåƒä»‹ç»" title="Direct link to heading">â€‹</a></h3><p>Docker é•œåƒå°±æ˜¯ä¸€ç»„åªè¯»çš„ç›®å½•ï¼Œæˆ–è€…å«åªè¯»çš„ Docker å®¹å™¨æ¨¡æ¿ï¼Œé•œåƒä¸­å«æœ‰ä¸€ä¸ª Docker å®¹å™¨è¿è¡Œæ‰€éœ€è¦çš„æ–‡ä»¶ç³»ç»Ÿï¼Œæ‰€ä»¥æˆ‘ä»¬è¯´ Docker é•œåƒæ˜¯å¯åŠ¨ä¸€ä¸ª Docker å®¹å™¨çš„åŸºç¡€ã€‚</p><p>å¯ä»¥å°† Docker é•œåƒçœ‹æˆæ˜¯ Docker å®¹å™¨çš„é™æ€æ—¶ï¼Œä¹Ÿå¯å°† Docker å®¹å™¨çœ‹æˆæ˜¯ Docker é•œåƒçš„è¿è¡Œæ—¶ã€‚</p><p>ä» Docker çš„å®˜æ–¹æ–‡æ¡£æ¥çœ‹ï¼ŒDocker å®¹å™¨çš„å®šä¹‰å’Œ Docker é•œåƒçš„å®šä¹‰å‡ ä¹æ˜¯ç›¸åŒï¼Œ<code>Docker å®¹å™¨å’ŒDocker é•œåƒçš„åŒºåˆ«ä¸»è¦åœ¨äºdocker å®¹å™¨å¤šå‡ºäº†ä¸€ä¸ªå¯å†™å±‚ã€‚</code></p><p><img alt="wr" src="/assets/images/wr-13d86120757d29ab09ca4232e80d0e61.JPG"></p><p>å®¹å™¨ä¸­çš„è¿›ç¨‹å°±è¿è¡Œåœ¨è¿™ä¸ªå¯å†™å±‚ï¼Œè¿™ä¸ªå¯å†™å±‚æœ‰ä¸¤ä¸ªçŠ¶æ€ï¼Œå³è¿è¡Œæ€å’Œé€€å‡ºæ€ã€‚å½“æˆ‘ä»¬ docker run è¿è¡Œå®¹å™¨åï¼Œdocker å®¹å™¨å°±è¿›å…¥äº†è¿è¡Œæ€ï¼Œå½“æˆ‘ä»¬åœæ­¢æ­£åœ¨è¿è¡Œä¸­çš„å®¹å™¨æ—¶ï¼Œdocker å®¹å™¨å°±è¿›å…¥äº†é€€å‡ºæ€ã€‚</p><p>æˆ‘ä»¬å°†å®¹å™¨ä»è¿è¡Œæ€è½¬ä¸ºé€€å‡ºæ€æ—¶ï¼ŒæœŸé—´å‘ç”Ÿçš„å˜æ›´éƒ½ä¼šå†™å…¥åˆ°å®¹å™¨çš„æ–‡ä»¶ç³»ç»Ÿä¸­(éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œæ­¤å¤„ä¸æ˜¯å†™å…¥åˆ°äº† docker é•œåƒä¸­)ã€‚</p><p>è”åˆæ–‡ä»¶ç³»ç»Ÿï¼ˆUnionFSï¼‰æ˜¯ä¸€ç§è½»é‡çº§çš„é«˜æ€§èƒ½åˆ†å±‚æ–‡ä»¶ç³»ç»Ÿï¼Œå®ƒæ”¯æŒå°†æ–‡ä»¶ç³»ç»Ÿä¸­çš„ä¿®æ”¹ä¿¡æ¯ä½œä¸ºä¸€æ¬¡æäº¤ï¼Œå¹¶å±‚å±‚å åŠ ï¼ŒåŒæ—¶å¯ä»¥å°†ä¸åŒç›®å½•æŒ‚è½½åˆ°åŒä¸€ä¸ªè™šæ‹Ÿæ–‡ä»¶ç³»ç»Ÿä¸‹ï¼Œåº”ç”¨çœ‹åˆ°çš„æ˜¯æŒ‚è½½çš„æœ€ç»ˆç»“æœã€‚</p><p>è”åˆæ–‡ä»¶ç³»ç»Ÿæ˜¯å®ç° Docker é•œåƒçš„æŠ€æœ¯åŸºç¡€ã€‚Docker é•œåƒå¯ä»¥é€šè¿‡åˆ†å±‚æ¥è¿›è¡Œç»§æ‰¿ã€‚ä¾‹å¦‚ï¼Œç”¨æˆ·åŸºäºåŸºç¡€é•œåƒï¼ˆç”¨æ¥ç”Ÿæˆå…¶ä»–é•œåƒçš„åŸºç¡€ï¼Œå¾€å¾€æ²¡æœ‰çˆ¶é•œåƒï¼‰æ¥åˆ¶ä½œå„ç§ä¸åŒçš„åº”ç”¨é•œåƒã€‚è¿™äº›é•œåƒå…±äº«åŒä¸€ä¸ªåŸºç¡€é•œåƒå±‚ï¼Œæé«˜äº†å­˜å‚¨æ•ˆç‡ã€‚æ­¤å¤–ï¼Œå½“ç”¨æˆ·æ”¹å˜äº†ä¸€ä¸ª Docker é•œåƒï¼ˆæ¯”å¦‚å‡çº§ç¨‹åºåˆ°æ–°çš„ç‰ˆæœ¬ï¼‰ï¼Œåˆ™ä¼šåˆ›å»ºä¸€ä¸ªæ–°çš„å±‚ï¼ˆlayerï¼‰ã€‚å› æ­¤ï¼Œç”¨æˆ·ä¸ç”¨æ›¿æ¢æ•´ä¸ªåŸé•œåƒæˆ–è€…é‡æ–°å»ºç«‹ï¼Œåªéœ€è¦æ·»åŠ æ–°å±‚å³å¯ã€‚ç”¨æˆ·åˆ†å‘é•œåƒçš„æ—¶å€™ï¼Œä¹Ÿåªéœ€è¦åˆ†å‘è¢«æ”¹åŠ¨çš„æ–°å±‚å†…å®¹ï¼ˆå¢é‡éƒ¨åˆ†ï¼‰ã€‚è¿™è®© Docker çš„é•œåƒç®¡ç†å˜å¾—ååˆ†è½»é‡çº§å’Œå¿«é€Ÿã€‚</p><h2 class="anchor anchorWithStickyNavbar_y2LR" id="åˆ¶ä½œåŸºç¡€é•œåƒ">åˆ¶ä½œåŸºç¡€é•œåƒ<a class="hash-link" href="#åˆ¶ä½œåŸºç¡€é•œåƒ" title="Direct link to heading">â€‹</a></h2><h3 class="anchor anchorWithStickyNavbar_y2LR" id="1-å®‰è£…ä¸€ä¸ªæœ€å°åŒ–çš„æ“ä½œç³»ç»Ÿä¸»æœº">1. å®‰è£…ä¸€ä¸ªæœ€å°åŒ–çš„æ“ä½œç³»ç»Ÿä¸»æœº<a class="hash-link" href="#1-å®‰è£…ä¸€ä¸ªæœ€å°åŒ–çš„æ“ä½œç³»ç»Ÿä¸»æœº" title="Direct link to heading">â€‹</a></h3><p>è™šæ‹Ÿæœºçš„é•œåƒæ¨¡æ¿ä¸­ä¸ä»…ä»…åŒ…å«æ–‡ä»¶ç³»ç»Ÿ, è¿˜åŒ…æ‹¬æ“ä½œç³»ç»Ÿ. ä½†æ˜¯å®¹å™¨çš„é•œåƒæ¨¡æ¿å½“ä¸­ä»…ä»…åŒ…å«æ–‡ä»¶ç³»ç»Ÿ</p><h3 class="anchor anchorWithStickyNavbar_y2LR" id="2-æ‰“åŒ…æ“ä½œç³»ç»Ÿçš„æ ¹ç›®å½•">2. æ‰“åŒ…æ“ä½œç³»ç»Ÿçš„æ ¹ç›®å½•<a class="hash-link" href="#2-æ‰“åŒ…æ“ä½œç³»ç»Ÿçš„æ ¹ç›®å½•" title="Direct link to heading">â€‹</a></h3><p>ä¸ºä»€ä¹ˆæ‰“åŒ…æ ¹ç›®å½•, å› ä¸ºæ ¹ç›®å½•åŒ…å«äº†æ•´ä¸ªæ“ä½œç³»ç»Ÿé‡Œé¢çš„å†…å®¹</p><p>å¯åŠ¨çŠ¶æ€çš„ä¸»æœºä¸€å®šåŒ…å«è¿™ä¸ªä¸»æœºçš„è¿›ç¨‹å¯¹åº”çš„æ˜ å°„, å› æ­¤éœ€è¦æ’é™¤/proc</p><p>å¯åŠ¨çŠ¶æ€çš„ä¸»æœºä¸€å®šåŒ…å«è¿™ä¸ªä¸»æœºçš„å¯¹åº”çš„æ˜ å°„, å› æ­¤éœ€è¦æ’é™¤/sys</p><div class="codeBlockContainer_J+bg language-shell theme-code-block"><div class="codeBlockContent_csEI shell"><pre tabindex="0" class="prism-code language-shell codeBlock_rtdJ thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)"># --numeric-owner å‚æ•°æŒ‡æ‰“åŒ…è¿‡ç¨‹ä¸­ç»™æ‰€æœ‰çš„æ–‡ä»¶å¤¹ä»¥åŠæ–‡ä»¶çš„ç”¨æˆ·åå…¨éƒ¨æ›¿æ¢æˆæ•°å­—</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># -cvf åˆ›å»ºæ˜¾ç¤ºæ–‡ä»¶</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># / ä»£è¡¨æ‰“åŒ…åˆ° / ç›®å½•</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token plain">root@bogon ~</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token comment" style="color:rgb(98, 114, 164)"># tar --numeric-owner --exclude=/proc --exclude=/sys -cvf centos7u6.tar /</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># ll -h æŸ¥çœ‹æ‰“åŒ…å¥½çš„é•œåƒ</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># scp é•œåƒå.tar ç›®æ ‡ip:/ç›®å½•å</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><h3 class="anchor anchorWithStickyNavbar_y2LR" id="3-æŠŠè·å–çš„æ ¹æ‰“åŒ…æ–‡ä»¶å¯¼å…¥åˆ°-docker-host-ä¸»æœºä¸­">3. æŠŠè·å–çš„æ ¹æ‰“åŒ…æ–‡ä»¶å¯¼å…¥åˆ° Docker host ä¸»æœºä¸­<a class="hash-link" href="#3-æŠŠè·å–çš„æ ¹æ‰“åŒ…æ–‡ä»¶å¯¼å…¥åˆ°-docker-host-ä¸»æœºä¸­" title="Direct link to heading">â€‹</a></h3><div class="codeBlockContainer_J+bg language-shell theme-code-block"><div class="codeBlockContent_csEI shell"><pre tabindex="0" class="prism-code language-shell codeBlock_rtdJ thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)"># æŠŠä¸Šé¢æ‰“å¥½çš„taråŒ…å¯¼å…¥åˆ°ä¸»æœºä¸­å˜æˆåŸºç¡€é•œåƒ</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token plain">root@bogon ~</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token comment" style="color:rgb(98, 114, 164)"># docker import centos7u6.tar centos7u6:latest</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token plain">root@bogon ~</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token comment" style="color:rgb(98, 114, 164)"># docker image ls</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">REPOSITORY TAG IMAGE ID CREATED SIZE</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">centos7u6 latest 9223c5786c4c </span><span class="token number">15</span><span class="token plain"> seconds ago </span><span class="token number">1</span><span class="token plain">.5GB</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><h3 class="anchor anchorWithStickyNavbar_y2LR" id="4-ä½¿ç”¨åŸºç¡€é•œåƒå¯åŠ¨å®¹å™¨">4. ä½¿ç”¨åŸºç¡€é•œåƒå¯åŠ¨å®¹å™¨<a class="hash-link" href="#4-ä½¿ç”¨åŸºç¡€é•œåƒå¯åŠ¨å®¹å™¨" title="Direct link to heading">â€‹</a></h3><div class="codeBlockContainer_J+bg language-shell theme-code-block"><div class="codeBlockContent_csEI shell"><pre tabindex="0" class="prism-code language-shell codeBlock_rtdJ thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#F8F8F2"><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token plain">root@bogon ~</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token comment" style="color:rgb(98, 114, 164)"># docker run -it --name c1000 centos7u6:latest /bin/bash</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token plain">root@f56add98265c /</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token comment" style="color:rgb(98, 114, 164)"># ls /proc</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token number">1</span><span class="token plain"> cpuinfo fs kmsg mounts slabinfo </span><span class="token function" style="color:rgb(80, 250, 123)">tty</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token number">22</span><span class="token plain"> crypto interrupts kpagecount mtrr softirqs </span><span class="token function" style="color:rgb(80, 250, 123)">uptime</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">acpi devices iomem kpageflags net </span><span class="token function" style="color:rgb(80, 250, 123)">stat</span><span class="token plain"> version</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">asound diskstats ioports loadavg pagetypeinfo swaps</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">vmallocinfo</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">buddyinfo dma irq locks partitions sys </span><span class="token function" style="color:rgb(80, 250, 123)">vmstat</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">bus driver kallsyms mdstat sched_debug sysrq-trigger zoneinfo</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">cgroups execdomains kcore meminfo schedstat sysvipc</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">cmdline fb keys misc scsi timer_list</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">consoles filesystems key-users modules self timer_stats</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token plain">root@f56add98265c /</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token comment" style="color:rgb(98, 114, 164)"># ip a s</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token number">1</span><span class="token plain">: lo: </span><span class="token operator">&lt;</span><span class="token plain">LOOPBACK,UP,LOWER_UP</span><span class="token operator">&gt;</span><span class="token plain"> mtu </span><span class="token number">65536</span><span class="token plain"> qdisc noqueue state UNKNOWN group default qlen</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token number">1000</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">link/loopback 00:00:00:00:00:00 brd 00:00:00:00:00:00</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">inet </span><span class="token number">127.0</span><span class="token plain">.0.1/8 scope </span><span class="token function" style="color:rgb(80, 250, 123)">host</span><span class="token plain"> lo</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">valid_lft forever preferred_lft forever</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token number">38</span><span class="token plain">: eth0@if39: </span><span class="token operator">&lt;</span><span class="token plain">BROADCAST,MULTICAST,UP,LOWER_UP</span><span class="token operator">&gt;</span><span class="token plain"> mtu </span><span class="token number">1500</span><span class="token plain"> qdisc noqueue state UP group</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">default</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">link/ether 02:42:ac:11:00:09 brd ff:ff:ff:ff:ff:ff link-netnsid </span><span class="token number">0</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">inet </span><span class="token number">172.17</span><span class="token plain">.0.9/16 brd </span><span class="token number">172.17</span><span class="token plain">.255.255 scope global eth0</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">valid_lft forever preferred_lft forever</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><hr><h2 class="anchor anchorWithStickyNavbar_y2LR" id="åˆ¶ä½œåº”ç”¨é•œåƒ">åˆ¶ä½œåº”ç”¨é•œåƒ<a class="hash-link" href="#åˆ¶ä½œåº”ç”¨é•œåƒ" title="Direct link to heading">â€‹</a></h2><p>åº”ç”¨é•œåƒæŒ‡åº”ç”¨ç¨‹åºè¿è¡Œçš„ç¯å¢ƒ</p><h3 class="anchor anchorWithStickyNavbar_y2LR" id="ä½¿ç”¨-commit-æäº¤é•œåƒ">ä½¿ç”¨ commit æäº¤é•œåƒ<a class="hash-link" href="#ä½¿ç”¨-commit-æäº¤é•œåƒ" title="Direct link to heading">â€‹</a></h3><p>ä½¿ç”¨å®¹å™¨çš„æ–‡ä»¶ç³»ç»Ÿåœ¨åŸºç¡€é•œåƒè¿è¡Œçš„å®¹å™¨ä¸­å®‰è£…åº”ç”¨ï¼Œæ­¤ä¾‹ä½¿ç”¨ httpd</p><div class="codeBlockContainer_J+bg language-shell theme-code-block"><div class="codeBlockContent_csEI shell"><pre tabindex="0" class="prism-code language-shell codeBlock_rtdJ thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#F8F8F2"><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token plain">root@f56add98265c /</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token comment" style="color:rgb(98, 114, 164)"># yum -y install httpd</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>æ­¤æ—¶åˆ¶ä½œäº†ä¸€ä¸ªå®¹å™¨, è¿˜éœ€è¦è®©è¿™ä¸ªå®¹å™¨å˜æˆé•œåƒ</p><p>ä½¿ç”¨ commit å‘½ä»¤å¯¹æ­£åœ¨è¿è¡Œçš„å®¹å™¨æäº¤ä¸ºä¸€ä¸ªåº”ç”¨é•œåƒ</p><div class="codeBlockContainer_J+bg language-shell theme-code-block"><div class="codeBlockContent_csEI shell"><pre tabindex="0" class="prism-code language-shell codeBlock_rtdJ thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#F8F8F2"><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token plain">root@bogon ~</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token comment" style="color:rgb(98, 114, 164)"># docker commit c1000 centos7u6-httpd:v1</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">sha256:7bc399ab72aa3335e383e58d709770fa5c3bfeee66cccf7976776e22fe5fedc7</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token plain">root@bogon ~</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token comment" style="color:rgb(98, 114, 164)"># docker images</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">REPOSITORY TAG IMAGE ID CREATED SIZE</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">centos7u6-httpd v1 7bc399ab72aa </span><span class="token number">5</span><span class="token plain"> seconds ago </span><span class="token number">1</span><span class="token plain">.67GB</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>æ­¤æ—¶å¯ä»¥ä½¿ç”¨åº”ç”¨é•œåƒ</p><div class="codeBlockContainer_J+bg language-shell theme-code-block"><div class="codeBlockContent_csEI shell"><pre tabindex="0" class="prism-code language-shell codeBlock_rtdJ thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#F8F8F2"><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token plain">root@bogon ~</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token comment" style="color:rgb(98, 114, 164)"># docker run -it centos7u6-httpd:v1 /bin/bash</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token plain">root@1abdebd392db /</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token comment" style="color:rgb(98, 114, 164)"># echo &quot;ttt&quot; &gt;&gt; /var/www/html/index.html</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token plain">root@1abdebd392db /</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token comment" style="color:rgb(98, 114, 164)"># httpd -k start</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">AH00558: httpd: Could not reliably determine the server</span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;s fully qualified domain name,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token string" style="color:rgb(255, 121, 198)">using 172.17.0.10. Set the &#x27;</span><span class="token plain">ServerName&#x27; directive globally to suppress this message</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token plain">root@1abdebd392db /</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token comment" style="color:rgb(98, 114, 164)"># curl http://localhost</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">ttt</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><h2 class="anchor anchorWithStickyNavbar_y2LR" id="ä½¿ç”¨-docker-build-åˆ›å»ºæŒ‡å®šåº”ç”¨å®¹å™¨é•œåƒ">ä½¿ç”¨ docker build åˆ›å»ºæŒ‡å®šåº”ç”¨å®¹å™¨é•œåƒ<a class="hash-link" href="#ä½¿ç”¨-docker-build-åˆ›å»ºæŒ‡å®šåº”ç”¨å®¹å™¨é•œåƒ" title="Direct link to heading">â€‹</a></h2><h3 class="anchor anchorWithStickyNavbar_y2LR" id="1-ä½¿ç”¨-docker-build-å‘½ä»¤">1. ä½¿ç”¨ docker build å‘½ä»¤<a class="hash-link" href="#1-ä½¿ç”¨-docker-build-å‘½ä»¤" title="Direct link to heading">â€‹</a></h3><h3 class="anchor anchorWithStickyNavbar_y2LR" id="2-åŸºäº-dockerfile">2. åŸºäº Dockerfile<a class="hash-link" href="#2-åŸºäº-dockerfile" title="Direct link to heading">â€‹</a></h3><h3 class="anchor anchorWithStickyNavbar_y2LR" id="3-dockfile-åŸç†">3. Dockfile åŸç†<a class="hash-link" href="#3-dockfile-åŸç†" title="Direct link to heading">â€‹</a></h3><p>åœ¨ Dockerfile å®šä¹‰æ‰€è¦æ‰§è¡Œçš„å‘½ä»¤ï¼Œä½¿ç”¨ docker build åˆ›å»ºé•œåƒï¼Œè¿‡ç¨‹ä¸­ä¼šæŒ‰ç…§ Dockerfile æ‰€å®šä¹‰çš„å†…å®¹æ‰“å¼€ä¸´æ—¶æ€§å®¹å™¨(ä½¿ç”¨ docker commit è¿›è¡Œæäº¤)ï¼ŒæŠŠ Dockerfile æ–‡ä»¶ä¸­çš„å‘½ä»¤å…¨éƒ¨æ‰§è¡Œå®Œæˆï¼Œå°±å¾—åˆ°äº†ä¸€ä¸ªå®¹å™¨åº”ç”¨é•œåƒã€‚</p><div class="admonition admonition-tip alert alert--success"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="12" height="16" viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>tip</h5></div><div class="admonition-content"><p>æ‰§è¡Œå‘½ä»¤è¶Šå¤šï¼Œæœ€ç»ˆå¾—åˆ°çš„å®¹å™¨åº”ç”¨é•œåƒè¶Šå¤§ï¼Œæ‰€ä»¥è¦åšä¼˜åŒ–</p></div></div><h3 class="anchor anchorWithStickyNavbar_y2LR" id="4-dockerfile-å…³é”®å­—">4. Dockerfile å…³é”®å­—<a class="hash-link" href="#4-dockerfile-å…³é”®å­—" title="Direct link to heading">â€‹</a></h3><h4 class="anchor anchorWithStickyNavbar_y2LR" id="fromæŒ‡å®šåŸºç¡€-image"><strong>FROMï¼ˆæŒ‡å®šåŸºç¡€ imageï¼‰</strong><a class="hash-link" href="#fromæŒ‡å®šåŸºç¡€-image" title="Direct link to heading">â€‹</a></h4><p><code>æ ¼å¼:</code></p><ul><li>FROM <code>&lt;image&gt;</code> æŒ‡å®šåŸºç¡€ image ä¸ºè¯¥ image çš„æœ€åä¿®æ”¹çš„ç‰ˆæœ¬</li><li>FROM <code>&lt;image&gt;:&lt;tag&gt;</code> æŒ‡å®šåŸºç¡€ image ä¸ºè¯¥ image çš„ä¸€ä¸ª tag ç‰ˆæœ¬</li></ul><h4 class="anchor anchorWithStickyNavbar_y2LR" id="maintainerç”¨æ¥æŒ‡å®šé•œåƒåˆ›å»ºè€…ä¿¡æ¯"><strong>MAINTAINERï¼ˆç”¨æ¥æŒ‡å®šé•œåƒåˆ›å»ºè€…ä¿¡æ¯ï¼‰</strong><a class="hash-link" href="#maintainerç”¨æ¥æŒ‡å®šé•œåƒåˆ›å»ºè€…ä¿¡æ¯" title="Direct link to heading">â€‹</a></h4><p><code>æ ¼å¼:</code></p><ul><li>MAINTAINER <code>&lt;name&gt;</code></li><li>ä¾‹å¦‚: MAINTAINER &quot;smartgo <a href="mailto:smartgodevop@126.com" target="_blank" rel="noopener noreferrer">smartgodevop@126.com</a>&quot;</li></ul><h4 class="anchor anchorWithStickyNavbar_y2LR" id="run-è¿è¡Œå‘½ä»¤"><strong>RUN (è¿è¡Œå‘½ä»¤)</strong><a class="hash-link" href="#run-è¿è¡Œå‘½ä»¤" title="Direct link to heading">â€‹</a></h4><p><code>æ ¼å¼:</code></p><ul><li>RUN <code>&lt;command&gt;</code> (the command is run in a shell - /bin/sh -c)</li><li>RUN <!-- -->[&quot;executable&quot;, &quot;param1&quot;, &quot;param2&quot; ...]</li></ul><h4 class="anchor anchorWithStickyNavbar_y2LR" id="cmdè®¾ç½®-container-å¯åŠ¨æ—¶æ‰§è¡Œçš„æ“ä½œ"><strong>CMDï¼ˆè®¾ç½® container å¯åŠ¨æ—¶æ‰§è¡Œçš„æ“ä½œï¼‰</strong><a class="hash-link" href="#cmdè®¾ç½®-container-å¯åŠ¨æ—¶æ‰§è¡Œçš„æ“ä½œ" title="Direct link to heading">â€‹</a></h4><div class="admonition admonition-tip alert alert--success"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="12" height="16" viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>tip</h5></div><div class="admonition-content"><p>å¦‚æœå®¹å™¨é•œåƒä¸­æœ‰æ­¤å‘½ä»¤ï¼Œå¯åŠ¨å®¹å™¨æ—¶ï¼Œä¸è¦æ‰‹åŠ¨è®©å®¹å™¨æ‰§è¡Œå…¶å®ƒå‘½ä»¤</p></div></div><p><code>æ ¼å¼:</code></p><ul><li>CMD <!-- -->[&quot;executable&quot;, &quot;param1&quot;, &quot;param2&quot; ...]</li></ul><h4 class="anchor anchorWithStickyNavbar_y2LR" id="entrypointè®¾ç½®-container-å¯åŠ¨æ—¶æ‰§è¡Œçš„æ“ä½œ">ENTRYPOINTï¼ˆè®¾ç½® container å¯åŠ¨æ—¶æ‰§è¡Œçš„æ“ä½œï¼‰<a class="hash-link" href="#entrypointè®¾ç½®-container-å¯åŠ¨æ—¶æ‰§è¡Œçš„æ“ä½œ" title="Direct link to heading">â€‹</a></h4><p><code>æ ¼å¼:</code></p><ul><li>ENTRYPOINT <!-- -->[&quot;executable&quot;, &quot;param1&quot;, &quot;param2&quot; ...]</li></ul><h4 class="anchor anchorWithStickyNavbar_y2LR" id="userè®¾ç½®-container-å®¹å™¨çš„ç”¨æˆ·">USERï¼ˆè®¾ç½® container å®¹å™¨çš„ç”¨æˆ·ï¼‰<a class="hash-link" href="#userè®¾ç½®-container-å®¹å™¨çš„ç”¨æˆ·" title="Direct link to heading">â€‹</a></h4><p><code>æ ¼å¼:</code></p><ul><li>USER daemon</li></ul><h4 class="anchor anchorWithStickyNavbar_y2LR" id="exposeæŒ‡å®šå®¹å™¨éœ€è¦æ˜ å°„åˆ°å®¿ä¸»æœºå™¨çš„ç«¯å£"><strong>EXPOSEï¼ˆæŒ‡å®šå®¹å™¨éœ€è¦æ˜ å°„åˆ°å®¿ä¸»æœºå™¨çš„ç«¯å£ï¼‰</strong><a class="hash-link" href="#exposeæŒ‡å®šå®¹å™¨éœ€è¦æ˜ å°„åˆ°å®¿ä¸»æœºå™¨çš„ç«¯å£" title="Direct link to heading">â€‹</a></h4><p>å¦‚æœçœŸå®æœºå½“ä¸­æœ‰ç«¯å£, å®¹å™¨é‡Œé¢æ²¡æœ‰å¼€å¯ç«¯å£, æ²¡æ³•åšæ˜ å°„, æ‰€ä»¥éœ€è¦ç»™å®¹å™¨å¼€ç«¯å£</p><p><code>æ ¼å¼:</code></p><ul><li>EXPOSE <code>&lt;port&gt; [&lt;port&gt;...]</code></li></ul><h4 class="anchor anchorWithStickyNavbar_y2LR" id="envç”¨äºè®¾ç½®ç¯å¢ƒå˜é‡">ENVï¼ˆç”¨äºè®¾ç½®ç¯å¢ƒå˜é‡ï¼‰<a class="hash-link" href="#envç”¨äºè®¾ç½®ç¯å¢ƒå˜é‡" title="Direct link to heading">â€‹</a></h4><p><code>æ ¼å¼:</code></p><ul><li>ENV <code>&lt;key&gt; &lt;value&gt;</code></li></ul><h4 class="anchor anchorWithStickyNavbar_y2LR" id="addä»-src-å¤åˆ¶æ–‡ä»¶åˆ°-container-çš„-dest-è·¯å¾„"><strong>ADDï¼ˆä» src å¤åˆ¶æ–‡ä»¶åˆ° container çš„ dest è·¯å¾„ï¼‰</strong><a class="hash-link" href="#addä»-src-å¤åˆ¶æ–‡ä»¶åˆ°-container-çš„-dest-è·¯å¾„" title="Direct link to heading">â€‹</a></h4><p>æŠŠ docker ä¸»æœºçš„æ–‡ä»¶æ·»åŠ åˆ°å®¹å™¨é‡Œ</p><p><code>æ ¼å¼:</code></p><ul><li>ADD <code>&lt;src&gt; &lt;dest&gt;</code></li></ul><h4 class="anchor anchorWithStickyNavbar_y2LR" id="volumeæŒ‡å®šæŒ‚è½½ç‚¹">VOLUMEï¼ˆæŒ‡å®šæŒ‚è½½ç‚¹ï¼‰<a class="hash-link" href="#volumeæŒ‡å®šæŒ‚è½½ç‚¹" title="Direct link to heading">â€‹</a></h4><p><code>æ ¼å¼:</code></p><ul><li>VOLUME <code>[&quot;&lt;mountpoint&gt;&quot;]</code></li></ul><h4 class="anchor anchorWithStickyNavbar_y2LR" id="workdiråˆ‡æ¢ç›®å½•"><strong>WORKDIRï¼ˆåˆ‡æ¢ç›®å½•ï¼‰</strong><a class="hash-link" href="#workdiråˆ‡æ¢ç›®å½•" title="Direct link to heading">â€‹</a></h4><p>æ¯”å¦‚ç°åœ¨ç™»å½•è¿›å®¹å™¨, ä½äºæ ¹ç›®å½•, ä½†æ˜¯è„šæœ¬æ”¾åˆ° /opt æ–‡ä»¶å¤¹ä¸‹, åŸæ¥å·¥ä½œæ˜¯åœ¨æ ¹ç›®å½•ä¸‹å·¥ä½œç°åœ¨æ‰§è¡Œè„šæœ¬è¦åˆ‡æ¢è·¯å¾„, ä½¿ç”¨ workdir åˆ‡æ¢åˆ°/opt</p><p><code>æ ¼å¼:</code></p><ul><li>WORKDIR /path/to/workdir</li></ul><hr><h2 class="anchor anchorWithStickyNavbar_y2LR" id="dockerfile-åº”ç”¨æ¡ˆä¾‹ä¸€">Dockerfile åº”ç”¨æ¡ˆä¾‹ä¸€<a class="hash-link" href="#dockerfile-åº”ç”¨æ¡ˆä¾‹ä¸€" title="Direct link to heading">â€‹</a></h2><p><code>ç›®çš„</code>ï¼šé€šè¿‡ Dockerfile åˆ›å»ºä¸€ä¸ªå¯ä»¥åœ¨å¯åŠ¨å®¹å™¨æ—¶å°±ç›´æ¥å¯åŠ¨ httpd åº”ç”¨çš„é•œåƒ</p><p><code>æ­¥éª¤</code>ï¼š</p><ul><li>åˆ›å»ºä¸€ä¸ªç›®å½•ï¼Œç”¨äºå­˜å‚¨ Dockerfile æ‰€ä½¿ç”¨çš„æ–‡ä»¶</li><li>åœ¨æ­¤ç›®å½•ä¸­åˆ›å»º Dockerfile æ–‡ä»¶åŠåˆ¶ä½œé•œåƒæ‰€ä½¿ç”¨åˆ°çš„æ–‡ä»¶</li><li>åœ¨æ­¤æ­¤ç›®å½•ä¸­ä½¿ç”¨ docker build åˆ›å»ºé•œåƒ(è¯»å– Dockerfile æ–‡ä»¶)</li><li>ä½¿ç”¨åˆ›å»ºçš„é•œåƒå¯åŠ¨å®¹å™¨</li></ul><h3 class="anchor anchorWithStickyNavbar_y2LR" id="è¿‡ç¨‹"><code>è¿‡ç¨‹</code>ï¼š<a class="hash-link" href="#è¿‡ç¨‹" title="Direct link to heading">â€‹</a></h3><ol><li>åˆ›å»ºç›®å½•</li></ol><div class="codeBlockContainer_J+bg language-shell theme-code-block"><div class="codeBlockContent_csEI shell"><pre tabindex="0" class="prism-code language-shell codeBlock_rtdJ thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#F8F8F2"><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token plain">root@bogon ~</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token comment" style="color:rgb(98, 114, 164)"># mkdir test</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token plain">root@bogon ~</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token comment" style="color:rgb(98, 114, 164)"># cd test</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token plain">root@bogon ~</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token plain">vim run-httpd.sh</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)">#æ–‡ä»¶é‡Œå†™å…¥</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)">#!/bin/bash</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token function" style="color:rgb(80, 250, 123)">rm</span><span class="token plain"> -rf /run/httpd/*   </span><span class="token comment" style="color:rgb(98, 114, 164)">#åˆ é™¤apacheè¿›ç¨‹</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">exec</span><span class="token plain"> /sbin/httpd -D FOREGROUND  </span><span class="token comment" style="color:rgb(98, 114, 164)"># -D ç”¨æ¥æŒ‡å®šapacheè¿è¡Œåœ¨å‰ç«¯è¿˜æ˜¯åç«¯ FOREGROUNDä»£è¡¨å‰ç«¯</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><ol start="2"><li>è¿›å…¥ç›®å½•å¹¶åˆ›å»ºç”¨äºå¯åŠ¨ httpd çš„è„šæœ¬æ–‡ä»¶</li></ol><div class="codeBlockContainer_J+bg language-shell theme-code-block"><div class="codeBlockContent_csEI shell"><pre tabindex="0" class="prism-code language-shell codeBlock_rtdJ thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#F8F8F2"><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token plain">root@bogon test</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token comment" style="color:rgb(98, 114, 164)"># cat run-httpd.sh</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)">#!/bin/bash</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token function" style="color:rgb(80, 250, 123)">rm</span><span class="token plain"> -rf /run/httpd/*</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">exec</span><span class="token plain"> /sbin/httpd -D FOREGROUND</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><ol start="3"><li>åˆ›å»ºç”¨äºæµ‹è¯• httpd æ˜¯å¦å¯ç”¨çš„ index.htm</li></ol><div class="codeBlockContainer_J+bg language-shell theme-code-block"><div class="codeBlockContent_csEI shell"><pre tabindex="0" class="prism-code language-shell codeBlock_rtdJ thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#F8F8F2"><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token plain">root@bogon test</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token comment" style="color:rgb(98, 114, 164)"># cat index.html</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">It&#x27;s work</span><span class="token operator">!</span><span class="token operator">!</span><span class="token operator">!</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><ol start="4"><li>åˆ›å»º Dockerfile</li></ol><div class="codeBlockContainer_J+bg language-shell theme-code-block"><div class="codeBlockContent_csEI shell"><pre tabindex="0" class="prism-code language-shell codeBlock_rtdJ thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#F8F8F2"><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token plain">root@bogon test</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token comment" style="color:rgb(98, 114, 164)"># vim Dockerfile</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># æ–‡ä»¶é‡Œå†™å…¥</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">FROM centos7u6:latest</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">MAINTAINER </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;smartdocker@smartdocker@126.com&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">RUN yum clean all</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">RUN </span><span class="token function" style="color:rgb(80, 250, 123)">rpm</span><span class="token plain"> --rebuilddb </span><span class="token operator">&amp;&amp;</span><span class="token plain"> yum -y </span><span class="token function" style="color:rgb(80, 250, 123)">install</span><span class="token plain"> httpd</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">ADD run-httpd.sh /run-httpd.sh     </span><span class="token comment" style="color:rgb(98, 114, 164)"># æ‰”è¿›æ¥åªæœ‰644æƒé™, ä¹Ÿå°±æ˜¯è¯»è¯», è¯»å†™, æ²¡æœ‰æ‰§è¡Œæƒé™, éœ€è¦æ‰§è¡Œæƒé™ä¹Ÿå°±æ˜¯ä¸‹é¢ +x, -v æ˜¾ç¤ºåŠ æƒé™è¿‡ç¨‹</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">RUN </span><span class="token function" style="color:rgb(80, 250, 123)">chmod</span><span class="token plain"> -v +x /run-httpd.sh</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">ADD index.html /var/www/html/</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">EXPOSE </span><span class="token number">80</span><span class="token plain">  </span><span class="token comment" style="color:rgb(98, 114, 164)"># æ˜¯æš´éœ²å®¹å™¨çš„80ç«¯å£</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">WORKDIR /  </span><span class="token comment" style="color:rgb(98, 114, 164)"># åˆ‡æ¢ç›®å½•åˆ°æ ¹, æ‰èƒ½æ‰¾åˆ°æ‰§è¡Œ/run-httpd.shæ–‡ä»¶ å› ä¸ºåœ¨ä¸Šé¢ADDå‘½ä»¤å†³å®šäº†</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">CMD </span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;/bin/bash&quot;</span><span class="token plain">,</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;/run-httpd.sh&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token plain">root@bogon test</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token comment" style="color:rgb(98, 114, 164)"># cat Dockerfile</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><ol start="5"><li>ä½¿ç”¨ docker build åˆ›å»ºé•œåƒï¼Œæ³¨æ„å‘½ä»¤æœ€åæœ‰ä¸€ä¸ªç‚¹ï¼Œç‚¹è¡¨ç¤ºå½“å‰ç›®å½•</li></ol><div class="codeBlockContainer_J+bg language-shell theme-code-block"><div class="codeBlockContent_csEI shell"><pre tabindex="0" class="prism-code language-shell codeBlock_rtdJ thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#F8F8F2"><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token plain">root@bogon test</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token comment" style="color:rgb(98, 114, 164)"># docker build -t centos7u6-base-httpd:v1 .</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><ol start="6"><li>ä½¿ç”¨ä¸Šè¿°åˆ›å»ºçš„åº”ç”¨å®¹å™¨å¯åŠ¨å®¹å™¨</li></ol><div class="codeBlockContainer_J+bg language-shell theme-code-block"><div class="codeBlockContent_csEI shell"><pre tabindex="0" class="prism-code language-shell codeBlock_rtdJ thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#F8F8F2"><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token plain">root@bogon test</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token comment" style="color:rgb(98, 114, 164)"># docker run -d centos7u6-base-httpd:v1</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># -d ä»£è¡¨å®¹å™¨åœ¨åå°æ‰§è¡Œ</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><ol start="7"><li>éªŒè¯å®¹å™¨åŠ httpd æ˜¯å¦å¯ç”¨</li></ol><div class="codeBlockContainer_J+bg language-shell theme-code-block"><div class="codeBlockContent_csEI shell"><pre tabindex="0" class="prism-code language-shell codeBlock_rtdJ thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#F8F8F2"><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token plain">root@bogon test</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token comment" style="color:rgb(98, 114, 164)"># docker inspect 31d #æŸ¥çœ‹å®¹å™¨IPåœ°å€</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token plain">root@bogon test</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token comment" style="color:rgb(98, 114, 164)"># curl http://172.17.0.11</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">It&#x27;s work</span><span class="token operator">!</span><span class="token operator">!</span><span class="token operator">!</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><hr><h2 class="anchor anchorWithStickyNavbar_y2LR" id="æ›¿ä»£åŸç½‘ç«™å†…å®¹æ¡ˆä¾‹">æ›¿ä»£åŸç½‘ç«™å†…å®¹æ¡ˆä¾‹<a class="hash-link" href="#æ›¿ä»£åŸç½‘ç«™å†…å®¹æ¡ˆä¾‹" title="Direct link to heading">â€‹</a></h2><div class="codeBlockContainer_J+bg language-shell theme-code-block"><div class="codeBlockContent_csEI shell"><pre tabindex="0" class="prism-code language-shell codeBlock_rtdJ thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#F8F8F2"><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token plain">root@bogon test</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token comment" style="color:rgb(98, 114, 164)"># mkdir /wwwroot</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token plain">root@bogon test</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token comment" style="color:rgb(98, 114, 164)"># echo &quot;wwwroot&quot; &gt;&gt; /wwwroot/index.html</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token plain">root@bogon test</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token comment" style="color:rgb(98, 114, 164)"># docker run -d -v /wwwroot:/var/www/html centos7u6-base-httpd:v1</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">415e82ad0041aa18bcb92bc8edbdf9bd758915a8345c71266f51937de3a20a26</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token plain">root@bogon test</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token comment" style="color:rgb(98, 114, 164)"># docker inspect 415</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token plain">root@bogon test</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token comment" style="color:rgb(98, 114, 164)"># curl http://172.17.0.12</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">wwwroot</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><div class="admonition admonition-tip alert alert--success"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="12" height="16" viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>tip</h5></div><div class="admonition-content"><p>å¦‚æœé‡åˆ° Rpmdb é”™è¯¯ï¼Œå¯ä»¥è€ƒè™‘å®‰è£…ï¼šyum-plugin-ovl è½¯ä»¶åŒ…ã€‚</p></div></div><hr><h2 class="anchor anchorWithStickyNavbar_y2LR" id="æŠŠ-nginx-åº”ç”¨å®¹å™¨åŒ–æ¡ˆä¾‹">æŠŠ nginx åº”ç”¨å®¹å™¨åŒ–æ¡ˆä¾‹<a class="hash-link" href="#æŠŠ-nginx-åº”ç”¨å®¹å™¨åŒ–æ¡ˆä¾‹" title="Direct link to heading">â€‹</a></h2><p>è¦æ±‚ï¼š</p><ul><li>1ã€é€šè¿‡åŸºç¡€é•œåƒåš nginx åº”ç”¨é•œåƒ</li><li>2ã€ä½¿ç”¨ nginx åº”ç”¨é•œåƒå¯åŠ¨å®¹å™¨æ—¶ï¼Œnginx è¦æ±‚å¯åŠ¨</li><li>3ã€éªŒè¯ nginx æœåŠ¡æ˜¯å¦å¯åŠ¨</li></ul><p>æ­¥éª¤ï¼š</p><ul><li>1ã€ä½¿ç”¨å“ªä¸€ä¸ªåŸºç¡€ centos:latest</li><li>2ã€éœ€è¦ä½¿ç”¨ epel YUM æº</li><li>3ã€å®‰è£… nginx</li><li>4ã€ä¿®æ”¹ nginx é…ç½®æ–‡ä»¶ï¼Œä¸»è¦ç”¨äºå…³é—­ daemon åå°è¿è¡Œ, è¿™æ ·å®¹å™¨ä¸­æœ‰ nginx ä¸€ç›´åœ¨è¿è¡Œ, å®¹å™¨å°±ä¸ä¼šå…³é—­äº†</li><li>5ã€éªŒè¯ä½¿ç”¨çš„æµ‹è¯•é¡µé¢</li></ul><p>è¿‡ç¨‹:</p><ul><li>åˆ›å»ºç›®å½•</li></ul><div class="codeBlockContainer_J+bg language-shell theme-code-block"><div class="codeBlockContent_csEI shell"><pre tabindex="0" class="prism-code language-shell codeBlock_rtdJ thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#F8F8F2"><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token plain">root@localhost ~</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token comment" style="color:rgb(98, 114, 164)"># mkdir nginxtest</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token plain">root@localhost ~</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token comment" style="color:rgb(98, 114, 164)"># cd nginxtest/</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token plain">root@localhost nginxtest</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token comment" style="color:rgb(98, 114, 164)">#</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><ul><li>åˆ›å»ºæµ‹è¯•æ–‡ä»¶</li></ul><div class="codeBlockContainer_J+bg language-shell theme-code-block"><div class="codeBlockContent_csEI shell"><pre tabindex="0" class="prism-code language-shell codeBlock_rtdJ thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#F8F8F2"><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token plain">root@localhost nginxtest</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token comment" style="color:rgb(98, 114, 164)"># echo &#x27;nginx s running!!!&#x27; &gt;&gt; index.html</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token plain">root@localhost nginxtest</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token comment" style="color:rgb(98, 114, 164)"># ls</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">index.html</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><ul><li>åˆ›å»º Dockerfile</li></ul><div class="codeBlockContainer_J+bg language-shell theme-code-block"><div class="codeBlockContent_csEI shell"><pre tabindex="0" class="prism-code language-shell codeBlock_rtdJ thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#F8F8F2"><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token plain">root@localhost nginxtest</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token comment" style="color:rgb(98, 114, 164)"># cat Dockerfile</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">FROM centos:latest</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">MAINTAINER </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;smartaiops&lt;smartaiops@126.com&gt;&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># yum -y install çš„-y ä»£è¡¨éäº¤äº’å¼</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">RUN yum clean all </span><span class="token operator">&amp;&amp;</span><span class="token plain"> yum -y </span><span class="token function" style="color:rgb(80, 250, 123)">install</span><span class="token plain"> yum-plugin-ovl </span><span class="token operator">&amp;&amp;</span><span class="token plain"> yum -y </span><span class="token function" style="color:rgb(80, 250, 123)">install</span><span class="token plain"> epel-release</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">RUN yum -y </span><span class="token function" style="color:rgb(80, 250, 123)">install</span><span class="token plain"> nginx</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">ADD index.html /usr/share/nginx/html/</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">RUN </span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">echo</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;daemon off;&quot;</span><span class="token plain"> </span><span class="token operator">&gt;&gt;</span><span class="token plain"> /etc/nginx/nginx.conf </span><span class="token comment" style="color:rgb(98, 114, 164)">#å–æ¶ˆnginxä»¥daemonèº«ä»½è¿è¡Œ</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">EXPOSE </span><span class="token number">80</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">CMD /usr/sbin/nginx</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><ul><li>ä½¿ç”¨ docker build åˆ›å»º nginx åº”ç”¨é•œåƒ</li></ul><div class="codeBlockContainer_J+bg language-shell theme-code-block"><div class="codeBlockContent_csEI shell"><pre tabindex="0" class="prism-code language-shell codeBlock_rtdJ thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#F8F8F2"><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token plain">root@localhost nginxtest</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token comment" style="color:rgb(98, 114, 164)"># docker build -t centos-nginx:v1 .</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># -t ä»£è¡¨ tagåæ˜¯åé¢çš„</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># å¦‚æœä¸åŠ  . å¯ä»¥ç”¨ -f ç»å¯¹è·¯å¾„ä»£æ›¿</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><ul><li>å¯åŠ¨å®¹å™¨éªŒè¯ nginx æœåŠ¡æ˜¯å¦è‡ªåŠ¨å¼€å¯</li></ul><div class="codeBlockContainer_J+bg language-shell theme-code-block"><div class="codeBlockContent_csEI shell"><pre tabindex="0" class="prism-code language-shell codeBlock_rtdJ thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#F8F8F2"><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token plain">root@localhost nginxtest</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token comment" style="color:rgb(98, 114, 164)"># docker images</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">REPOSITORY TAG IMAGE ID CREATED SIZE</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">centos-nginx v1 cf23c20ff2cd </span><span class="token number">20</span><span class="token plain"> seconds ago 466MB</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token plain">root@localhost nginxtest</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token comment" style="color:rgb(98, 114, 164)"># docker run -d centos-nginx:v1</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">5b1d6dae77d24d9c8dc136a5bf971ebe296e1463838bda46e586d07d6f572f6d</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token plain">root@localhost nginxtest</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token comment" style="color:rgb(98, 114, 164)"># docker ps</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">CONTAINER ID IMAGE COMMAND CREATED STATUS PORTS NAMES</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">5b1d6dae77d2 centos-nginx:v1 </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;/bin/sh -c /usr/sbiâ€¦&quot;</span><span class="token plain"> </span><span class="token number">9</span><span class="token plain"> seconds ago Up </span><span class="token number">8</span><span class="token plain"> seconds </span><span class="token number">80</span><span class="token plain">/tcp upbeat_khayyam</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token plain">root@localhost nginxtest</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token comment" style="color:rgb(98, 114, 164)"># docker inspect 5b1d</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token plain">root@localhost nginxtest</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token comment" style="color:rgb(98, 114, 164)"># curl http://172.17.0.3</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">nginx s running</span><span class="token operator">!</span><span class="token operator">!</span><span class="token operator">!</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><h2 class="anchor anchorWithStickyNavbar_y2LR" id="å®¹å™¨é•œåƒåœ¨-docker-host-å­˜å‚¨ä½ç½®">å®¹å™¨é•œåƒåœ¨ docker host å­˜å‚¨ä½ç½®<a class="hash-link" href="#å®¹å™¨é•œåƒåœ¨-docker-host-å­˜å‚¨ä½ç½®" title="Direct link to heading">â€‹</a></h2><p><img alt="dh" src="/assets/images/dh-3bb2f0657176dca5ac8fc9cab144405b.JPG"></p><p>ä»å›¾ä¸­å¯ä»¥çœ‹å‡ºé™¤äº†æœ€ä¸Šé¢çš„ä¸€å±‚ä¸ºè¯»å†™å±‚ä¹‹å¤–ï¼Œä¸‹é¢çš„å…¶ä»–çš„å±‚éƒ½æ˜¯åªè¯»çš„é•œåƒå±‚ï¼Œå¹¶ä¸”é™¤äº†æœ€ä¸‹é¢çš„ä¸€å±‚å¤–ï¼Œå…¶ä»–çš„å±‚éƒ½æœ‰ä¼šæœ‰ä¸€ä¸ªæŒ‡é’ˆæŒ‡å‘è‡ªå·±ä¸‹é¢çš„ä¸€å±‚é•œåƒã€‚</p><p>è™½ç„¶ç»Ÿä¸€æ–‡ä»¶ç³»ç»Ÿ(union file system)æŠ€æœ¯å°†ä¸åŒçš„é•œåƒå±‚æ•´åˆæˆä¸€ä¸ªç»Ÿä¸€çš„æ–‡ä»¶ç³»ç»Ÿï¼Œä¸ºæ„æˆä¸€ä¸ªå®Œæ•´å®¹å™¨é•œåƒçš„å±‚æä¾›äº†ä¸€ä¸ªç»Ÿä¸€çš„è§†è§’ï¼Œéšè—äº†å¤šä¸ªå±‚çš„å¤æ‚æ€§ï¼Œå¯¹ç”¨æˆ·æ¥è¯´åªå­˜åœ¨ä¸€ä¸ªæ–‡ä»¶ç³»ç»Ÿï¼Œä½†å›¾ä¸­çš„è¿™äº›å±‚å¹¶ä¸æ˜¯ä¸èƒ½çœ‹åˆ°çš„ï¼Œå¦‚æœéœ€è¦æŸ¥çœ‹çš„è¯å¯ä»¥è¿›å…¥è¿è¡Œ Docker çš„æœºå™¨ä¸Šè¿›è¡ŒæŸ¥çœ‹ï¼Œä»è¿™äº›å±‚ä¸­å¯ä»¥çœ‹åˆ° Docker å†…éƒ¨å®ç°çš„ä¸€äº›ç»†èŠ‚ã€‚</p><p><code>Docker çš„å®¹å™¨é•œåƒ</code>å’Œ<code>å®¹å™¨æœ¬èº«çš„æ•°æ®</code>éƒ½å­˜æ”¾åœ¨æœåŠ¡å™¨çš„ /var/lib/docker/ è¿™ä¸ªè·¯å¾„ä¸‹ã€‚ä¸è¿‡ä¸åŒçš„ linux å‘è¡Œç‰ˆå­˜å‚¨æ–¹å¼ä¸Šæœ‰å·®åˆ«ï¼Œæ¯”å¦‚ï¼Œåœ¨ ubuntu å‘è¡Œç‰ˆä¸Šå­˜å‚¨æ–¹å¼ä¸º AUFSï¼ŒCentOS å‘è¡Œç‰ˆä¸Šçš„å­˜å‚¨æ–¹å¼ä¸º Overlay æˆ– Overlay2ã€‚</p><div class="admonition admonition-tip alert alert--success"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="12" height="16" viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>tip</h5></div><div class="admonition-content"><p>centos ç³»ç»Ÿ docker é»˜è®¤ä½¿ç”¨å­˜å‚¨é©±åŠ¨æ˜¯ devicemapperï¼Œè€Œè¿™ç§å­˜å‚¨é©±åŠ¨æœ‰ä¸¤ç§æ¨¡å¼ loop-lvm å’Œ direct-lvmï¼Œä¸å·§é»˜è®¤åˆä½¿ç”¨äº†æ¯”è¾ƒä½æ•ˆçš„ loop-lvmã€‚</p></div></div><p>OverlayFS æ˜¯ä¸€ä¸ªç±»ä¼¼äº AUFS çš„ç°ä»£è”åˆæ–‡ä»¶ç³»ç»Ÿï¼Œæ›´å¿«å®ç°ç®€å•ã€‚</p><p>OverlayFS æ˜¯å†…æ ¸æä¾›çš„æ–‡ä»¶ç³»ç»Ÿï¼Œoverlay å’Œ overlay2 æ˜¯ docker çš„å­˜å‚¨é©±åŠ¨</p><h3 class="anchor anchorWithStickyNavbar_y2LR" id="overlay-åŠ-overlay2-åŸç†">Overlay åŠ Overlay2 åŸç†<a class="hash-link" href="#overlay-åŠ-overlay2-åŸç†" title="Direct link to heading">â€‹</a></h3><p>OverlayFS å°†å•ä¸ª Linux ä¸»æœºä¸Šçš„ä¸¤ä¸ªç›®å½•åˆå¹¶æˆä¸€ä¸ªç›®å½•ã€‚è¿™äº›ç›®å½•è¢«ç§°ä¸ºå±‚ï¼Œç»Ÿä¸€è¿‡ç¨‹è¢«ç§°ä¸ºè”åˆæŒ‚è½½ã€‚OverlayFS åº•å±‚ç›®å½•ç§°ä¸º lowerdirï¼Œ é«˜å±‚ç›®å½•ç§°ä¸º upperdirã€‚åˆå¹¶ç»Ÿä¸€è§†å›¾ç§°ä¸º mergedã€‚å½“éœ€è¦ä¿®æ”¹ä¸€ä¸ªæ–‡ä»¶æ—¶ï¼Œä½¿ç”¨ CoW å°†æ–‡ä»¶ä»åªè¯»çš„ Lower å¤åˆ¶åˆ°å¯å†™çš„ Upper è¿›è¡Œä¿®æ”¹ï¼Œç»“æœä¹Ÿä¿å­˜åœ¨ Upper å±‚ã€‚åœ¨ Docker ä¸­ï¼Œåº•ä¸‹çš„åªè¯»å±‚å°±æ˜¯ imageï¼Œå¯å†™å±‚å°±æ˜¯ Containerã€‚</p><p>overlay2 æ˜¯ overlay çš„æ”¹è¿›ç‰ˆï¼Œåªæ”¯æŒ 4.0 ä»¥ä¸Šå†…æ ¸æ·»åŠ äº† Multiple lower layers in overlayfs çš„ç‰¹æ€§ï¼Œæ‰€ä»¥ overlay2 å¯ä»¥ç›´æ¥é€ æˆ muitiple lower layers ä¸ç”¨åƒ overlay ä¸€æ ·è¦é€šè¿‡ç¡¬é“¾æ¥çš„æ–¹å¼(æœ€å¤§ 128 å±‚) centos çš„è¯æ”¯æŒ 3.10.0-514 åŠä»¥ä¸Šå†…æ ¸ç‰ˆæœ¬ä¹Ÿæœ‰æ­¤ç‰¹æ€§ï¼Œæ‰€ä»¥æ¶ˆè€—æ›´å°‘çš„ inode</p><p><code>æœ¬è´¨åŒºåˆ«æ˜¯é•œåƒå±‚ä¹‹é—´å…±äº«æ•°æ®çš„æ–¹æ³•ä¸åŒ</code></p><ul><li><p>overlay å…±äº«æ•°æ®æ–¹å¼æ˜¯é€šè¿‡ç¡¬è¿æ¥ï¼ŒåªæŒ‚è½½ä¸€å±‚,å…¶ä»–å±‚é€šè¿‡æœ€é«˜å±‚é€šè¿‡ç¡¬è¿æ¥å½¢å¼å…±äº«(å¢åŠ äº†ç£ç›˜ inode çš„è´Ÿæ‹…)</p></li><li><p>è€Œ overlay2 æ˜¯é€šè¿‡æ¯å±‚çš„ lower æ–‡ä»¶</p></li></ul><p><img alt="overlay" src="/assets/images/overlay-025643f967db19b53060d68b096e5ade.JPG"></p><p>å¦‚æœ upperdir å’Œ lowerdir æœ‰åŒåæ–‡ä»¶æ—¶ä¼šç”¨ upperdir çš„æ–‡ä»¶</p><h3 class="anchor anchorWithStickyNavbar_y2LR" id="æŸ¥çœ‹-docker-é»˜è®¤ä½¿ç”¨çš„å­˜å‚¨é©±åŠ¨æ–¹æ³•">æŸ¥çœ‹ docker é»˜è®¤ä½¿ç”¨çš„å­˜å‚¨é©±åŠ¨æ–¹æ³•<a class="hash-link" href="#æŸ¥çœ‹-docker-é»˜è®¤ä½¿ç”¨çš„å­˜å‚¨é©±åŠ¨æ–¹æ³•" title="Direct link to heading">â€‹</a></h3><div class="codeBlockContainer_J+bg language-shell theme-code-block"><div class="codeBlockContent_csEI shell"><pre tabindex="0" class="prism-code language-shell codeBlock_rtdJ thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#F8F8F2"><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token plain">root@bogon overlay2</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token comment" style="color:rgb(98, 114, 164)"># docker info</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Containers: </span><span class="token number">1</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Running: </span><span class="token number">1</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Paused: </span><span class="token number">0</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Stopped: </span><span class="token number">0</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Images: </span><span class="token number">1</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Server Version: </span><span class="token number">18.09</span><span class="token plain">.5</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Storage Driver: overlay2 </span><span class="token comment" style="color:rgb(98, 114, 164)">#æ³¨æ„æ­¤å¤„</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Backing Filesystem: xfs</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Supports d_type: </span><span class="token boolean">true</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Native Overlay Diff: </span><span class="token boolean">true</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Logging Driver: json-file</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Cgroup Driver: cgroupfs</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Plugins:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># ä»¥ä¸‹ç•¥</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><h3 class="anchor anchorWithStickyNavbar_y2LR" id="docker-è¿è¡Œå‰">docker è¿è¡Œå‰<a class="hash-link" href="#docker-è¿è¡Œå‰" title="Direct link to heading">â€‹</a></h3><p>/var/lib/docker/overlay2 è·¯å¾„ä¸‹çš„ä¿¡æ¯åœ¨ä¸åŒçš„é˜¶æ®µä¼šæœ‰å˜åŒ–ï¼Œäº†è§£è¿™å‡ ä¸ªé˜¶æ®µä¸­æ–°å¢çš„æ•°æ®ä»¥åŠå®¹å™¨ä¸é•œåƒçš„å­˜å‚¨ç»“æ„çš„å˜åŒ–éå¸¸æœ‰åˆ©äºæˆ‘ä»¬å¯¹ Docker å®¹å™¨ä»¥åŠ Docker é•œåƒçš„ç†è§£ã€‚</p><p>Docker è¿è¡Œå‰ã€Docker è¿è¡Œåã€ä¸‹è½½é•œåƒåã€è¿è¡Œå®¹å™¨åå››ä¸ªé˜¶æ®µä¸­ Docker å­˜å‚¨çš„å˜åŒ–</p><ul><li>è¿è¡Œå‰</li></ul><p>æ²¡æœ‰å¯åŠ¨ docker daemon ä¹‹é—´ä¸ä¼šåœ¨/var/lib/ç›®å½•ä¸­æ·»åŠ  docker ç›®å½•</p><ul><li>å¯åŠ¨å</li></ul><div class="codeBlockContainer_J+bg language-shell theme-code-block"><div class="codeBlockContent_csEI shell"><pre tabindex="0" class="prism-code language-shell codeBlock_rtdJ thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#F8F8F2"><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token plain">root@bogon ~</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token comment" style="color:rgb(98, 114, 164)"># systemctl start docker</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token plain">root@bogon ~</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token comment" style="color:rgb(98, 114, 164)"># tree /var/lib/docker</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">/var/lib/docker</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">â”œâ”€â”€ builder</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">â”‚ â””â”€â”€ fscache.db</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">â”œâ”€â”€ buildkit</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">â”‚ â”œâ”€â”€ cache.db</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">â”‚ â”œâ”€â”€ content</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">â”‚ â”‚ â””â”€â”€ ingest</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">â”‚ â”œâ”€â”€ executor</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">â”‚ â”œâ”€â”€ metadata.db</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">â”‚ â””â”€â”€ snapshots.db</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">â”œâ”€â”€ containers</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">â”œâ”€â”€ image</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">â”‚ â””â”€â”€ overlay2</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">â”‚ â”œâ”€â”€ distribution</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">â”‚ â”œâ”€â”€ imagedb</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">â”‚ â”‚ â”œâ”€â”€ content</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">â”‚ â”‚ â”‚ â””â”€â”€ sha256</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">â”‚ â”‚ â””â”€â”€ metadata</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">â”‚ â”‚ â””â”€â”€ sha256</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">â”‚ â”œâ”€â”€ layerdb</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">â”‚ â””â”€â”€ repositories.json</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">â”œâ”€â”€ network</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">â”‚ â””â”€â”€ files</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">â”‚ â””â”€â”€ local-kv.db</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">â”œâ”€â”€ overlay2 </span><span class="token comment" style="color:rgb(98, 114, 164)">#ä¸‹è½½é•œåƒåï¼Œå­˜å‚¨åœ¨æ­¤ç›®å½•ä¸­</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">â”‚ â”œâ”€â”€ backingFsBlockDev</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">â”‚ â””â”€â”€ l</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">â”œâ”€â”€ plugins</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">â”‚ â”œâ”€â”€ storage</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">â”‚ â”‚ â””â”€â”€ blobs</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">â”‚ â”‚ â””â”€â”€ tmp</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">â”‚ â””â”€â”€ tmp</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">â”œâ”€â”€ runtimes</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">â”œâ”€â”€ swarm</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">â”œâ”€â”€ tmp</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">â”œâ”€â”€ trust</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">â””â”€â”€ volumes</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">â””â”€â”€ metadata.db</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token number">29</span><span class="token plain"> directories, </span><span class="token number">8</span><span class="token plain"> files</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><ul><li>ä¸‹è½½é•œåƒå</li></ul><div class="codeBlockContainer_J+bg language-shell theme-code-block"><div class="codeBlockContent_csEI shell"><pre tabindex="0" class="prism-code language-shell codeBlock_rtdJ thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#F8F8F2"><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token plain">root@bogon overlay2</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token comment" style="color:rgb(98, 114, 164)"># pwd</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">/var/lib/docker/overlay2</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token plain">root@bogon overlay2</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token comment" style="color:rgb(98, 114, 164)"># ls</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">2d297a77c653f510dce69815627fdb485462b1b2fc9e0078a9ecc5ca2d222c8d backingFsBlockDev l</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token plain">root@bogon overlay2</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token comment" style="color:rgb(98, 114, 164)"># ls</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">2d297a77c653f510dce69815627fdb485462b1b2fc9e0078a9ecc5ca2d222c8d/</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token function" style="color:rgb(80, 250, 123)">diff</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">link</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token plain">root@bogon overlay2</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token comment" style="color:rgb(98, 114, 164)"># ls</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">2d297a77c653f510dce69815627fdb485462b1b2fc9e0078a9ecc5ca2d222c8d/diff/</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">anaconda-post.log dev home lib64 mnt proc run srv tmp var</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">bin etc lib media opt root sbin sys usr</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>centos é•œåƒåªæœ‰ä¸€å±‚</p><div class="codeBlockContainer_J+bg language-shell theme-code-block"><div class="codeBlockContent_csEI shell"><pre tabindex="0" class="prism-code language-shell codeBlock_rtdJ thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#F8F8F2"><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token plain">root@bogon overlay2</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token comment" style="color:rgb(98, 114, 164)"># pwd</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">/var/lib/docker/overlay2</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token plain">root@bogon overlay2</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token comment" style="color:rgb(98, 114, 164)"># ls</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">2d297a77c653f510dce69815627fdb485462b1b2fc9e0078a9ecc5ca2d222c8d backingFsBlockDev l</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token plain">root@bogon overlay2</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token comment" style="color:rgb(98, 114, 164)"># ll l</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">æ€»ç”¨é‡ </span><span class="token number">0</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">lrwxrwxrwx </span><span class="token number">1</span><span class="token plain"> root root </span><span class="token number">72</span><span class="token plain"> </span><span class="token number">4</span><span class="token plain">æœˆ </span><span class="token number">26</span><span class="token plain"> </span><span class="token number">12</span><span class="token plain">:58 MBRXMBFE2MYZYMO5RZLRLTMRGJ -</span><span class="token operator">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">..</span><span class="token plain">/2d297a77c653f510dce69815627fdb485462b1b2fc9e0078a9ecc5ca2d222c8d/diff</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>l ç›®å½•ä¸­åŒ…å«äº†å¾ˆå¤šå¤šè½¯é“¾æ¥ï¼Œä½¿ç”¨çŸ­åç§°æŒ‡å‘äº†å…¶ä»–å±‚ï¼ŒçŸ­åç§°ç”¨äºé¿å… mount å‚æ•°æ—¶è¾¾åˆ°é¡µé¢å¤§å°çš„é™åˆ¶</p><ul><li>è¿è¡Œå®¹å™¨å</li></ul><p>Overlay2 å®¹å™¨ç»“æ„</p><div class="codeBlockContainer_J+bg language-shell theme-code-block"><div class="codeBlockContent_csEI shell"><pre tabindex="0" class="prism-code language-shell codeBlock_rtdJ thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)">#è¿è¡Œå®¹å™¨å‰</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token plain">root@bogon overlay2</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token comment" style="color:rgb(98, 114, 164)"># ls</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">2d297a77c653f510dce69815627fdb485462b1b2fc9e0078a9ecc5ca2d222c8d backingFsBlockDev l</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)">#è¿è¡Œå®¹å™¨å</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token plain">root@bogon overlay2</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token comment" style="color:rgb(98, 114, 164)"># ls</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">00bd7dcc4c91f9a1a1257b8c0683fdd0b6dfe18af26597457e92b4d15c20cda0</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">backingFsBlockDev</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">00bd7dcc4c91f9a1a1257b8c0683fdd0b6dfe18af26597457e92b4d15c20cda0-init l</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">2d297a77c653f510dce69815627fdb485462b1b2fc9e0078a9ecc5ca2d222c8d</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token plain">root@bogon overlay2</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token comment" style="color:rgb(98, 114, 164)"># ll</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">00bd7dcc4c91f9a1a1257b8c0683fdd0b6dfe18af26597457e92b4d15c20cda0</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">æ€»ç”¨é‡ </span><span class="token number">8</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">drwxr-xr-x </span><span class="token number">2</span><span class="token plain"> root root </span><span class="token number">6</span><span class="token plain"> </span><span class="token number">4</span><span class="token plain">æœˆ </span><span class="token number">26</span><span class="token plain"> </span><span class="token number">13</span><span class="token plain">:15 </span><span class="token function" style="color:rgb(80, 250, 123)">diff</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">-rw-r--r-- </span><span class="token number">1</span><span class="token plain"> root root </span><span class="token number">26</span><span class="token plain"> </span><span class="token number">4</span><span class="token plain">æœˆ </span><span class="token number">26</span><span class="token plain"> </span><span class="token number">13</span><span class="token plain">:15 </span><span class="token function" style="color:rgb(80, 250, 123)">link</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">-rw-r--r-- </span><span class="token number">1</span><span class="token plain"> root root </span><span class="token number">57</span><span class="token plain"> </span><span class="token number">4</span><span class="token plain">æœˆ </span><span class="token number">26</span><span class="token plain"> </span><span class="token number">13</span><span class="token plain">:15 lower</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">drwxr-xr-x </span><span class="token number">1</span><span class="token plain"> root root </span><span class="token number">6</span><span class="token plain"> </span><span class="token number">4</span><span class="token plain">æœˆ </span><span class="token number">26</span><span class="token plain"> </span><span class="token number">13</span><span class="token plain">:15 merged</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">drwx------ </span><span class="token number">3</span><span class="token plain"> root root </span><span class="token number">18</span><span class="token plain"> </span><span class="token number">4</span><span class="token plain">æœˆ </span><span class="token number">26</span><span class="token plain"> </span><span class="token number">13</span><span class="token plain">:15 work</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>å¯åŠ¨ä¸€ä¸ªå®¹å™¨ï¼Œä¹Ÿæ˜¯è½½/var/lib/docker/overlay2 ç›®å½•ä¸‹ç”Ÿæˆä¸€å±‚å®¹å™¨å±‚ï¼Œç›®å½•åŒ…æ‹¬ diffï¼Œlinkï¼Œlowerï¼Œmergedï¼Œworkã€‚</p><p>diff è®°å½•æ¯ä¸€å±‚è‡ªå·±å†…å®¹çš„æ•°æ®ï¼›link è®°å½•è¯¥å±‚é“¾æ¥ç›®å½•ï¼ˆå®é™…æ˜¯ l ç›®å½•ä¸‹åˆ°å±‚çš„é“¾æ¥ï¼‰ï¼Œæ¯”å¦‚åœ¨å®¹å™¨ä¸­åˆ›å»ºç›®å½•æˆ–åœ¨ diff æ–°å¢è¯¥ç›®å½•ï¼›åˆ›å»ºå®¹å™¨æ—¶å°† lower-id æŒ‡å‘çš„é•œåƒå±‚ç›®å½•ä»¥åŠ upper ç›®å½•è”åˆæŒ‚è½½åˆ° merged ç›®å½•ï¼›work ç”¨æ¥å®Œæˆå¦‚ copy-on_write çš„æ“ä½œã€‚</p><p>å¯åŠ¨å®¹å™¨åï¼Œå¯ä»¥åœ¨ docker host æŸ¥çœ‹ mount æƒ…å†µ</p><div class="codeBlockContainer_J+bg language-shell theme-code-block"><div class="codeBlockContent_csEI shell"><pre tabindex="0" class="prism-code language-shell codeBlock_rtdJ thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#F8F8F2"><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token plain">root@bogon overlay2</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token comment" style="color:rgb(98, 114, 164)"># mount | grep overlay</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">overlay on</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">/var/lib/docker/overlay2/00bd7dcc4c91f9a1a1257b8c0683fdd0b6dfe18af26597457e92b4d15c20cd</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">a0/merged </span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">type</span><span class="token plain"> overlay</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">rw,relatime,lowerdir</span><span class="token operator">=</span><span class="token plain">/var/lib/docker/overlay2/l/4GXMF7JGUPRUBLW5SM4X4FY5R2:/var/lib/do</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">cker/overlay2/l/MBRXMBFE2MYZYMO5RZLRLTMRGJ,upperdir</span><span class="token operator">=</span><span class="token plain">/var/lib/docker/overlay2/00bd7dcc4c</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">91f9a1a1257b8c0683fdd0b6dfe18af26597457e92b4d15c20cda0/diff,workdir</span><span class="token operator">=</span><span class="token plain">/var/lib/docker/ove</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">rlay2/00bd7dcc4c91f9a1a1257b8c0683fdd0b6dfe18af26597457e92b4d15c20cda0/work</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/aokikoko/aokikoko.github.io/blob/main/website/docs/DevOps/docker2.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_mS5F" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_mt2f"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/docs/DevOps/docker1"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">[DevOps] å®¹å™¨æŠ€æœ¯ç®¡ç†å·¥å…·-Docker(ä¸Š)</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/docs/DevOps/docker3"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">[DevOps] å®¹å™¨æŠ€æœ¯ç®¡ç†å·¥å…·-Docker(ä¸‹)</div></a></div></nav></div></div><div class="col col--3"><div class="tableOfContents_vrFS thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#docker-é•œåƒ" class="table-of-contents__link toc-highlight">docker é•œåƒ</a><ul><li><a href="#å®¹å™¨ä¸é•œåƒä¹‹é—´çš„å…³ç³»" class="table-of-contents__link toc-highlight">å®¹å™¨ä¸é•œåƒä¹‹é—´çš„å…³ç³»</a></li><li><a href="#å®¹å™¨é•œåƒä»‹ç»" class="table-of-contents__link toc-highlight">å®¹å™¨é•œåƒä»‹ç»</a></li></ul></li><li><a href="#åˆ¶ä½œåŸºç¡€é•œåƒ" class="table-of-contents__link toc-highlight">åˆ¶ä½œåŸºç¡€é•œåƒ</a><ul><li><a href="#1-å®‰è£…ä¸€ä¸ªæœ€å°åŒ–çš„æ“ä½œç³»ç»Ÿä¸»æœº" class="table-of-contents__link toc-highlight">1. å®‰è£…ä¸€ä¸ªæœ€å°åŒ–çš„æ“ä½œç³»ç»Ÿä¸»æœº</a></li><li><a href="#2-æ‰“åŒ…æ“ä½œç³»ç»Ÿçš„æ ¹ç›®å½•" class="table-of-contents__link toc-highlight">2. æ‰“åŒ…æ“ä½œç³»ç»Ÿçš„æ ¹ç›®å½•</a></li><li><a href="#3-æŠŠè·å–çš„æ ¹æ‰“åŒ…æ–‡ä»¶å¯¼å…¥åˆ°-docker-host-ä¸»æœºä¸­" class="table-of-contents__link toc-highlight">3. æŠŠè·å–çš„æ ¹æ‰“åŒ…æ–‡ä»¶å¯¼å…¥åˆ° Docker host ä¸»æœºä¸­</a></li><li><a href="#4-ä½¿ç”¨åŸºç¡€é•œåƒå¯åŠ¨å®¹å™¨" class="table-of-contents__link toc-highlight">4. ä½¿ç”¨åŸºç¡€é•œåƒå¯åŠ¨å®¹å™¨</a></li></ul></li><li><a href="#åˆ¶ä½œåº”ç”¨é•œåƒ" class="table-of-contents__link toc-highlight">åˆ¶ä½œåº”ç”¨é•œåƒ</a><ul><li><a href="#ä½¿ç”¨-commit-æäº¤é•œåƒ" class="table-of-contents__link toc-highlight">ä½¿ç”¨ commit æäº¤é•œåƒ</a></li></ul></li><li><a href="#ä½¿ç”¨-docker-build-åˆ›å»ºæŒ‡å®šåº”ç”¨å®¹å™¨é•œåƒ" class="table-of-contents__link toc-highlight">ä½¿ç”¨ docker build åˆ›å»ºæŒ‡å®šåº”ç”¨å®¹å™¨é•œåƒ</a><ul><li><a href="#1-ä½¿ç”¨-docker-build-å‘½ä»¤" class="table-of-contents__link toc-highlight">1. ä½¿ç”¨ docker build å‘½ä»¤</a></li><li><a href="#2-åŸºäº-dockerfile" class="table-of-contents__link toc-highlight">2. åŸºäº Dockerfile</a></li><li><a href="#3-dockfile-åŸç†" class="table-of-contents__link toc-highlight">3. Dockfile åŸç†</a></li><li><a href="#4-dockerfile-å…³é”®å­—" class="table-of-contents__link toc-highlight">4. Dockerfile å…³é”®å­—</a></li></ul></li><li><a href="#dockerfile-åº”ç”¨æ¡ˆä¾‹ä¸€" class="table-of-contents__link toc-highlight">Dockerfile åº”ç”¨æ¡ˆä¾‹ä¸€</a><ul><li><a href="#è¿‡ç¨‹" class="table-of-contents__link toc-highlight"><code>è¿‡ç¨‹</code>ï¼š</a></li></ul></li><li><a href="#æ›¿ä»£åŸç½‘ç«™å†…å®¹æ¡ˆä¾‹" class="table-of-contents__link toc-highlight">æ›¿ä»£åŸç½‘ç«™å†…å®¹æ¡ˆä¾‹</a></li><li><a href="#æŠŠ-nginx-åº”ç”¨å®¹å™¨åŒ–æ¡ˆä¾‹" class="table-of-contents__link toc-highlight">æŠŠ nginx åº”ç”¨å®¹å™¨åŒ–æ¡ˆä¾‹</a></li><li><a href="#å®¹å™¨é•œåƒåœ¨-docker-host-å­˜å‚¨ä½ç½®" class="table-of-contents__link toc-highlight">å®¹å™¨é•œåƒåœ¨ docker host å­˜å‚¨ä½ç½®</a><ul><li><a href="#overlay-åŠ-overlay2-åŸç†" class="table-of-contents__link toc-highlight">Overlay åŠ Overlay2 åŸç†</a></li><li><a href="#æŸ¥çœ‹-docker-é»˜è®¤ä½¿ç”¨çš„å­˜å‚¨é©±åŠ¨æ–¹æ³•" class="table-of-contents__link toc-highlight">æŸ¥çœ‹ docker é»˜è®¤ä½¿ç”¨çš„å­˜å‚¨é©±åŠ¨æ–¹æ³•</a></li><li><a href="#docker-è¿è¡Œå‰" class="table-of-contents__link toc-highlight">docker è¿è¡Œå‰</a></li></ul></li></ul></div></div></div></div></main></div></div></div>
<script src="/assets/js/runtime~main.84ec8b59.js"></script>
<script src="/assets/js/main.b4022aec.js"></script>
</body>
</html>