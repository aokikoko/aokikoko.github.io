<!doctype html>
<html class="docs-version-current" lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.14">
<link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="Aoki çš„è‡ªç•™åœ° RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="Aoki çš„è‡ªç•™åœ° Atom Feed">
<link rel="search" type="application/opensearchdescription+xml" title="Aoki çš„è‡ªç•™åœ°" href="/opensearch.xml"><title data-react-helmet="true">[DevOps] æ™®ç½—ç±³ä¿®æ–¯ | Aoki çš„è‡ªç•™åœ°</title><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" property="og:url" content="https://phero.live/docs/DevOps/prometheus"><meta data-react-helmet="true" name="docsearch:language" content="en"><meta data-react-helmet="true" name="docsearch:version" content="current"><meta data-react-helmet="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-react-helmet="true" property="og:title" content="[DevOps] æ™®ç½—ç±³ä¿®æ–¯ | Aoki çš„è‡ªç•™åœ°"><meta data-react-helmet="true" name="description" content="æ™®ç½—ç±³ä¿®æ–¯"><meta data-react-helmet="true" property="og:description" content="æ™®ç½—ç±³ä¿®æ–¯"><link data-react-helmet="true" rel="icon" href="/img/favicon.ico"><link data-react-helmet="true" rel="canonical" href="https://phero.live/docs/DevOps/prometheus"><link data-react-helmet="true" rel="alternate" href="https://phero.live/docs/DevOps/prometheus" hreflang="en"><link data-react-helmet="true" rel="alternate" href="https://phero.live/docs/DevOps/prometheus" hreflang="x-default"><link data-react-helmet="true" rel="preconnect" href="https://BMRZNSN9O0-dsn.algolia.net" crossorigin="anonymous"><link rel="stylesheet" href="/assets/css/styles.2b49098c.css">
<link rel="preload" href="/assets/js/runtime~main.c68e83c7.js" as="script">
<link rel="preload" href="/assets/js/main.fe7f9fd2.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div><a href="#" class="skipToContent_OuoZ">Skip to main content</a></div><nav class="navbar navbar--fixed-top navbar--dark"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/logo.svg" alt="My Site Logo" class="themedImage_TMUO themedImage--light_4Vu1"><img src="/img/logo.svg" alt="My Site Logo" class="themedImage_TMUO themedImage--dark_uzRr"></div><b class="navbar__title">Aoki</b></a><a class="navbar__item navbar__link navbar__link--active" href="/docs/intro">ç¬”è®°</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/aokikoko" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link"><span>GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_wgqa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a><div class="toggle_iYfV toggle_2i4l toggleDisabled_xj38"><div class="toggleTrack_t-f2" role="button" tabindex="-1"><div class="toggleTrackCheck_mk7D"><span class="toggleIcon_pHJ9">ğŸŒœ</span></div><div class="toggleTrackX_dm8H"><span class="toggleIcon_pHJ9">ğŸŒ</span></div><div class="toggleTrackThumb_W6To"></div></div><input type="checkbox" class="toggleScreenReader_h9qa" aria-label="Switch between dark and light mode"></div><div class="searchBox_Utm0"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper docs-wrapper docs-doc-page"><div class="docPage_lDyR"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_i9tI" type="button"></button><aside class="docSidebarContainer_0YBq"><div class="sidebar_a3j0"><nav class="menu thin-scrollbar menu_cyFh"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/intro">æˆ‘çš„çŸ¥è¯†åº“ ğŸ˜€</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_TwRn" href="/docs/CSS/transition-animation-transform">CSS</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_TwRn" href="/docs/DocusaurusTips/code-theme">Docusaurusä½¿ç”¨æŠ€å·§</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_TwRn" href="/docs/TypeScript/basic-types">TypeScript</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_TwRn" href="/docs/Cli/ESLint">Cli</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active hasHref_TwRn" href="/docs/DevOps/prometheus">DevOps</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/docs/DevOps/prometheus">[DevOps] æ™®ç½—ç±³ä¿®æ–¯</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/DevOps/daima">[DevOps] ä»£ç æ›´æ–°æ–¹æ³•</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/DevOps/jenkins">[DevOps] jenkins</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/DevOps/paas">[DevOps] å®¹å™¨-è™šæ‹ŸåŒ–</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/DevOps/docker1">[DevOps] å®¹å™¨æŠ€æœ¯ç®¡ç†å·¥å…·-Docker(ä¸Š)</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/DevOps/docker2">[DevOps] å®¹å™¨æŠ€æœ¯ç®¡ç†å·¥å…·-Docker(ä¸­)</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/DevOps/docker3">[DevOps] å®¹å™¨æŠ€æœ¯ç®¡ç†å·¥å…·-Docker(ä¸‹)</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/DevOps/dockercompose">[DevOps] å®¹å™¨ç¼–æ’-docker compose</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/DevOps/autopublish">[DevOps] ä»£ç è‡ªåŠ¨å‘å¸ƒç³»ç»Ÿ</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/DevOps/18">[DevOps] Dockerä¸‰å‰‘å®¢</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/DevOps/kubernetes">[DevOps] kubernetes</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_TwRn" href="/docs/Http/OptionsRequest">Http</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_TwRn" href="/docs/Linux/basic">Linux</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_TwRn" href="/docs/Mysql/case">Mysql</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_TwRn" href="/docs/Nginx/sign">Nginx</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_TwRn" href="/docs/Node.js/buffer">Node.js</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_TwRn" href="/docs/React/jsx">React</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_TwRn" href="/docs/interview/http">interview</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_TwRn" href="/docs/javascript/ecma">javascript</a></div></li></ul></nav><button type="button" title="Collapse sidebar" aria-label="Collapse sidebar" class="button button--secondary button--outline collapseSidebarButton_eoK2"><svg width="20" height="20" aria-hidden="true" class="collapseSidebarButtonIcon_e+kA"><g fill="#7a7a7a"><path d="M9.992 10.023c0 .2-.062.399-.172.547l-4.996 7.492a.982.982 0 01-.828.454H1c-.55 0-1-.453-1-1 0-.2.059-.403.168-.551l4.629-6.942L.168 3.078A.939.939 0 010 2.528c0-.548.45-.997 1-.997h2.996c.352 0 .649.18.828.45L9.82 9.472c.11.148.172.347.172.55zm0 0"></path><path d="M19.98 10.023c0 .2-.058.399-.168.547l-4.996 7.492a.987.987 0 01-.828.454h-3c-.547 0-.996-.453-.996-1 0-.2.059-.403.168-.551l4.625-6.942-4.625-6.945a.939.939 0 01-.168-.55 1 1 0 01.996-.997h3c.348 0 .649.18.828.45l4.996 7.492c.11.148.168.347.168.55zm0 0"></path></g></svg></button></div></aside><main class="docMainContainer_r8cw"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_zHA2"><div class="docItemContainer_oiyr"><article><div class="tocCollapsible_aw-L theme-doc-toc-mobile tocMobile_Tx6Y"><button type="button" class="clean-btn tocCollapsibleButton_zr6a">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>[DevOps] æ™®ç½—ç±³ä¿®æ–¯</h1></header><h2 class="anchor anchorWithStickyNavbar_y2LR" id="æ™®ç½—ç±³ä¿®æ–¯">æ™®ç½—ç±³ä¿®æ–¯<a class="hash-link" href="#æ™®ç½—ç±³ä¿®æ–¯" title="Direct link to heading">â€‹</a></h2><p>Prometheus(ç”± go è¯­è¨€(golang)å¼€å‘)æ˜¯ä¸€å¥—å¼€æºçš„ç›‘æ§&amp;æŠ¥è­¦&amp;<code>æ—¶é—´åºåˆ—æ•°æ®åº“</code>çš„ç»„åˆã€‚é€‚åˆç›‘æ§å®¹å™¨å¹³å°ã€‚å› ä¸º kubernetes(ä¿—ç§° k8s)çš„æµè¡Œå¸¦åŠ¨äº† prometheus çš„å‘å±•ã€‚</p><p><a href="https://prometheus.io/docs/introduction/overview/" target="_blank" rel="noopener noreferrer">https://prometheus.io/docs/introduction/overview/</a></p><p>æ•°æ®åº“åˆ†ç±»:</p><ul><li>å…³ç³»å‹ mysql,oracle,sql server,sybase,db2,access ç­‰</li><li>éå…³ç³»å‹(nosql)<ul><li>key-value memcache redis etcd</li><li>æ–‡æ¡£å‹ mongodb elasticsearch</li><li>åˆ—å¼ hbase</li><li>æ—¶åº prometheus</li><li>å›¾å½¢æ•°æ®åº“</li></ul></li></ul><p><strong>æ—¶é—´åºåˆ—æ•°æ®</strong>(TimeSeries Data) : æŒ‰ç…§æ—¶é—´é¡ºåºè®°å½•ç³»ç»Ÿã€è®¾å¤‡çŠ¶æ€å˜åŒ–çš„æ•°æ®è¢«ç§°ä¸ºæ—¶åºæ•°æ®.</p><p>åº”ç”¨çš„åœºæ™¯å¾ˆå¤š, å¦‚:</p><ul><li>æ— äººé©¾é©¶è½¦è¾†è¿è¡Œä¸­è¦è®°å½•çš„ç»åº¦ï¼Œçº¬åº¦ï¼Œé€Ÿåº¦ï¼Œæ–¹å‘ï¼Œæ—è¾¹ç‰©ä½“çš„è·ç¦»ç­‰ç­‰ã€‚æ¯æ—¶æ¯åˆ»éƒ½è¦å°†æ•°æ®è®°å½•ä¸‹æ¥åšåˆ†æã€‚</li><li>æŸä¸€ä¸ªåœ°åŒºçš„å„è½¦è¾†çš„è¡Œé©¶è½¨è¿¹æ•°æ®</li><li>ä¼ ç»Ÿè¯åˆ¸è¡Œä¸šå®æ—¶äº¤æ˜“æ•°æ®</li><li>å®æ—¶è¿ç»´ç›‘æ§æ•°æ®ç­‰</li></ul><p>æ—¶é—´åºåˆ—æ•°æ®åº“çš„ä¸»è¦ä¼˜ç‚¹:</p><ul><li>æ€§èƒ½å¥½</li></ul><p>å…³ç³»å‹æ•°æ®åº“å¯¹äºå¤§è§„æ¨¡æ•°æ®çš„å¤„ç†æ€§èƒ½ç³Ÿç³•ã€‚NOSQL å¯ä»¥æ¯”è¾ƒå¥½çš„å¤„ç†å¤§è§„æ¨¡æ•°æ®ï¼Œè®©ä¾ç„¶æ¯”ä¸ä¸Šæ—¶é—´åºåˆ—æ•°æ®åº“ã€‚</p><ul><li>å­˜å‚¨æˆæœ¬ä½</li></ul><p>é«˜æ•ˆçš„å‹ç¼©ç®—æ³•ï¼ŒèŠ‚çœå­˜å‚¨ç©ºé—´ï¼Œæœ‰æ•ˆé™ä½ IO</p><p>Prometheus æœ‰ç€éå¸¸é«˜æ•ˆçš„æ—¶é—´åºåˆ—æ•°æ®å­˜å‚¨æ–¹æ³•ï¼Œæ¯ä¸ªé‡‡æ ·æ•°æ®ä»…ä»…å ç”¨ 3.5byte å·¦å³ç©ºé—´ï¼Œä¸Šç™¾ä¸‡æ¡æ—¶é—´åºåˆ—ï¼Œ30 ç§’é—´éš”ï¼Œä¿ç•™ 60 å¤©ï¼Œå¤§æ¦‚èŠ±äº† 200 å¤š Gï¼ˆæ¥è‡ªå®˜æ–¹æ•°æ®)</p><p>Prometheus çš„ä¸»è¦ç‰¹å¾æœ‰:</p><ol><li><p>å¤šç»´åº¦æ•°æ®æ¨¡å‹</p></li><li><p>çµæ´»çš„æŸ¥è¯¢è¯­è¨€</p></li><li><p>ä¸ä¾èµ–åˆ†å¸ƒå¼å­˜å‚¨ï¼Œå•ä¸ªæœåŠ¡å™¨èŠ‚ç‚¹æ˜¯è‡ªä¸»çš„</p></li><li><p>ä»¥ HTTP æ–¹å¼ï¼Œé€šè¿‡ pull æ¨¡å‹æ‹‰å»æ—¶é—´åºåˆ—æ•°æ®</p></li><li><p>ä¹Ÿå¯ä»¥é€šè¿‡ä¸­é—´ç½‘å…³æ”¯æŒ push æ¨¡å‹</p></li><li><p>é€šè¿‡æœåŠ¡å‘ç°æˆ–è€…é™æ€é…ç½®, æ¥å‘ç°ç›®æ ‡æœåŠ¡å¯¹è±¡</p></li><li><p>æ”¯æŒå¤šç§å¤šæ ·çš„å›¾è¡¨å’Œç•Œé¢å±•ç¤º</p></li></ol><h2 class="anchor anchorWithStickyNavbar_y2LR" id="æ™®ç½—ç±³ä¿®æ–¯åŸç†æ¶æ„å›¾">æ™®ç½—ç±³ä¿®æ–¯åŸç†æ¶æ„å›¾<a class="hash-link" href="#æ™®ç½—ç±³ä¿®æ–¯åŸç†æ¶æ„å›¾" title="Direct link to heading">â€‹</a></h2><p><img alt="1543678972185" src="/assets/images/prometheus-9d584a57779ab9a2edf96c72b26ffecb.png"></p><h2 class="anchor anchorWithStickyNavbar_y2LR" id="å®éªŒç¯å¢ƒå‡†å¤‡">å®éªŒç¯å¢ƒå‡†å¤‡<a class="hash-link" href="#å®éªŒç¯å¢ƒå‡†å¤‡" title="Direct link to heading">â€‹</a></h2><p><img alt="1543308185732" src="/assets/images/shiyan-07190ff280350dfbb2329cf7d98678a1.png"></p><ol><li><p>é™æ€ ip(è¦æ±‚èƒ½ä¸Šå¤–ç½‘)</p></li><li><p>ä¸»æœºå</p></li></ol><div class="codeBlockContainer_J+bg language-powershell theme-code-block"><div class="codeBlockContent_csEI powershell"><pre tabindex="0" class="prism-code language-powershell codeBlock_rtdJ thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#F8F8F2"><span class="token plain">å„è‡ªé…ç½®å¥½ä¸»æœºå</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"># hostnamectl set-hostname --static server.cluster.com</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">ä¸‰å°éƒ½äº’ç›¸ç»‘å®šIPä¸ä¸»æœºå</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"># vim /etc/hosts</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">10.1.1.13  server.cluster.com</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">10.1.1.14  agent1.cluster.com</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">10.1.1.15  grafana.cluster.com</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><ol start="3"><li><strong>==æ—¶é—´åŒæ­¥==</strong>(æ—¶é—´åŒæ­¥ä¸€å®šè¦ç¡®è®¤ä¸€ä¸‹)</li></ol><div class="codeBlockContainer_J+bg language-powershell theme-code-block"><div class="codeBlockContent_csEI powershell"><pre tabindex="0" class="prism-code language-powershell codeBlock_rtdJ thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#F8F8F2"><span class="token plain"># systemctl restart ntpd</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"># systemctl enable ntpd</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><ol start="4"><li>å…³é—­é˜²ç«å¢™,selinux</li></ol><div class="codeBlockContainer_J+bg language-powershell theme-code-block"><div class="codeBlockContent_csEI powershell"><pre tabindex="0" class="prism-code language-powershell codeBlock_rtdJ thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#F8F8F2"><span class="token plain"># systemctl stop firewalld</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"># systemctl disable firewalld</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"># iptables -F</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><h2 class="anchor anchorWithStickyNavbar_y2LR" id="å®‰è£…-prometheus">å®‰è£… prometheus<a class="hash-link" href="#å®‰è£…-prometheus" title="Direct link to heading">â€‹</a></h2><p>ä» <a href="https://prometheus.io/download/" target="_blank" rel="noopener noreferrer">https://prometheus.io/download/</a> ä¸‹è½½ç›¸åº”ç‰ˆæœ¬ï¼Œå®‰è£…åˆ°æœåŠ¡å™¨ä¸Š</p><p>å®˜ç½‘æä¾›çš„æ˜¯äºŒè¿›åˆ¶ç‰ˆï¼Œè§£å‹å°±èƒ½ç”¨ï¼Œä¸éœ€è¦ç¼–è¯‘</p><div class="codeBlockContainer_J+bg language-powershell theme-code-block"><div class="codeBlockContent_csEI powershell"><pre tabindex="0" class="prism-code language-powershell codeBlock_rtdJ thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#F8F8F2"><span class="token plain">[root@server ~]# tar xf prometheus-2.5.0.linux-amd64.tar.gz -C /usr/local/</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">[root@server ~]# mv /usr/local/prometheus-2.5.0.linux-amd64/ /usr/local/prometheus</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">ç›´æ¥ä½¿ç”¨é»˜è®¤é…ç½®æ–‡ä»¶å¯åŠ¨</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">[root@server ~]# /usr/local/prometheus/prometheus --config.file=&quot;/usr/local/prometheus/prometheus.yml&quot; &amp;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">ç¡®è®¤ç«¯å£(9090)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">[root@server ~]# lsof -i:9090</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><h2 class="anchor anchorWithStickyNavbar_y2LR" id="prometheus-ç•Œé¢">prometheus ç•Œé¢<a class="hash-link" href="#prometheus-ç•Œé¢" title="Direct link to heading">â€‹</a></h2><p>é€šè¿‡æµè§ˆå™¨è®¿é—®<strong>http://æœåŠ¡å™¨ IP:9090</strong>å°±å¯ä»¥è®¿é—®åˆ° prometheus çš„ä¸»ç•Œé¢</p><p><img alt="1543244447650" src="/assets/images/ä¸»ç•Œé¢-58e062f3cedab03efe08e1b2fd59424a.png"></p><p>é»˜è®¤åªç›‘æ§äº†æœ¬æœºä¸€å°ï¼Œç‚¹ Status --ã€‹ç‚¹ Targets --ã€‹å¯ä»¥çœ‹åˆ°åªç›‘æ§äº†æœ¬æœº</p><p><img alt="1543246024896" src="/assets/images/ç›‘æ§çš„ç›®æ ‡-e9a872ceccfceb4b7f9d3c65b8af136a.png"></p><p>é€šè¿‡<strong>http://æœåŠ¡å™¨ IP:9090/metrics</strong>å¯ä»¥æŸ¥çœ‹åˆ°ç›‘æ§çš„æ•°æ®</p><p><img alt="1543246609467" src="/assets/images/ç›‘æ§é¡¹æ•°æ®-859385e76aa8974c819ef79d694ec2e1.png"></p><p>åœ¨ web ä¸»ç•Œé¢å¯ä»¥é€šè¿‡å…³é”®å­—æŸ¥è¯¢ç›‘æ§é¡¹</p><p><img alt="1543246563254" src="/assets/images/é€šè¿‡è¡¨è¾¾å¼æŸ¥è¯¢-71b2898c0014df591ca7d3b15293b87a.png"></p><h2 class="anchor anchorWithStickyNavbar_y2LR" id="ç›‘æ§è¿œç¨‹-linux-ä¸»æœº">ç›‘æ§è¿œç¨‹ linux ä¸»æœº<a class="hash-link" href="#ç›‘æ§è¿œç¨‹-linux-ä¸»æœº" title="Direct link to heading">â€‹</a></h2><p>1, åœ¨è¿œç¨‹ linux ä¸»æœº(è¢«ç›‘æ§ç«¯ agent1)ä¸Šå®‰è£… node_exporter ç»„ä»¶</p><p>ä¸‹è½½åœ°å€: <a href="https://prometheus.io/download/" target="_blank" rel="noopener noreferrer">https://prometheus.io/download/</a></p><div class="codeBlockContainer_J+bg language-powershell theme-code-block"><div class="codeBlockContent_csEI powershell"><pre tabindex="0" class="prism-code language-powershell codeBlock_rtdJ thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#F8F8F2"><span class="token plain">[root@agent1 ~]# tar xf node_exporter-0.16.0.linux-amd64.tar.gz -C /usr/local/</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">[root@agent1 ~]# mv /usr/local/node_exporter-0.16.0.linux-amd64/ /usr/local/node_exporter</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">é‡Œé¢å°±ä¸€ä¸ªå¯åŠ¨å‘½ä»¤node_exporter,å¯ä»¥ç›´æ¥ä½¿ç”¨æ­¤å‘½ä»¤å¯åŠ¨</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">[root@agent1 ~]# ls /usr/local/node_exporter/</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">LICENSE  node_exporter  NOTICE</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">[root@agent1 ~]# nohup /usr/local/node_exporter/node_exporter &amp;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">ç¡®è®¤ç«¯å£(9100)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">[root@agent1 ~]# lsof -i:9100</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>æ‰©å±•: <strong>==nohup==</strong>å‘½ä»¤: å¦‚æœæŠŠå¯åŠ¨ node_exporter çš„ç»ˆç«¯ç»™å…³é—­,é‚£ä¹ˆè¿›ç¨‹ä¹Ÿä¼šéšä¹‹å…³é—­ã€‚nohup å‘½ä»¤ä¼šå¸®ä½ è§£å†³è¿™ä¸ªé—®é¢˜ã€‚</p><p>2, é€šè¿‡æµè§ˆå™¨è®¿é—®<strong>http://è¢«ç›‘æ§ç«¯ IP:9100/metrics</strong>å°±å¯ä»¥æŸ¥çœ‹åˆ° node_exporter åœ¨è¢«ç›‘æ§ç«¯æ”¶é›†çš„ç›‘æ§ä¿¡æ¯</p><p><img alt="1543286036926" src="/assets/images/è¢«ç›‘æ§ç«¯ç›‘æ§é¡¹æ•°æ®-eba66a665a71d38a616cc4b8c5d3cbad.png"></p><p>3, å›åˆ° prometheus æœåŠ¡å™¨çš„é…ç½®æ–‡ä»¶é‡Œæ·»åŠ è¢«ç›‘æ§æœºå™¨çš„é…ç½®æ®µ</p><div class="codeBlockContainer_J+bg language-powershell theme-code-block"><div class="codeBlockContent_csEI powershell"><pre tabindex="0" class="prism-code language-powershell codeBlock_rtdJ thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#F8F8F2"><span class="token plain">åœ¨ä¸»é…ç½®æ–‡ä»¶æœ€ååŠ ä¸Šä¸‹é¢ä¸‰è¡Œ</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">[root@server ~]# vim /usr/local/prometheus/prometheus.yml</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> - job_name: &#x27;agent1&#x27;                   # å–ä¸€ä¸ªjobåç§°æ¥ä»£è¡¨è¢«ç›‘æ§çš„æœºå™¨</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">   static_configs:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">   - targets: [&#x27;10.1.1.14:9100&#x27;]        # è¿™é‡Œæ”¹æˆè¢«ç›‘æ§æœºå™¨çš„IPï¼Œåé¢ç«¯å£æ¥9100</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">æ”¹å®Œé…ç½®æ–‡ä»¶å,é‡å¯æœåŠ¡</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">[root@server ~]# pkill prometheus</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">[root@server ~]# lsof -i:9090           # ç¡®è®¤ç«¯å£æ²¡æœ‰è¿›ç¨‹å ç”¨</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">[root@server ~]# /usr/local/prometheus/prometheus --config.file=&quot;/usr/local/prometheus/prometheus.yml&quot; &amp;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">[root@server ~]# lsof -i:9090           # ç¡®è®¤ç«¯å£è¢«å ç”¨ï¼Œè¯´æ˜é‡å¯æˆåŠŸ</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>4ï¼Œå›åˆ° web ç®¡ç†ç•Œé¢ --ã€‹ç‚¹ Status --ã€‹ç‚¹ Targets --ã€‹å¯ä»¥çœ‹åˆ°å¤šäº†ä¸€å°ç›‘æ§ç›®æ ‡</p><p><img alt="1548299595073" src="/assets/images/æŸ¥çœ‹è¢«ç›‘æ§ç«¯æ˜¯å¦è¢«æˆåŠŸç›‘æ§-f7d9324aabbf3b7e0613e40ad10365b8.png"></p><p>ç»ƒä¹ : åŠ ä¸Šæœ¬æœº prometheus çš„ç›‘æ§</p><p>ç­”: åœ¨æœ¬æœºå®‰è£… node_exporterï¼Œä¹Ÿä½¿ç”¨ä¸Šé¢çš„æ–¹å¼ç›‘æ§èµ·æ¥ã€‚</p><h2 class="anchor anchorWithStickyNavbar_y2LR" id="ç›‘æ§è¿œç¨‹-mysql">ç›‘æ§è¿œç¨‹ mysql<a class="hash-link" href="#ç›‘æ§è¿œç¨‹-mysql" title="Direct link to heading">â€‹</a></h2><p>1,åœ¨è¢«ç®¡ç†æœº agent1 ä¸Šå®‰è£… mysqld_exporter ç»„ä»¶</p><p>ä¸‹è½½åœ°å€: <a href="https://prometheus.io/download/" target="_blank" rel="noopener noreferrer">https://prometheus.io/download/</a></p><div class="codeBlockContainer_J+bg language-powershell theme-code-block"><div class="codeBlockContent_csEI powershell"><pre tabindex="0" class="prism-code language-powershell codeBlock_rtdJ thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#F8F8F2"><span class="token plain">å®‰è£…mysqld_exporterç»„ä»¶</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">[root@agent1 ~]# tar xf mysqld_exporter-0.11.0.linux-amd64.tar.gz -C /usr/local/</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">[root@agent1 ~]# mv /usr/local/mysqld_exporter-0.11.0.linux-amd64/ /usr/local/mysqld_exporter</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">[root@agent1 ~]# ls /usr/local/mysqld_exporter/</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">LICENSE  mysqld_exporter  NOTICE</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">å®‰è£…mariadbæ•°æ®åº“,å¹¶æˆæƒ</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">[root@agent1 ~]# yum install mariadb-server -y</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">[root@agent1 ~]# systemctl restart mariadb</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">[root@agent1 ~]# systemctl enable mariadb</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">[root@agent1 ~]# mysql</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">MariaDB [(none)]&gt; grant select,replication client,process ON *.* to &#x27;mysql_monitor&#x27;@&#x27;localhost&#x27; identified by &#x27;123&#x27;;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">(æ³¨æ„:æˆæƒipä¸ºlocalhostï¼Œå› ä¸ºä¸æ˜¯prometheusæœåŠ¡å™¨æ¥ç›´æ¥æ‰¾mariadbè·å–æ•°æ®ï¼Œè€Œæ˜¯prometheusæœåŠ¡å™¨æ‰¾mysql_exporter,mysql_exporterå†æ‰¾mariadbã€‚æ‰€ä»¥è¿™ä¸ªlocalhostæ˜¯æŒ‡çš„mysql_exporterçš„IP)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">MariaDB [(none)]&gt; flush privileges;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">MariaDB [(none)]&gt; quit</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">åˆ›å»ºä¸€ä¸ªmariadbé…ç½®æ–‡ä»¶ï¼Œå†™ä¸Šè¿æ¥çš„ç”¨æˆ·åä¸å¯†ç (å’Œä¸Šé¢çš„æˆæƒçš„ç”¨æˆ·åå’Œå¯†ç è¦å¯¹åº”)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">[root@agent1 ~]# vim /usr/local/mysqld_exporter/.my.cnf</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">[client]</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">user=mysql_monitor</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">password=123</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">å¯åŠ¨mysqld_exporter</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">[root@agent1 ~]# nohup /usr/local/mysqld_exporter/mysqld_exporter --config.my-cnf=/usr/local/mysqld_exporter/.my.cnf &amp;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">ç¡®è®¤ç«¯å£(9104)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">[root@agent1 ~]# lsof -i:9104</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>2, å›åˆ° prometheus æœåŠ¡å™¨çš„é…ç½®æ–‡ä»¶é‡Œæ·»åŠ è¢«ç›‘æ§çš„ mariadb çš„é…ç½®æ®µ</p><div class="codeBlockContainer_J+bg language-powershell theme-code-block"><div class="codeBlockContent_csEI powershell"><pre tabindex="0" class="prism-code language-powershell codeBlock_rtdJ thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#F8F8F2"><span class="token plain">åœ¨ä¸»é…ç½®æ–‡ä»¶æœ€åå†åŠ ä¸Šä¸‹é¢ä¸‰è¡Œ</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">[root@server ~]# vim /usr/local/prometheus/prometheus.yml</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> - job_name: &#x27;agent1_mariadb&#x27;                   # å–ä¸€ä¸ªjobåç§°æ¥ä»£è¡¨è¢«ç›‘æ§çš„mariadb</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">   static_configs:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">   - targets: [&#x27;10.1.1.14:9104&#x27;]                # è¿™é‡Œæ”¹æˆè¢«ç›‘æ§æœºå™¨çš„IPï¼Œåé¢ç«¯å£æ¥9104</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">æ”¹å®Œé…ç½®æ–‡ä»¶å,é‡å¯æœåŠ¡</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">[root@server ~]# pkill prometheus</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">[root@server ~]# lsof -i:9090</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">[root@server ~]# /usr/local/prometheus/prometheus --config.file=&quot;/usr/local/prometheus/prometheus.yml&quot; &amp;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">[root@server ~]# lsof -i:9090</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>3, å›åˆ° web ç®¡ç†ç•Œé¢ --ã€‹ç‚¹ Status --ã€‹ç‚¹ Targets --ã€‹å¯ä»¥çœ‹åˆ°ç›‘æ§ mariadb äº†</p><p><img alt="1543302909128" src="/assets/images/ç›‘æ§mysql-12d234b57b5582eaf085d9f75ab8fa82.png"></p><p><img alt="1543721788379" src="/assets/images/ç›‘æ§mysql2-c81c2c9f665bb46544b3b08e8341208d.png"></p><header><h1>grafana</h1></header><h2 class="anchor anchorWithStickyNavbar_y2LR" id="ä½¿ç”¨-grafana-è¿æ¥-prometheus">ä½¿ç”¨ grafana è¿æ¥ prometheus<a class="hash-link" href="#ä½¿ç”¨-grafana-è¿æ¥-prometheus" title="Direct link to heading">â€‹</a></h2><p>Grafana æ˜¯ä¸€ä¸ªå¼€æºçš„åº¦é‡åˆ†æå’Œå¯è§†åŒ–å·¥å…·ï¼Œå¯ä»¥é€šè¿‡å°†é‡‡é›†çš„æ•°æ®åˆ†æï¼ŒæŸ¥è¯¢ï¼Œç„¶åè¿›è¡Œå¯è§†åŒ–çš„å±•ç¤º,å¹¶èƒ½å®ç°æŠ¥è­¦ã€‚</p><p><img alt="1548343346370" src="/assets/images/grafanaå®˜ç½‘ä»‹ç»-bc28ce6fb79243d3c13df61985647c91.png"></p><p>ç½‘å€: <a href="https://grafana.com/" target="_blank" rel="noopener noreferrer">https://grafana.com/</a></p><p>1, åœ¨ grafana æœåŠ¡å™¨ä¸Šå®‰è£… grafana</p><p>ä¸‹è½½åœ°å€:<a href="https://grafana.com/grafana/download" target="_blank" rel="noopener noreferrer">https://grafana.com/grafana/download</a></p><div class="codeBlockContainer_J+bg language-powershell theme-code-block"><div class="codeBlockContent_csEI powershell"><pre tabindex="0" class="prism-code language-powershell codeBlock_rtdJ thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#F8F8F2"><span class="token plain">æˆ‘è¿™é‡Œé€‰æ‹©çš„rpmåŒ…ï¼Œä¸‹è½½åç›´æ¥rpm -ivhå®‰è£…å°±OK</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">[root@grafana ~]# rpm -ivh /root/Desktop/grafana-5.3.4-1.x86_64.rpm</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">å¯åŠ¨æœåŠ¡</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">[root@grafana ~]# systemctl start grafana-server</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">[root@grafana ~]# systemctl enable grafana-server</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">ç¡®è®¤ç«¯å£(3000)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">[root@grafana ~]# lsof -i:3000</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>2, é€šè¿‡æµè§ˆå™¨è®¿é—® <strong>http:// grafana æœåŠ¡å™¨ IP:3000</strong>å°±åˆ°äº†ç™»å½•ç•Œé¢,ä½¿ç”¨é»˜è®¤çš„ admin ç”¨æˆ·,admin å¯†ç å°±å¯ä»¥ç™»é™†äº†</p><p><img alt="1543295339031" src="/assets/images/grafanaç™»é™†ç•Œé¢-c7870d4421d035f343407b9954b4a85a.png"></p><p>3, ä¸‹é¢æˆ‘ä»¬æŠŠ prometheus æœåŠ¡å™¨æ”¶é›†çš„æ•°æ®åšä¸ºä¸€ä¸ªæ•°æ®æºæ·»åŠ åˆ° grafana,è®© grafana å¯ä»¥å¾—åˆ° prometheus çš„æ•°æ®ã€‚</p><p><img alt="1543295892083" src="/assets/images/å¢åŠ æ•°æ®æº-2489dec0c0b31a67612eda5234110ecd.png"></p><p><img alt="1543296759433" src="/assets/images/å¢åŠ æ•°æ®æº2-f2db0645a380444d59bf59bb49737da0.png"></p><p><img alt="1543296887234" src="/assets/images/å¢åŠ æ•°æ®æº3-6fe4a15f33fb60f7517220e408385b81.png"></p><p><img alt="1543297041403" src="/assets/images/å¢åŠ æ•°æ®æº4-fd2fb506a7d5c5d75e21d93850233c31.png"></p><p>4, ç„¶åä¸ºæ·»åŠ å¥½çš„æ•°æ®æºåšå›¾å½¢æ˜¾ç¤º</p><p><img alt="1543298016041" src="/assets/images/åˆ›å»ºå›¾å½¢1-82307ecd103973c037947f209b1c656a.png"></p><p><img alt="1543732976557" src="/assets/images/åˆ›å»ºå›¾å½¢1-2-02ef5371c3968cf708cdcb73f5c27eb9.png"></p><p><img alt="1548317067216" src="/assets/images/åˆ›å»ºå›¾å½¢1-3-fe14cb75c2da7f25d71128ff59cf7acb.png"></p><p><img alt="1548317384440" src="/assets/images/åˆ›å»ºå›¾å½¢2-dae44537f0eed5fb8bdd36a5f314203e.png"></p><p>5, ä¿å­˜</p><p><img alt="1543298733368" src="/assets/images/åˆ›å»ºå›¾å½¢4-8744fd87a8c588b9b0765930d9ec9455.png"></p><p>6ï¼Œæœ€ååœ¨ dashboard å¯ä»¥æŸ¥çœ‹åˆ°</p><p><img alt="1548317584841" src="/assets/images/å¢åŠ æ•°æ®æº5-1471368fdfddb223b6aa75c8edb5b154.png"></p><p><strong>åŒ¹é…æ¡ä»¶æ˜¾ç¤º</strong></p><p><img alt="1548315785229" src="/assets/images/åŒ¹é…æ¡ä»¶æ˜¾ç¤º-a3e216594fd194a7298dfb5a19314572.png"></p><p><img alt="1548315880685" src="/assets/images/åŒ¹é…æ¡ä»¶æ˜¾ç¤º2-e5956e8044063369925aeeaa7957add7.png"></p><h2 class="anchor anchorWithStickyNavbar_y2LR" id="grafana-å›¾å½¢æ˜¾ç¤º-mysql-ç›‘æ§æ•°æ®">grafana å›¾å½¢æ˜¾ç¤º mysql ç›‘æ§æ•°æ®<a class="hash-link" href="#grafana-å›¾å½¢æ˜¾ç¤º-mysql-ç›‘æ§æ•°æ®" title="Direct link to heading">â€‹</a></h2><p>æ ¹æ®ä¸Šé¢çš„æ€è·¯ï¼Œæˆ‘ä»¬å¯ä»¥å°†<code>mysql_global_status_threads_connected</code>è¿™ä¸ª metrics åŠ åˆ° dashboard å®ç°å¯¹ mysql æ•°æ®åº“çš„å½“å‰è¿æ¥æ•°çš„ç›‘æ§ã€‚</p><p>ä½†æ˜¯ mysql éœ€è¦ç›‘æ§çš„çŠ¶æ€éå¸¸çš„å¤š(<code>mysql&gt; show status</code>å¾—åˆ°çš„çŠ¶æ€ä¿¡æ¯å‡ ä¹éƒ½å¯ä»¥ç›‘æ§)ï¼Œä¸€ä¸ªä¸ªçš„æ‰‹åŠ¨æ·»åŠ å¤ªç´¯äº†ã€‚æœ‰æ²¡æœ‰ç±»ä¼¼ zabbix é‡Œçš„æ¨¡æ¿é‚£ç§æ¦‚å¿µå‘¢?</p><p>ç­”æ¡ˆæ˜¯æœ‰çš„,éœ€è¦å¼€å‘äººå‘˜å¼€å‘å‡ºç›¸åº”çš„ json æ ¼å¼çš„æ¨¡æ¿,ç„¶åå¯¼å…¥è¿›å»å°±å¯ä»¥äº†ã€‚é‚£ä¹ˆé—®é¢˜æ¥äº†,è°å¼€å‘?</p><p>æœ‰è¿™ä¹ˆå‡ ç§é€”å¾„:</p><ul><li>å¦‚æœå…¬å¸æœ‰è¿™æ–¹é¢çš„ä¸“ä¸šå¼€å‘æ”¯æŒï¼Œå°±å¯ä»¥å®ç°å®šåˆ¶åŒ–çš„ç›‘æ§, è¿ç»´å·¥ç¨‹å¸ˆé…åˆå°±å¥½</li><li>å½“ç„¶è¿ç»´å·¥ç¨‹å¸ˆä¹Ÿå¯ä»¥å­¦ä¹ å¹¶å®ç°è¿™æ–¹é¢çš„å¼€å‘</li><li>å¯»æ‰¾åˆ«äººå¼€å‘å¥½çš„å¼€æºé¡¹ç›®</li></ul><p>grafana-dashboards å°±æ˜¯è¿™æ ·çš„å¼€æºé¡¹ç›®</p><p>å‚è€ƒç½‘å€: <a href="https://github.com/percona/grafana-dashboards" target="_blank" rel="noopener noreferrer">https://github.com/percona/grafana-dashboards</a></p><p>1, ä¸‹è½½ grafana-dashboards å¼€æºé¡¹ç›®</p><p><strong>ä¸‹è½½æ–¹æ³•:</strong></p><div class="codeBlockContainer_J+bg language-powershell theme-code-block"><div class="codeBlockContent_csEI powershell"><pre tabindex="0" class="prism-code language-powershell codeBlock_rtdJ thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#F8F8F2"><span class="token plain"># git clone https://github.com/percona/grafana-dashboards.git</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">å­¦ä¹ å®Œgitä¸githubç›¸å…³è¯¾ç¨‹åå°±æ˜ç™½äº†</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>å› ä¸º github ä¸‹è½½ç½‘é€Ÿéå¸¸æ…¢, æˆ‘è¿™é‡Œå·²ç»ä¸‹è½½å¥½äº†å…±äº«ç»™å¤§å®¶</p><p><img alt="1568622044299" src="/assets/images/grafana-dashboards-36465a7478a94a80348f799d19a63ed1.png"></p><p>2ï¼Œåœ¨ grafana å›¾å½¢ç•Œé¢å¯¼å…¥ç›¸å…³ json æ–‡ä»¶</p><p><img alt="1568622190725" src="/assets/images/å¯¼å…¥mysqlçš„jsonæ–‡ä»¶-95f77d7467b3ce296db0fdc1f286d0cc.png"></p><p><img alt="1568622320157" src="/assets/images/å¯¼å…¥mysqlçš„jsonæ–‡ä»¶2-18ee6b95d2d851fe6aa547d3f421ff01.png"></p><p>3,ç‚¹ import å¯¼å…¥å,æŠ¥ prometheus æ•°æ®æºæ‰¾ä¸åˆ°,å› ä¸ºè¿™äº› json æ–‡ä»¶é‡Œé»˜è®¤è¦æ‰¾çš„å°±æ˜¯å« Prometheus çš„æ•°æ®æºï¼Œä½†æˆ‘ä»¬å‰é¢å»ºç«‹çš„æ•°æ®æºå´æ˜¯å« prometheus_data</p><p>é‚£ä¹ˆè¯·è‡ªè¡ŒæŠŠåŸæ¥çš„ prometheus_data æºæ”¹åä¸º<strong>Prometheus</strong>å³å¯(æ³¨æ„:ç¬¬ä¸€ä¸ªå­—æ¯ P æ˜¯å¤§å†™)</p><p>ç„¶åå†å›å»åˆ·æ–°,å°±æœ‰æ•°æ®äº†(å¦‚ä¸‹å›¾æ‰€ç¤º)</p><p><img alt="1543307627738" src="/assets/images/æŸ¥çœ‹mysqlç›‘æ§ä¿¡æ¯-79cc7493121ffc7976bbeca5f9fd7e0c.png"></p><p>4,è¿‡æ®µæ—¶é—´å†çœ‹ï¼Œå°±ä¼šæœ‰æ•°æ®äº†(å¦‚ä¸‹å›¾æ‰€ç¤º)</p><p><img alt="1543313055411" src="/assets/images/æŸ¥çœ‹mysqlç›‘æ§ä¿¡æ¯2-54e65bee93bc050218b5cda2d22c4d05.png"></p><h2 class="anchor anchorWithStickyNavbar_y2LR" id="grafanaonealert-æŠ¥è­¦">grafana+onealert æŠ¥è­¦<a class="hash-link" href="#grafanaonealert-æŠ¥è­¦" title="Direct link to heading">â€‹</a></h2><p>prometheus æŠ¥è­¦éœ€è¦ä½¿ç”¨ alertmanager è¿™ä¸ªç»„ä»¶ï¼Œè€Œä¸”æŠ¥è­¦è§„åˆ™éœ€è¦æ‰‹åŠ¨ç¼–å†™(å¯¹è¿ç»´æ¥è¯´ä¸å‹å¥½)ã€‚æ‰€ä»¥æˆ‘è¿™é‡Œé€‰ç”¨ grafana+onealert æŠ¥è­¦ã€‚</p><p>æ³¨æ„: å®ç°æŠ¥è­¦å‰æŠŠæ‰€æœ‰æœºå™¨<strong>==æ—¶é—´åŒæ­¥==</strong>å†æ£€æŸ¥ä¸€é.</p><p>1,å…ˆåœ¨ onealert é‡Œæ·»åŠ  grafana åº”ç”¨(ç”³è¯· onealert è´¦å·åœ¨ zabbix å·²ç»è®²è¿‡)</p><p><img alt="1568623160170" src="/assets/images/onealert-ff20d909ead86b61fd5085493bd9ce2d.png"></p><p><img alt="1568623529894" src="/assets/images/onealertæ·»åŠ granfa-ad2aaa9eb5c410bda2ab01de46f6ec66.png"></p><p><img alt="1568623615096" src="/assets/images/onealertæ·»åŠ granfa2-48b1246ee9a599cab0540aee6a5946c2.png"></p><p>2, é…ç½®é€šçŸ¥ç­–ç•¥</p><p><img alt="1568623797665" src="/assets/images/onealerté…ç½®é€šçŸ¥ç­–ç•¥-8e706672bc5b2e6e5484392da3fcf49d.png"></p><p>3,åœ¨ grafana å¢åŠ é€šçŸ¥é€šé“</p><p><img alt="1568623670039" src="/assets/images/onealertæ·»åŠ granfa2-2-281fe3104c70e874be19f7b58eb4640e.png"></p><p><img alt="1543675738028" src="/assets/images/granfaæ·»åŠ é€šçŸ¥é€šé“-ba9727417e1fd53189b2dba1410cf95a.png"></p><p><img alt="1543676016170" src="/assets/images/granfaæ·»åŠ é€šçŸ¥é€šé“2-975f4e2100b953d47f7256834a393d9b.png"></p><p><img alt="1543676056834" src="/assets/images/granfaæ·»åŠ é€šçŸ¥é€šé“3-f6374fa1137505329233402975a7eda5.png"></p><p>4ï¼Œç°åœ¨å¯ä»¥å»è®¾ç½®ä¸€ä¸ªæŠ¥è­¦æ¥æµ‹è¯•äº†(è¿™é‡Œä»¥æˆ‘ä»¬å‰é¢åŠ çš„ cpu è´Ÿè½½ç›‘æ§æ¥åšæµ‹è¯•)</p><p><img alt="1543676704323" src="/assets/images/æŠ¥è­¦æµ‹è¯•-e412087a3fff941c15b3b2738a13c234.png"></p><p><img alt="1543676776304" src="/assets/images/æŠ¥è­¦æµ‹è¯•2-566366587150006609658f4661286564.png"></p><p><img alt="1543677077350" src="/assets/images/æŠ¥è­¦æµ‹è¯•3-78c303062ffad3ec529000d44d76a6da.png"></p><p><img alt="1543677287856" src="/assets/images/æŠ¥è­¦æµ‹è¯•4-acd4a8f7e57ca8863d6d414af413847f.png"></p><p>5ï¼Œä¿å­˜åå°±å¯ä»¥æµ‹è¯•äº†</p><p>å¦‚æœ agent1 ä¸Šçš„ cpu è´Ÿè½½è¿˜æ²¡æœ‰åˆ° 0.5ï¼Œä½ å¯ä»¥è¯•è¯• 0.1,æˆ–è€…è¿è¡Œä¸€äº›ç¨‹åºæŠŠ agent1 è´Ÿè½½è°ƒå¤§ã€‚æœ€ç»ˆèƒ½æµ‹è¯•æŠ¥è­¦æˆåŠŸã€‚</p><p><img alt="1543677915263" src="/assets/images/æŠ¥è­¦æµ‹è¯•5-5519074588f1e7c610d8c7331ad079d4.png"></p><p><strong>æœ€ç»ˆçš„é‚®ä»¶æŠ¥è­¦æ•ˆæœ</strong></p><p><img alt="1543678019297" src="/assets/images/æŠ¥è­¦æµ‹è¯•6-b179cc409aa65772fc58dffc5f42b679.png"></p><p><strong>æµ‹è¯• mysql é“¾æ¥æ•°æŠ¥è­¦</strong></p><p><img alt="1548321435039" src="/assets/images/mysqlé“¾æ¥æ•°æŠ¥è­¦0-523a5cfee0b84bddc81f3e5fb8fe53de.png"></p><p><img alt="1543741346238" src="/assets/images/mysqlé“¾æ¥æ•°æŠ¥è­¦1-8dace66d181a41dbb52f58465c47d7d0.png"></p><p><img alt="1548322466548" src="/assets/images/mysqlé“¾æ¥æ•°æŠ¥è­¦2-a8866a5167c0de4e2ef59d123a882a8f.png"></p><p><img alt="1548326398846" src="/assets/images/mysqlé“¾æ¥æ•°æŠ¥è­¦2-2-6c60928f8141f7f623ecdb2d079be4fb.png"></p><p><img alt="1548322567131" src="/assets/images/mysqlé“¾æ¥æ•°æŠ¥è­¦3-9f4843a717af431b3792420c8ba07c38.png"></p><h2 class="anchor anchorWithStickyNavbar_y2LR" id="æ€»ç»“æŠ¥è­¦ä¸æˆåŠŸçš„å¯èƒ½åŸå› ">æ€»ç»“æŠ¥è­¦ä¸æˆåŠŸçš„å¯èƒ½åŸå› <a class="hash-link" href="#æ€»ç»“æŠ¥è­¦ä¸æˆåŠŸçš„å¯èƒ½åŸå› " title="Direct link to heading">â€‹</a></h2><ul><li>å„æœåŠ¡å™¨ä¹‹é—´æ—¶é—´ä¸åŒæ­¥ï¼Œè¿™æ ·æ—¶åºæ•°æ®ä¼šå‡ºé—®é¢˜ï¼Œä¹Ÿä¼šé€ æˆæŠ¥è­¦å‡ºé—®é¢˜</li><li>å¿…é¡»å†™é€šçŸ¥å†…å®¹ï¼Œç•™ç©ºå†…å®¹æ˜¯ä¸ä¼šå‘æŠ¥è­¦çš„</li><li>ä¿®æ”¹å®ŒæŠ¥è­¦é…ç½®åï¼Œè®°å¾—è¦ç‚¹å³ä¸Šè§’çš„ä¿å­˜</li><li>ä¿å­˜é…ç½®åï¼Œéœ€è¦ç”± OK çŠ¶æ€å˜ä¸º alerting çŠ¶æ€æ‰ä¼šæŠ¥è­¦(ä¹Ÿå°±æ˜¯è¯´ï¼Œä½ é…ç½®ä¿å­˜åï¼Œå°±å·²ç»æ˜¯ alerting çŠ¶æ€æ˜¯ä¸ä¼šæŠ¥è­¦çš„)</li><li>grafana ä¸ onealert é€šä¿¡æœ‰é—®é¢˜</li></ul><header><h1>æ‰©å±•</h1></header><p>prometheus ç›®å‰è¿˜åœ¨å‘å±•ä¸­ï¼Œå¾ˆå¤šç›¸åº”çš„ç›‘æ§éƒ½éœ€è¦å¼€å‘ã€‚ä½†åœ¨å®˜ç½‘çš„ dashboard åº“ä¸­,ä¹Ÿæœ‰ä¸€äº›å®˜æ–¹å’Œç¤¾åŒºå¼€å‘äººå‘˜å¼€å‘çš„ dashboard å¯ä»¥ç›´æ¥æ‹¿æ¥ç”¨ã€‚</p><p>åœ°å€ä¸º: <a href="https://grafana.com/grafana/dashboards" target="_blank" rel="noopener noreferrer">https://grafana.com/grafana/dashboards</a></p><p><img alt="1548343742261" src="/assets/images/grafana-dashboardsä¸‹è½½-6b7d8d0af5fd7e38b7827922e072472c.png"></p><p><strong>ç¤ºä¾‹:</strong></p><p><img alt="1548335365112" src="/assets/images/ç›‘æ§dashboardå±•ç¤º-0e61576b7db74939f53dd9305a0606b3.png"></p><p><img alt="1548335440541" src="/assets/images/dashboardå±•ç¤º2-3b5a57d6c9f38e086bef12407ff5231a.png"></p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/aokikoko/aokikoko.github.io/blob/main/website/docs/DevOps/prometheus.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_mS5F" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_mt2f"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/docs/Cli/npm"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">[Cli] npmå‡çº§ç‰ˆæœ¬åä»ç„¶æ˜¾ç¤ºä¸ºåŸç‰ˆæœ¬</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/docs/DevOps/daima"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">[DevOps] ä»£ç æ›´æ–°æ–¹æ³•</div></a></div></nav></div></div><div class="col col--3"><div class="tableOfContents_vrFS thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#æ™®ç½—ç±³ä¿®æ–¯" class="table-of-contents__link toc-highlight">æ™®ç½—ç±³ä¿®æ–¯</a></li><li><a href="#æ™®ç½—ç±³ä¿®æ–¯åŸç†æ¶æ„å›¾" class="table-of-contents__link toc-highlight">æ™®ç½—ç±³ä¿®æ–¯åŸç†æ¶æ„å›¾</a></li><li><a href="#å®éªŒç¯å¢ƒå‡†å¤‡" class="table-of-contents__link toc-highlight">å®éªŒç¯å¢ƒå‡†å¤‡</a></li><li><a href="#å®‰è£…-prometheus" class="table-of-contents__link toc-highlight">å®‰è£… prometheus</a></li><li><a href="#prometheus-ç•Œé¢" class="table-of-contents__link toc-highlight">prometheus ç•Œé¢</a></li><li><a href="#ç›‘æ§è¿œç¨‹-linux-ä¸»æœº" class="table-of-contents__link toc-highlight">ç›‘æ§è¿œç¨‹ linux ä¸»æœº</a></li><li><a href="#ç›‘æ§è¿œç¨‹-mysql" class="table-of-contents__link toc-highlight">ç›‘æ§è¿œç¨‹ mysql</a></li><li><a href="#ä½¿ç”¨-grafana-è¿æ¥-prometheus" class="table-of-contents__link toc-highlight">ä½¿ç”¨ grafana è¿æ¥ prometheus</a></li><li><a href="#grafana-å›¾å½¢æ˜¾ç¤º-mysql-ç›‘æ§æ•°æ®" class="table-of-contents__link toc-highlight">grafana å›¾å½¢æ˜¾ç¤º mysql ç›‘æ§æ•°æ®</a></li><li><a href="#grafanaonealert-æŠ¥è­¦" class="table-of-contents__link toc-highlight">grafana+onealert æŠ¥è­¦</a></li><li><a href="#æ€»ç»“æŠ¥è­¦ä¸æˆåŠŸçš„å¯èƒ½åŸå› " class="table-of-contents__link toc-highlight">æ€»ç»“æŠ¥è­¦ä¸æˆåŠŸçš„å¯èƒ½åŸå› </a></li></ul></div></div></div></div></main></div></div></div>
<script src="/assets/js/runtime~main.c68e83c7.js"></script>
<script src="/assets/js/main.fe7f9fd2.js"></script>
</body>
</html>