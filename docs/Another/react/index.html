<!doctype html>
<html class="docs-version-current" lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.14">
<link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="Aoki 的自留地 RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="Aoki 的自留地 Atom Feed">
<link rel="search" type="application/opensearchdescription+xml" title="Aoki 的自留地" href="/opensearch.xml"><title data-react-helmet="true">[小题目] React | Aoki 的自留地</title><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" property="og:url" content="https://phero.live/docs/Another/react"><meta data-react-helmet="true" name="docsearch:language" content="en"><meta data-react-helmet="true" name="docsearch:version" content="current"><meta data-react-helmet="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-react-helmet="true" property="og:title" content="[小题目] React | Aoki 的自留地"><meta data-react-helmet="true" name="description" content="jsx 循环渲染列表"><meta data-react-helmet="true" property="og:description" content="jsx 循环渲染列表"><link data-react-helmet="true" rel="icon" href="/img/favicon.ico"><link data-react-helmet="true" rel="canonical" href="https://phero.live/docs/Another/react"><link data-react-helmet="true" rel="alternate" href="https://phero.live/docs/Another/react" hreflang="en"><link data-react-helmet="true" rel="alternate" href="https://phero.live/docs/Another/react" hreflang="x-default"><link data-react-helmet="true" rel="preconnect" href="https://BMRZNSN9O0-dsn.algolia.net" crossorigin="anonymous"><link rel="stylesheet" href="/assets/css/styles.23909136.css">
<link rel="preload" href="/assets/js/runtime~main.2e69c70d.js" as="script">
<link rel="preload" href="/assets/js/main.dd54a102.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div><a href="#" class="skipToContent_OuoZ">Skip to main content</a></div><nav class="navbar navbar--fixed-top navbar--dark"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/logo.svg" alt="My Site Logo" class="themedImage_TMUO themedImage--light_4Vu1"><img src="/img/logo.svg" alt="My Site Logo" class="themedImage_TMUO themedImage--dark_uzRr"></div><b class="navbar__title">Aoki</b></a><a class="navbar__item navbar__link navbar__link--active" href="/docs/intro">笔记</a><a class="navbar__item navbar__link" href="/blog">Blog</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/aokikoko" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link"><span>GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_wgqa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a><div class="toggle_iYfV toggle_2i4l toggleDisabled_xj38"><div class="toggleTrack_t-f2" role="button" tabindex="-1"><div class="toggleTrackCheck_mk7D"><span class="toggleIcon_pHJ9">🌜</span></div><div class="toggleTrackX_dm8H"><span class="toggleIcon_pHJ9">🌞</span></div><div class="toggleTrackThumb_W6To"></div></div><input type="checkbox" class="toggleScreenReader_h9qa" aria-label="Switch between dark and light mode"></div><div class="searchBox_Utm0"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper docs-wrapper docs-doc-page"><div class="docPage_lDyR"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_i9tI" type="button"></button><aside class="docSidebarContainer_0YBq"><div class="sidebar_a3j0"><nav class="menu thin-scrollbar menu_cyFh"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/intro">我的知识库 😀</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_TwRn" href="/docs/CSS/transition-animation-transform">CSS</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_TwRn" href="/docs/DocusaurusTips/code-theme">Docusaurus使用技巧</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_TwRn" href="/docs/TypeScript/basic-types">TypeScript</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active hasHref_TwRn" href="/docs/Another/bigo">算法小题目</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/Another/bigo">[小题目] 算法复杂度科普</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/Another/base">[小题目] 基础题</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/Another/node">[小题目] nodejs</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/Another/framework">[小题目] 框架</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/Another/design">[小题目] 设计项目</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/docs/Another/react">[小题目] React</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/Another/async">[小题目] async await</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/Another/promise">[小题目] promise</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/Another/webpack">[小题目] webpack</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/Another/js">[小题目] js</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_TwRn" href="/docs/architecture/history">架构</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_TwRn" href="/docs/Cli/ESLint">Cli</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_TwRn" href="/docs/DevOps/prometheus">DevOps</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_TwRn" href="/docs/Http/OptionsRequest">Http</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_TwRn" href="/docs/Java/basic">Java</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_TwRn" href="/docs/Linux/basic">Linux</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_TwRn" href="/docs/Mysql/case">Mysql</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_TwRn" href="/docs/Nginx/sign">Nginx</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_TwRn" href="/docs/Node.js/buffer">Node.js</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_TwRn" href="/docs/React/jsx">React</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_TwRn" href="/docs/interview/http">interview</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_TwRn" href="/docs/javascript/ecma">javascript</a></div></li></ul></nav><button type="button" title="Collapse sidebar" aria-label="Collapse sidebar" class="button button--secondary button--outline collapseSidebarButton_eoK2"><svg width="20" height="20" aria-hidden="true" class="collapseSidebarButtonIcon_e+kA"><g fill="#7a7a7a"><path d="M9.992 10.023c0 .2-.062.399-.172.547l-4.996 7.492a.982.982 0 01-.828.454H1c-.55 0-1-.453-1-1 0-.2.059-.403.168-.551l4.629-6.942L.168 3.078A.939.939 0 010 2.528c0-.548.45-.997 1-.997h2.996c.352 0 .649.18.828.45L9.82 9.472c.11.148.172.347.172.55zm0 0"></path><path d="M19.98 10.023c0 .2-.058.399-.168.547l-4.996 7.492a.987.987 0 01-.828.454h-3c-.547 0-.996-.453-.996-1 0-.2.059-.403.168-.551l4.625-6.942-4.625-6.945a.939.939 0 01-.168-.55 1 1 0 01.996-.997h3c.348 0 .649.18.828.45l4.996 7.492c.11.148.168.347.168.55zm0 0"></path></g></svg></button></div></aside><main class="docMainContainer_r8cw"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_zHA2"><div class="docItemContainer_oiyr"><article><div class="tocCollapsible_aw-L theme-doc-toc-mobile tocMobile_Tx6Y"><button type="button" class="clean-btn tocCollapsibleButton_zr6a">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>[小题目] React</h1></header><h2 class="anchor anchorWithStickyNavbar_y2LR" id="jsx-循环渲染列表">jsx 循环渲染列表<a class="hash-link" href="#jsx-循环渲染列表" title="Direct link to heading">​</a></h2><div class="codeBlockContainer_J+bg language-js theme-code-block"><div class="codeBlockContent_csEI js"><pre tabindex="0" class="prism-code language-js codeBlock_rtdJ thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token function" style="color:rgb(80, 250, 123)">render</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token keyword control-flow" style="color:rgb(189, 147, 249);font-style:italic">return</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token operator">&lt;</span><span class="token plain">ul</span><span class="token operator">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">this</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token property-access">state</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token property-access">list</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token method function property-access" style="color:rgb(80, 250, 123)">map</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token parameter">item</span><span class="token parameter punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token parameter"> index</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token arrow operator">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token keyword control-flow" style="color:rgb(189, 147, 249);font-style:italic">return</span><span class="token plain"> </span><span class="token operator">&lt;</span><span class="token plain">li key</span><span class="token operator">=</span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain">item</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token property-access">id</span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token operator">&gt;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain">item</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token property-access">data</span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token operator">&lt;</span><span class="token operator">/</span><span class="token plain">li</span><span class="token operator">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token operator">&lt;</span><span class="token operator">/</span><span class="token plain">ul</span><span class="token operator">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><h2 class="anchor anchorWithStickyNavbar_y2LR" id="jsx-本质">JSX 本质<a class="hash-link" href="#jsx-本质" title="Direct link to heading">​</a></h2><p>React.createElement, 返回 vnode</p><h2 class="anchor anchorWithStickyNavbar_y2LR" id="react-事件为何-bind">React 事件为何 bind<a class="hash-link" href="#react-事件为何-bind" title="Direct link to heading">​</a></h2><p>默认 this 是 undefined</p><h2 class="anchor anchorWithStickyNavbar_y2LR" id="react-事件是合成的">React 事件是合成的<a class="hash-link" href="#react-事件是合成的" title="Direct link to heading">​</a></h2><ol><li>React event 是合成的, 模拟原生 dom 事件能力</li><li>event.nativeEvent 才是原生事件对象</li><li>所有事件都被挂载到 document 上, 但是 17 绑定到 root 组件(初始化的时候传的 root dom 节点), 这样有利于多个 React 版本并存, 例如微前端. 因为 document 只有一个, root 组件可以有多个</li></ol><h3 class="anchor anchorWithStickyNavbar_y2LR" id="为何要合成事件机制">为何要合成事件机制<a class="hash-link" href="#为何要合成事件机制" title="Direct link to heading">​</a></h3><p>更好的兼容性和跨平台</p><p>载到 document, 减少内存消耗, 避免捆绑解绑</p><p>方便事件的统一管理(如事务机制)</p><p>比如现在事件挂载完毕, 挂载完毕之后触发事件 div, 因为 dom 事件会冒泡, 最终冒泡到 document 上, 因为 react 事件全部绑定到 document 上, document 会生成一个统一的 event 也就是合成事件对象, 在合成事件这一层会派发事件, 比如可以通过 target 知道哪个元素触发的事件, 所以通过判断 target 知道了元素所在位置和绑定关系,就会知道所有绑定了该事件的元素, 然后把合成事件的 event 传递进 来去执行该函数</p><h3 class="anchor anchorWithStickyNavbar_y2LR" id="什么是事务机制">什么是事务机制<a class="hash-link" href="#什么是事务机制" title="Direct link to heading">​</a></h3><p><img alt="shiwujizhi" src="/assets/images/shiwujizhi-cfee74fbc1ae655ab9b5bc53468cdce7.JPG"></p><h2 class="anchor anchorWithStickyNavbar_y2LR" id="react-组件渲染过程">React 组件渲染过程<a class="hash-link" href="#react-组件渲染过程" title="Direct link to heading">​</a></h2><p>拿到 props 和 state 然后 render（）解析 jsx 结构生成 vnode， 再去 patch（elem，vnode）</p><h2 class="anchor anchorWithStickyNavbar_y2LR" id="react-组件更新过程">React 组件更新过程<a class="hash-link" href="#react-组件更新过程" title="Direct link to heading">​</a></h2><p>先 setState（newstate）生成 dirtyComponents（可能有子组件）然后遍历所有组件去 render（）根据 jsx 结构生成 newVnode，然后 patch</p><h2 class="anchor anchorWithStickyNavbar_y2LR" id="受控组件和非受控组件">受控组件和非受控组件<a class="hash-link" href="#受控组件和非受控组件" title="Direct link to heading">​</a></h2><p>受控组件:</p><p><img alt="shoukongzujian" src="/assets/images/shoukongzujian-aa891b9a87a50f83870d84d27e78a9cc.JPG"></p><p>把 input 和 p 标签的值关联起来, 关联之后就能控制 p 标签里的值来控制 input 的值, 也就是说这样关联好之后能通过 this.state 来控制</p><p>非受控组件:</p><p>React.createRef()</p><p>defaultValued defalutedChecked</p><p>手动操作 dom 元素</p><p>使用场景:</p><ol><li><p>必须手动操作 dom 元素, setState 实现不了</p></li><li><p>富文本编辑器, 需要传入 dom 元素</p></li><li><p>上传<code>&lt;input type=file&gt;</code></p></li></ol><h2 class="anchor anchorWithStickyNavbar_y2LR" id="setstate">setState<a class="hash-link" href="#setstate" title="Direct link to heading">​</a></h2><h3 class="anchor anchorWithStickyNavbar_y2LR" id="setstate-不可变值">setState 不可变值<a class="hash-link" href="#setstate-不可变值" title="Direct link to heading">​</a></h3><p>不可变值: 操作 state 的时候要是临时的新值, 不影响之前的值</p><p>操作数组 不能用 push, 要用下图的方法</p><p><img alt="fangfa" src="/assets/images/fangfa-affa9dc13b2162b9dd00d2a82592a252.JPG"></p><p>操作对象 要用下面</p><p><img alt="caozuoduixiang" src="/assets/images/caozuoduixiang-e39745dc6f5294f2ee2c37b1197ee01b.JPG"></p><h3 class="anchor anchorWithStickyNavbar_y2LR" id="setstate-同步还是异步">setState 同步还是异步<a class="hash-link" href="#setstate-同步还是异步" title="Direct link to heading">​</a></h3><p>正常是异步的, 但是在第二个参数里是同步, 比如下图</p><div class="codeBlockContainer_J+bg language-js theme-code-block"><div class="codeBlockContent_csEI js"><pre tabindex="0" class="prism-code language-js codeBlock_rtdJ thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#F8F8F2"><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">this</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token method function property-access" style="color:rgb(80, 250, 123)">setState</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token literal-property property">count</span><span class="token operator">:</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">this</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token property-access">state</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token property-access">count</span><span class="token plain"> </span><span class="token operator">+</span><span class="token plain"> </span><span class="token number">1</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token arrow operator">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token comment" style="color:rgb(98, 114, 164)">// vue $nextTick</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token console class-name">console</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token method function property-access" style="color:rgb(80, 250, 123)">log</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">this</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token property-access">state</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token property-access">count</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>在 setTimeout 里也是同步</p><p>在自定义 dom 事件也是同步</p><p><img alt="zidingyi" src="/assets/images/zidingyi-2ea85112c36824d035d76021ea5a0374.JPG"></p><h3 class="anchor anchorWithStickyNavbar_y2LR" id="state-何时会合并">state 何时会合并<a class="hash-link" href="#state-何时会合并" title="Direct link to heading">​</a></h3><p>类似 Object.assign({}, xx)</p><p><img alt="hebing" src="/assets/images/hebing-b3086514e2d1b5233b49ebc19e0295ec.JPG"></p><p>传入函数不会合并, 因为函数是个可执行代码 , 没法合并</p><p>回顾 setState 三个特点:</p><ol><li><p>不可变值</p></li><li><p>可能异步更新</p></li><li><p>可能被合并</p></li></ol><h2 class="anchor anchorWithStickyNavbar_y2LR" id="react-异步组件">React 异步组件<a class="hash-link" href="#react-异步组件" title="Direct link to heading">​</a></h2><p>React.lazy React.suspense</p><p><img alt="lazy" src="/assets/images/lazy-11492af99a1f5bb94d66d608e74b5611.JPG"></p><p><img alt="suspense" src="/assets/images/suspense-ff82238065d2b050c8ca7d1cbfb2e9a3.JPG"></p><h2 class="anchor anchorWithStickyNavbar_y2LR" id="性能优化">性能优化<a class="hash-link" href="#性能优化" title="Direct link to heading">​</a></h2><ol><li><p>SCU</p></li><li><p>PureComponent 和 React.memo</p></li><li><p>减少函数 bind this 的次数</p></li><li><p>渲染列表加 key</p></li><li><p>异步组件, dom 事件和自定义事件及时销毁</p></li></ol><h3 class="anchor anchorWithStickyNavbar_y2LR" id="purecomponent">PureComponent<a class="hash-link" href="#purecomponent" title="Direct link to heading">​</a></h3><p>实现了浅比较的 SCU, 就是对 props 的第一层数据进行比较, 没有进行深比较</p><h3 class="anchor anchorWithStickyNavbar_y2LR" id="scu">SCU<a class="hash-link" href="#scu" title="Direct link to heading">​</a></h3><p>SCU 默认返回 true , 实现的是浅比较</p><p><img alt="scu" src="/assets/images/scu-c95a495b300624a1986e72fa288256a0.JPG"></p><h2 class="anchor anchorWithStickyNavbar_y2LR" id="redux">Redux<a class="hash-link" href="#redux" title="Direct link to heading">​</a></h2><h3 class="anchor anchorWithStickyNavbar_y2LR" id="单项数据流概述">单项数据流概述<a class="hash-link" href="#单项数据流概述" title="Direct link to heading">​</a></h3><h3 class="anchor anchorWithStickyNavbar_y2LR" id="三大原则">三大原则<a class="hash-link" href="#三大原则" title="Direct link to heading">​</a></h3><ol><li><p>单一数据源</p></li><li><p>state 是只读的 唯一改变 state 的方法就是触发 action，action 是一个用于描述已发生事件的普通对象。</p></li><li><p>使用纯函数来执行修改 为了描述 action 如何改变 state tree ，需要用 reducers。</p></li></ol><h2 class="anchor anchorWithStickyNavbar_y2LR" id="react-router">React-router<a class="hash-link" href="#react-router" title="Direct link to heading">​</a></h2><p><img alt="ruhepeizhi" src="/assets/images/ruhepeizhi-4eb24ee8578636d0b2d5bff8aaeba538.JPG"></p><div class="codeBlockContainer_J+bg language-js theme-code-block"><div class="codeBlockContent_csEI js"><pre tabindex="0" class="prism-code language-js codeBlock_rtdJ thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#F8F8F2"><span class="token plain">首先 </span><span class="token operator">&lt;</span><span class="token plain"> </span><span class="token maybe-class-name">BroserRouter</span><span class="token plain"> </span><span class="token operator">&gt;</span><span class="token plain"> 标签包裹 </span><span class="token operator">&lt;</span><span class="token plain"> </span><span class="token maybe-class-name">App</span><span class="token plain"> </span><span class="token operator">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token operator">&lt;</span><span class="token maybe-class-name">Routes</span><span class="token operator">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token operator">&lt;</span><span class="token maybe-class-name">Route</span><span class="token plain"> path</span><span class="token operator">=</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;/&quot;</span><span class="token plain"> element</span><span class="token operator">=</span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token operator">&lt;</span><span class="token maybe-class-name">Home</span><span class="token plain"> </span><span class="token operator">/</span><span class="token operator">&gt;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token operator">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      </span><span class="token operator">&lt;</span><span class="token maybe-class-name">Route</span><span class="token plain"> index path</span><span class="token operator">=</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;/&quot;</span><span class="token plain"> element</span><span class="token operator">=</span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token operator">&lt;</span><span class="token maybe-class-name">Home</span><span class="token plain"> </span><span class="token operator">/</span><span class="token operator">&gt;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token operator">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token operator">&lt;</span><span class="token operator">/</span><span class="token maybe-class-name">Route</span><span class="token operator">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token operator">&lt;</span><span class="token maybe-class-name">Route</span><span class="token plain"> path</span><span class="token operator">=</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;/login&quot;</span><span class="token plain"> element</span><span class="token operator">=</span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token operator">&lt;</span><span class="token maybe-class-name">Login</span><span class="token plain"> </span><span class="token operator">/</span><span class="token operator">&gt;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span><span class="token maybe-class-name">Route</span><span class="token operator">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token operator">&lt;</span><span class="token operator">/</span><span class="token maybe-class-name">Routes</span><span class="token operator">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>useNavigate()
useParams()</p><h2 class="anchor anchorWithStickyNavbar_y2LR" id="react-和-vue-区别">React 和 Vue 区别<a class="hash-link" href="#react-和-vue-区别" title="Direct link to heading">​</a></h2><p>相同:</p><p>都支持组件化, 都是数据驱动视图, 都使用 vdom 操作 dom</p><p>不同:</p><p>jsx 和 template</p><p>react 函数式编程, vue 声明式编程</p><h2 class="anchor anchorWithStickyNavbar_y2LR" id="hooks">Hooks<a class="hash-link" href="#hooks" title="Direct link to heading">​</a></h2><h3 class="anchor anchorWithStickyNavbar_y2LR" id="class-组件存在什么问题">class 组件存在什么问题<a class="hash-link" href="#class-组件存在什么问题" title="Direct link to heading">​</a></h3><p>大型组件很难拆分和重构, 不好测试(即 class 不易拆分)</p><p>相同业务逻辑, 分散到各个方法中, 逻辑混乱</p><p>复杂逻辑变得复杂, HOC, render props</p><p><img alt="classzujian" src="/assets/images/classzujian-6f81e023fd0ae2be2dddedf1eb840a83.JPG"></p><h3 class="anchor anchorWithStickyNavbar_y2LR" id="没有-hooks-的函数组件存在什么问题">没有 hooks 的函数组件存在什么问题<a class="hash-link" href="#没有-hooks-的函数组件存在什么问题" title="Direct link to heading">​</a></h3><p>函数组件没有生命周期, 没有组件实例, 没有 state 和 setState, 只能接收 props 返回 jsx, 函数组件是一个纯函数, 无法存储 state, 执行就销毁了</p><h3 class="anchor anchorWithStickyNavbar_y2LR" id="usestate">useState<a class="hash-link" href="#usestate" title="Direct link to heading">​</a></h3><p>让函数组件实现 state 和 setState</p><p><img alt="usestate" src="/assets/images/usestate-15f49d7b519022b0a187d43723acd2f2.JPG"></p><h3 class="anchor anchorWithStickyNavbar_y2LR" id="useeffect">useEffect<a class="hash-link" href="#useeffect" title="Direct link to heading">​</a></h3><p>让函数组件模拟生命周期</p><ol><li>模拟 class 组件的 DidMount 和 DidUpdate</li></ol><p><img alt="didmount" src="/assets/images/didmount-299f234484995b05a29ad6d80f45ec75.JPG"></p><ol start="2"><li>模拟 DidMount</li></ol><p>就传一个空数组, 不依赖于任何 state, 就一次</p><ol start="3"><li>模拟 DidUpdate</li></ol><p><img alt="update" src="/assets/images/update-6c3deff1f99d3fb149facd4585bcbd7a.JPG"></p><ol start="4"><li>模拟 WillUnmount</li></ol><p>在第一个函数参数里返回一个函数, 组件销毁的时候就能执行这个函数.</p><p>注意: 这个函数其实也会在下一次 effect 执行之前, 被执行. 无论更新或卸载</p><p><img alt="willunmount" src="/assets/images/willunmount-32105ac8f238cd4040bbe4efa0da8a08.JPG"></p><p>总结:</p><p><img alt="fuzuoyong" src="/assets/images/fuzuoyong-dcfaca87f528e575e91dad8ef1a58069.JPG"></p><h3 class="anchor anchorWithStickyNavbar_y2LR" id="useref">useRef<a class="hash-link" href="#useref" title="Direct link to heading">​</a></h3><p><img alt="ref" src="/assets/images/ref-81ffaecc8f10bf0ec87915b9bdf4a495.JPG"></p><h3 class="anchor anchorWithStickyNavbar_y2LR" id="usereducer-能代替-redux-嘛">useReducer 能代替 redux 嘛<a class="hash-link" href="#usereducer-能代替-redux-嘛" title="Direct link to heading">​</a></h3><p>不能, useReducer 是单个组件状态管理, 组件通讯还需要 props</p><p>redux 是全局的状态管理, 多组件共享数据</p><h3 class="anchor anchorWithStickyNavbar_y2LR" id="使用-usememo">使用 useMemo<a class="hash-link" href="#使用-usememo" title="Direct link to heading">​</a></h3><p>使用第一步: 类似 class PureComponent, 对 props 进行浅层比较, 用 memo 把组件包裹起来</p><p>第二步: 对 props 进行 useMemo 包裹</p><p><img alt="usememo" src="/assets/images/usememo-765ac7b938f352fe2251ef7af2ea4586.JPG"></p><h3 class="anchor anchorWithStickyNavbar_y2LR" id="什么是自定义-hook">什么是自定义 hook<a class="hash-link" href="#什么是自定义-hook" title="Direct link to heading">​</a></h3><p>封装通用功能</p><p>开发和使用第三方 hook</p><p>解耦代码, 增加无限扩展性</p><p><img alt="useaxios" src="/assets/images/useaxios-18a0860d47e3fff6f9213b291d6b06c7.JPG"></p><h3 class="anchor anchorWithStickyNavbar_y2LR" id="hooks-使用规范">hooks 使用规范<a class="hash-link" href="#hooks-使用规范" title="Direct link to heading">​</a></h3><p>只能用于函数组件和自定义 hook 中, 其他地方不可以</p><p>只能用于顶层代码, 不能在循环, 判断中使用 hooks</p><h3 class="anchor anchorWithStickyNavbar_y2LR" id="为什么不能在循环-判断中使用-hooks">为什么不能在循环, 判断中使用 hooks<a class="hash-link" href="#为什么不能在循环-判断中使用-hooks" title="Direct link to heading">​</a></h3><p>函数组件, 是纯函数, 执行完就销毁</p><p>所以, 无论组件初始化(render)还是组件更新(re-render)</p><p>都会重新执行一次这个函数, 获取最新的组件</p><p>这一点和 class 组件不一样, class 组件有实例, 只要组件不销毁, 无论更新多少次, 实例都不销毁</p><p>因为 hook 依赖顺序执行, 调用顺序必须保持一致</p><h3 class="anchor anchorWithStickyNavbar_y2LR" id="hooks-使用中的几个坑">Hooks 使用中的几个坑<a class="hash-link" href="#hooks-使用中的几个坑" title="Direct link to heading">​</a></h3><ol><li>useState 初始化值, 只有第一次有效</li></ol><p><img alt="rerender" src="/assets/images/rerender-38fdb126179f48176b1ad1b71b6b2c3f.JPG"></p><ol start="2"><li>useEffect 可能出现死循环</li></ol><p>依赖[]里有引用类型就会出现死循环</p><p>因为 react 通过 Object.is 方法进行比较, 引用类型</p><ol start="3"><li>useEffect 第二个参数是空数组 内部不能修改 state</li></ol><p>因为依赖为 [] 空数组, re-render 不会重新执行 effect 函数</p><p>如果没有依赖, re-render 会重新执行 effect 函数</p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/aokikoko/aokikoko.github.io/blob/main/website/docs/Another/react.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_mS5F" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_mt2f"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/docs/Another/design"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">[小题目] 设计项目</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/docs/Another/async"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">[小题目] async await</div></a></div></nav></div></div><div class="col col--3"><div class="tableOfContents_vrFS thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#jsx-循环渲染列表" class="table-of-contents__link toc-highlight">jsx 循环渲染列表</a></li><li><a href="#jsx-本质" class="table-of-contents__link toc-highlight">JSX 本质</a></li><li><a href="#react-事件为何-bind" class="table-of-contents__link toc-highlight">React 事件为何 bind</a></li><li><a href="#react-事件是合成的" class="table-of-contents__link toc-highlight">React 事件是合成的</a><ul><li><a href="#为何要合成事件机制" class="table-of-contents__link toc-highlight">为何要合成事件机制</a></li><li><a href="#什么是事务机制" class="table-of-contents__link toc-highlight">什么是事务机制</a></li></ul></li><li><a href="#react-组件渲染过程" class="table-of-contents__link toc-highlight">React 组件渲染过程</a></li><li><a href="#react-组件更新过程" class="table-of-contents__link toc-highlight">React 组件更新过程</a></li><li><a href="#受控组件和非受控组件" class="table-of-contents__link toc-highlight">受控组件和非受控组件</a></li><li><a href="#setstate" class="table-of-contents__link toc-highlight">setState</a><ul><li><a href="#setstate-不可变值" class="table-of-contents__link toc-highlight">setState 不可变值</a></li><li><a href="#setstate-同步还是异步" class="table-of-contents__link toc-highlight">setState 同步还是异步</a></li><li><a href="#state-何时会合并" class="table-of-contents__link toc-highlight">state 何时会合并</a></li></ul></li><li><a href="#react-异步组件" class="table-of-contents__link toc-highlight">React 异步组件</a></li><li><a href="#性能优化" class="table-of-contents__link toc-highlight">性能优化</a><ul><li><a href="#purecomponent" class="table-of-contents__link toc-highlight">PureComponent</a></li><li><a href="#scu" class="table-of-contents__link toc-highlight">SCU</a></li></ul></li><li><a href="#redux" class="table-of-contents__link toc-highlight">Redux</a><ul><li><a href="#单项数据流概述" class="table-of-contents__link toc-highlight">单项数据流概述</a></li><li><a href="#三大原则" class="table-of-contents__link toc-highlight">三大原则</a></li></ul></li><li><a href="#react-router" class="table-of-contents__link toc-highlight">React-router</a></li><li><a href="#react-和-vue-区别" class="table-of-contents__link toc-highlight">React 和 Vue 区别</a></li><li><a href="#hooks" class="table-of-contents__link toc-highlight">Hooks</a><ul><li><a href="#class-组件存在什么问题" class="table-of-contents__link toc-highlight">class 组件存在什么问题</a></li><li><a href="#没有-hooks-的函数组件存在什么问题" class="table-of-contents__link toc-highlight">没有 hooks 的函数组件存在什么问题</a></li><li><a href="#usestate" class="table-of-contents__link toc-highlight">useState</a></li><li><a href="#useeffect" class="table-of-contents__link toc-highlight">useEffect</a></li><li><a href="#useref" class="table-of-contents__link toc-highlight">useRef</a></li><li><a href="#usereducer-能代替-redux-嘛" class="table-of-contents__link toc-highlight">useReducer 能代替 redux 嘛</a></li><li><a href="#使用-usememo" class="table-of-contents__link toc-highlight">使用 useMemo</a></li><li><a href="#什么是自定义-hook" class="table-of-contents__link toc-highlight">什么是自定义 hook</a></li><li><a href="#hooks-使用规范" class="table-of-contents__link toc-highlight">hooks 使用规范</a></li><li><a href="#为什么不能在循环-判断中使用-hooks" class="table-of-contents__link toc-highlight">为什么不能在循环, 判断中使用 hooks</a></li><li><a href="#hooks-使用中的几个坑" class="table-of-contents__link toc-highlight">Hooks 使用中的几个坑</a></li></ul></li></ul></div></div></div></div></main></div></div></div>
<script src="/assets/js/runtime~main.2e69c70d.js"></script>
<script src="/assets/js/main.dd54a102.js"></script>
</body>
</html>